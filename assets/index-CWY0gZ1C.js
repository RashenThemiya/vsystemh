import{r as a,j as e,N as dt,A as mt,m as Me,F as ut,u as q,a as xt,b as Ie,L as Le,c as Fe,d as ht,e as Ke,f as pt,g as gt,h as ft,i as bt,k as Qe,l as jt,n as Z,o as vt,p as _e,q as Ze,s as Je,R as ve,P as yt,t as Nt,C as ye,T as Ne,v as we,B as ze,X as Re,Y as Be,w as Oe,x as et,y as fe,z as wt,D as oe,E as tt,G as _t,H as Ue,I as Ye,J as Ct,K as St,M as kt,O as qe,Q as ne,S as At,U as st,V as Se,W as le,Z as je,_ as ue,$ as ie,a0 as xe,a1 as ke,a2 as Tt,a3 as at,a4 as lt,a5 as Ve,a6 as Dt,a7 as Et,a8 as Pt,a9 as $t,aa as rt,ab as Mt,ac as It,ad as Lt,ae as Ft,af as zt,ag as Ae,ah as te,ai as Rt,aj as Xe,ak as Bt,al as W,am as Ot,an as Ut,ao as Yt,ap as qt,aq as Vt}from"./vendor-DiX_fqKo.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&l(p)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const nt=a.createContext(),V=()=>a.useContext(nt),it=({children:t})=>{const[r,s]=a.useState(localStorage.getItem("token")||null),[l,n]=a.useState(localStorage.getItem("role")||null),[i,p]=a.useState(localStorage.getItem("name")||null),u=(c,g,x)=>{s(c),n(g),p(x),c?(localStorage.setItem("token",c),localStorage.setItem("role",g),localStorage.setItem("name",x)):(localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("name"))};a.useEffect(()=>{r&&(localStorage.setItem("token",r),localStorage.setItem("role",l),localStorage.setItem("name",i))},[r,l,i]);const m=()=>{u(null,null,null)};return e.jsx(nt.Provider,{value:{token:r,role:l,name:i,setAuthData:u,logout:m},children:t})},K=({children:t})=>{const{token:r}=V();return r?t:e.jsx(dt,{to:"/login",replace:!0})},G=({onConfirm:t,children:r,message:s,additionalInfo:l,confirmText:n="Yes, Proceed",cancelText:i="Cancel",icon:p,buttonTextColor:u="text-white",buttonBackgroundColor:m="bg-red-600",isLoading:c=!1})=>{const[g,x]=a.useState(!1),k=S=>{S.preventDefault(),S.stopPropagation(),x(!0)},h=()=>{x(!1),t()},A=()=>{x(!1)},o={visible:{opacity:1},hidden:{opacity:0}},b={visible:{scale:1,opacity:1,y:0,transition:{duration:.3}},hidden:{scale:.9,opacity:0,y:50}},j=p||e.jsx(ut,{});return e.jsxs(e.Fragment,{children:[e.jsx(mt,{children:g&&e.jsx(Me.div,{className:"fixed inset-0 flex items-center justify-center bg-white/60 backdrop-blur-sm z-50 p-4",initial:"hidden",animate:"visible",exit:"hidden",variants:o,onClick:A,children:e.jsxs(Me.div,{className:"bg-white p-8 rounded-xl shadow-2xl space-y-6 w-full max-w-sm flex flex-col",variants:b,onClick:S=>S.stopPropagation(),children:[e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:`text-5xl mb-4 ${m.replace("bg-","text-")||"text-red-600"}`,children:j}),e.jsx("p",{className:"text-xl font-bold text-gray-800",children:s})]}),l&&e.jsx("div",{className:"text-sm text-gray-500 text-center border-t pt-4",children:l}),e.jsxs("div",{className:"flex flex-col space-y-3 mt-6 w-full",children:[e.jsx("button",{onClick:h,className:`
                    ${m} ${u} 
                    w-full px-6 py-3 rounded-xl text-md font-semibold transition duration-200 shadow-md
                    ${c?"opacity-70 cursor-wait":"hover:opacity-90"}
                  `,disabled:c,children:n}),e.jsx("button",{onClick:A,className:"bg-gray-200 text-gray-700 w-full px-6 py-3 rounded-xl text-md font-medium hover:bg-gray-300 transition duration-200 disabled:opacity-50",disabled:c,children:i})]})]})})}),e.jsx("div",{onClick:k,children:r})]})},re=()=>{const[t,r]=a.useState(!0),{logout:s,role:l}=V(),n=q(),i=xt(),p=[{path:"/admin-dashboard",icon:e.jsx(ht,{}),label:"Dashboard"},{path:"/owner-dashboard",icon:e.jsx(Ke,{}),label:"Vehicle Owner"},{path:"/customer-dashboard",icon:e.jsx(pt,{}),label:"Customer Management"},{path:"/driver-dashboard",icon:e.jsx(gt,{}),label:"Driver Management"},{path:"/vehicle-dashboard",icon:e.jsx(ft,{}),label:"Vehicle Management"},{path:"/trip-dashboard",icon:e.jsx(bt,{}),label:"Trip Management"},{path:"/bill-dashboard",icon:e.jsx(Qe,{}),label:"Bill Management"}];l==="SuperAdmin"&&p.push({path:"/admin-role-dashboard",icon:e.jsx(jt,{}),label:"Admin Roles"});const u=()=>r(c=>!c),m=()=>{s(),n("/")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`bg-gradient-to-r from-indigo-800 to-violet-800 text-white transition-all duration-300 ${t?"w-64":"w-20"} fixed md:relative top-0 left-0 h-full z-50 flex flex-col hidden md:flex`,children:[e.jsx("button",{className:"text-white p-4 focus:outline-none hover:bg-violet-900 transition md:flex items-center justify-center",onClick:u,children:t?e.jsx(Ie,{size:28}):e.jsx(Ie,{size:28})}),e.jsx("ul",{className:"mt-4 space-y-4 flex-grow",children:p.map(c=>{const g=i.pathname===c.path;return e.jsx("li",{children:e.jsxs(Le,{to:c.path,className:`flex items-center p-3 transition rounded-lg ${g?"bg-gradient-to-r from-purple-500 to-pink-500 shadow-lg text-white font-bold scale-105":"hover:bg-violet-900"}`,children:[e.jsx("span",{className:`ml-4 mr-3 ${g?"text-3xl":"text-2xl"}`,children:c.icon}),e.jsx("span",{className:`transition-all duration-300 text-sm font-medium ${t?"opacity-100":"opacity-0 hidden"}`,children:c.label})]})},c.path)})}),e.jsx(G,{onConfirm:m,message:"Are you sure you want to logout?",children:e.jsxs("button",{className:"flex items-center p-3 mt-auto hover:bg-red-600 transition rounded-lg text-white w-full text-left",children:[e.jsx("span",{className:"text-2xl ml-4 mr-3",children:e.jsx(Fe,{})}),e.jsx("span",{className:`transition-all duration-300 text-sm font-medium ${t?"opacity-100":"opacity-0 hidden"}`,children:"Logout"})]})})]}),e.jsxs("div",{className:"bg-purple-700 text-white fixed bottom-0 left-0 w-full flex justify-around p-2 md:hidden z-50",children:[p.map(c=>e.jsx(Le,{to:c.path,className:"flex flex-col items-center text-white",children:e.jsx("span",{className:"text-2xl",children:c.icon})},c.path)),e.jsx(G,{onConfirm:m,message:"Are you sure you want to logout?",children:e.jsx("button",{className:"flex flex-col items-center text-red-400",children:e.jsx("span",{className:"text-2xl",children:e.jsx(Fe,{})})})})]})]})},z=Z.create({baseURL:"https://rashen.sceniccottage.com",headers:{"Content-Type":"application/json"}});z.interceptors.request.use(t=>{const r=localStorage.getItem("token");return r&&(t.headers.Authorization=`Bearer ${r}`),t},t=>Promise.reject(t));z.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(console.error("Unauthorized! Redirecting to login..."),localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(t)});function Ce({children:t,onClose:r}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-md flex justify-center items-center z-50 p-6",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6 relative",children:t})})}function Xt({stats:t,onSelectTrips:r,onSelectVehicles:s,onSelectCustomers:l,onSelectOwners:n,onSelectPendingBills:i}){return e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6",children:[e.jsx(pe,{title:"Total Trips",value:t.totalTrips,icon:e.jsx(vt,{}),onClick:r}),e.jsx(pe,{title:"Total Vehicles",value:t.totalVehicles,icon:e.jsx(_e,{}),onClick:s}),e.jsx(pe,{title:"Total Customers",value:t.totalCustomers,icon:e.jsx(Ke,{}),onClick:l}),e.jsx(pe,{title:"Total Owners",value:t.totalOwners,icon:e.jsx(Ze,{}),onClick:n}),e.jsx(pe,{title:"Pending Bills",value:t.pendingBillsCount,icon:e.jsx(Je,{}),onClick:i})]})}function pe({title:t,value:r,icon:s,onClick:l}){return e.jsxs("div",{onClick:l,className:`p-5 rounded-xl shadow-md text-white\r
                 bg-gradient-to-r from-indigo-600 to-violet-600\r
                 cursor-pointer hover:opacity-90 active:scale-95\r
                 transition flex items-center justify-between`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold opacity-90",children:t}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:r??0})]}),e.jsx("div",{className:"text-3xl opacity-90",children:s})]})}const Gt=({open:t,onClose:r,fuel:s,onSuccess:l})=>{const[n,i]=a.useState((s==null?void 0:s.cost)||""),[p,u]=a.useState(!1);if(a.useEffect(()=>{s&&i(s.cost)},[s]),!t)return null;const m=async()=>{var c,g;if(n===""||isNaN(n))return alert("Please enter a valid cost");try{u(!0),await z.put(`/api/fuels/${s.fuel_id}`,{cost:Number(n)},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),l(),r()}catch(x){console.error(x),alert(((g=(c=x==null?void 0:x.response)==null?void 0:c.data)==null?void 0:g.message)||"Failed to update fuel cost")}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/40 backdrop-blur-sm z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-xl w-80",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Fuel Cost"}),e.jsx("label",{className:"font-medium mb-2 block",children:"Fuel Type"}),e.jsx("input",{type:"text",value:s.type,disabled:!0,className:"w-full border border-gray-300 rounded px-3 py-2 mb-4 bg-gray-100"}),e.jsx("label",{className:"font-medium mb-2 block",children:"Cost"}),e.jsx("input",{type:"number",value:n,onChange:c=>i(c.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 mb-4"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-300 rounded",children:"Cancel"}),e.jsx("button",{onClick:m,disabled:p,className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:p?"Saving...":"Save"})]})]})})},be=["#adaef7ff","#6037c9ff","#9f1eefff","#f116acff","#e887bfff"],Ge=["#312e81","#4f46e5","#7c3aed","#c084fc"];function Ht(){const{name:t,role:r}=V(),[s,l]=a.useState(null),[n,i]=a.useState(!0),[p,u]=a.useState(null),[m,c]=a.useState("monthly"),[g,x]=a.useState(""),[k,h]=a.useState(""),[A,o]=a.useState(!1),[b,j]=a.useState(null),S=q(),D=async()=>{try{i(!0);const f=(await z.get("api/dashboard/kpis")).data.data;f.fuelPrices&&f.fuelPrices.length>0&&(f.fuelPrices=f.fuelPrices.map(T=>({fuel_id:T.fuel_id,type:T.type,cost:T.cost}))),l(f),f.monthlyTripStatusCounts.length>0&&x(f.monthlyTripStatusCounts[0].month),f.yearlyTripStatusCounts.length>0&&h(f.yearlyTripStatusCounts[0].year)}catch(N){console.error(N),u("Failed to fetch dashboard KPIs.")}finally{i(!1)}};if(a.useEffect(()=>{D()},[]),n)return e.jsx("div",{children:"Loading KPIs..."});if(p)return e.jsx("div",{className:"text-red-600",children:p});if(!s)return null;const w=m==="monthly"?s.monthlyTripStatusCounts.filter(N=>N.month===g).map(N=>({name:N.trip_status,value:N.count})):s.yearlyTripStatusCounts.filter(N=>N.year===Number(k)).map(N=>({name:N.trip_status,value:N.count})),C=[...new Set(s.monthlyTripStatusCounts.map(N=>N.month))],v=[...new Set(s.yearlyTripStatusCounts.map(N=>N.year))],E=(N,f)=>{const T=s.fuelPrices[f];j(T),o(!0)};return e.jsx("div",{className:"flex h-screen bg-gray-50",children:e.jsxs("main",{className:"flex-1 overflow-auto p-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Dashboard KPIs"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Overview of trips, vehicles, and fuel costs"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:t})," — ",r]})]}),e.jsx("div",{className:"mb-6",children:e.jsx(Xt,{stats:s,onSelectTrips:()=>S("/trip-dashboard"),onSelectVehicles:()=>S("/vehicle-dashboard"),onSelectCustomers:()=>S("/customer-dashboard"),onSelectOwners:()=>S("/owner-dashboard"),onSelectPendingBills:()=>S("/bill-dashboard")})}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 mb-5",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Trip Status Distribution"}),e.jsx(ve,{width:"100%",height:300,children:e.jsxs(yt,{children:[e.jsx(Nt,{data:Object.keys(s.tripStatusCounts).map(N=>({name:N,value:s.tripStatusCounts[N]})),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:!0,children:Object.keys(s.tripStatusCounts).map((N,f)=>e.jsx(ye,{fill:be[f%be.length]},`cell-${f}`))}),e.jsx(Ne,{}),e.jsx(we,{})]})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Trip Status Overview"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:m,onChange:N=>c(N.target.value),className:"border rounded p-1",children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]}),m==="monthly"&&e.jsx("select",{value:g,onChange:N=>x(N.target.value),className:"border rounded p-1",children:C.map(N=>e.jsx("option",{value:N,children:N},N))}),m==="yearly"&&e.jsx("select",{value:k,onChange:N=>h(N.target.value),className:"border rounded p-1",children:v.map(N=>e.jsx("option",{value:N,children:N},N))})]})]}),e.jsx(ve,{width:"100%",height:300,children:e.jsxs(ze,{data:w,children:[e.jsx(Re,{dataKey:"name"}),e.jsx(Be,{}),e.jsx(Ne,{}),e.jsx(we,{}),e.jsx(Oe,{dataKey:"value",name:"Trips",children:w.map((N,f)=>e.jsx(ye,{fill:be[f%be.length]},`cell-${f}`))})]})})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Fuel Prices (Click bar to edit)"}),e.jsx(ve,{width:"100%",height:300,children:e.jsxs(ze,{data:s.fuelPrices,barCategoryGap:30,children:[e.jsx(Re,{dataKey:"type"}),e.jsx(Be,{}),e.jsx(Ne,{}),e.jsx(we,{}),e.jsx(Oe,{dataKey:"cost",name:"Fuel Cost",barSize:100,onClick:E,children:s.fuelPrices.map((N,f)=>e.jsx(ye,{fill:Ge[f%Ge.length],cursor:"pointer"},`fuel-${f}`))})]})})]})]}),A&&b&&e.jsx(Ce,{onClose:()=>o(!1),children:e.jsx(Gt,{open:A,fuel:b,onClose:()=>o(!1),onSuccess:D})})]})})}const Wt=()=>e.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[e.jsx(re,{className:"w-64 flex-shrink-0"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx(Ht,{})})]});function Kt(){return e.jsxs("div",{className:"w-full min-h-screen bg-white font-sans overflow-x-hidden",children:[e.jsx("style",{children:`
        @keyframes slideImages {
          0% { transform: translateX(0%); }
          20% { transform: translateX(0%); }
          25% { transform: translateX(-100%); }
          45% { transform: translateX(-100%); }
          50% { transform: translateX(-200%); }
          70% { transform: translateX(-200%); }
          75% { transform: translateX(-300%); }
          95% { transform: translateX(-300%); }
          100% { transform: translateX(0%); }
        }

        .animate-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            flex-shrink: 0;
            animation: slideImages 18s infinite ease-in-out;
        }`}),e.jsxs("section",{className:"relative w-full h-[85vh] overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 flex transition-transform duration-[1500ms] ease-in-out animate-slide",children:[e.jsx("img",{src:"/images/Sri Lanka.jpeg",className:"w-full h-full object-cover flex-shrink-0"}),e.jsx("img",{src:"/images/Sri Lanka - Advantiko.jpeg",className:"w-full h-full object-cover flex-shrink-0"}),e.jsx("img",{src:"/images/Arugam Bay beach - SriLanka.jpeg",className:"w-full h-full object-cover flex-shrink-0"}),e.jsx("img",{src:"/images/Kalawewa, Sri Lanka.jpeg",className:"w-full h-full object-cover flex-shrink-0"})]}),e.jsx("div",{className:"absolute inset-0 bg-black/40"}),e.jsxs("div",{className:"relative text-center text-white px-6 max-w-3xl mx-auto top-1/2 -translate-y-1/2",children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-4 drop-shadow-lg",children:"Discover Beautiful Places in Sri Lanka"}),e.jsx("p",{className:"text-lg md:text-xl mb-6 drop-shadow-md",children:"Find the best destinations, experiences, and travel guides all in one place."})]})]}),e.jsxs("section",{className:"py-16 px-6 md:px-16 bg-gray-50",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-10",children:"Top Destinations"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8",children:[{title:"Adam's Peak",image:"/images/Adam's Peak.jpeg"},{title:"Sigiriya",image:"/images/Sigiriya.jpeg"},{title:"Temple Of Tooth",image:"/images/TempleOfTooth.jpeg"}].map((t,r)=>e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden hover:scale-[1.03] transition transform cursor-pointer",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-56 object-cover"}),e.jsx("div",{className:"p-4",children:e.jsx("h3",{className:"text-xl font-semibold",children:t.title})})]},r))})]}),e.jsx("footer",{className:"w-full py-6 text-center bg-blue-900 text-white mt-16",children:e.jsxs("p",{children:["Ceylon Places © ",new Date().getFullYear()," — All Rights Reserved"]})})]})}function Qt(){const[t,r]=a.useState(""),[s,l]=a.useState(""),[n,i]=a.useState(!1),[p,u]=a.useState(""),[m,c]=a.useState(!1),g=q(),{setAuthData:x}=V(),k=async A=>{var o,b;A.preventDefault(),u(""),c(!0);try{const j=await z.post("/api/admin/login",{email:t,password:s}),{token:S,admin:D}=j.data;x(S,D.role,D.email),D.role==="Admin"||D.role==="SuperAdmin"?g("/admin-dashboard"):D.role==="Driver"?g("/driver-dashboard"):D.role==="Customer"?g("/customer-dashboard"):u("Unknown role, cannot redirect.")}catch(j){u(((b=(o=j.response)==null?void 0:o.data)==null?void 0:b.message)||"Login failed")}finally{c(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-[#e6e9f0] p-8",children:[e.jsx("style",{children:`
        .wedge {
          position: absolute;
          left: 0;
          top: 0;
          width: 140px;
          height: 160px;
          transform: translate(-40px,-40px) rotate(-22deg);
          background: white;
          z-index: 0;
        }
        .inner-card {
          border-radius: 14px;
          box-shadow: 0 10px 24px rgba(0,0,0,0.25);
        }
        .soft-rounded-left {
          border-top-left-radius: 12px;
          border-bottom-left-radius: 12px;
        }
        .soft-rounded-right {
          border-top-right-radius: 12px;
          border-bottom-right-radius: 12px;
        }
        /* thin underline inputs like the design */
        .underline-input {
          background: transparent;
          border: none;
          border-bottom: 1px solid rgba(255,255,255,0.35);
          padding: 8px 6px;
          outline: none;
        }
        .underline-input::placeholder { color: rgba(255,255,255,0.5); }
        /* social circular icons */
        .social-circle { width:36px; height:36px; border-radius:9999px; display:inline-flex; align-items:center; justify-content:center; background:white; }
      `}),e.jsxs("div",{className:"relative w-full max-w-6xl inner-card overflow-hidden bg-white flex",style:{borderRadius:18},children:[e.jsx("div",{className:"wedge"}),e.jsxs("div",{className:"hidden md:block w-1/2 relative soft-rounded-left",style:{minHeight:540},children:[e.jsx("img",{src:"/images/loginImage.jpeg",alt:"hero",className:"w-full h-[650px] object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-[rgba(11,38,88,0.55)] mix-blend-multiply"})]}),e.jsx("div",{className:"w-full md:w-1/2 bg-[#164380] text-white p-14 soft-rounded-right flex flex-col justify-center",style:{minHeight:540},children:e.jsxs("div",{className:"max-w-md mx-auto w-full",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{style:{borderLeft:"4px solid rgba(255,255,255,0.85)",paddingLeft:12},children:e.jsx("h2",{className:"text-2xl md:text-3xl font-serif tracking-wider",style:{fontFamily:"Georgia, serif"},children:"ADMIN LOGIN PORTAL"})})}),p&&e.jsx("p",{className:"text-red-300 text-center mb-3",children:p}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2",children:"Email"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{className:"underline-input w-full text-white placeholder-gray-300",placeholder:"Email",value:t,onChange:A=>r(A.target.value),required:!0}),e.jsxs("div",{className:"ml-3 opacity-70",children:[" ",e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"rgba(255,255,255,0.9)",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7"}),e.jsx("path",{d:"M7 10l5 5 5-5"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2",children:"Password"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:n?"text":"password",className:"underline-input w-full text-white placeholder-gray-300",placeholder:"Password",value:s,onChange:A=>l(A.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>i(!n),className:"ml-3 opacity-80",children:n?e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"rgba(255,255,255,0.9)",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 20c-5.52 0-10.21-3.58-11.8-8 1.07-2.9 3.06-5.2 5.44-6.6"}),e.jsx("path",{d:"M1 1l22 22"})]}):e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"rgba(255,255,255,0.9)",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),e.jsx("button",{type:"submit",disabled:m,className:"mt-2 w-full bg-white text-[#264c7f] font-semibold py-3 rounded-full shadow-md hover:bg-gray-100 transition disabled:opacity-60",children:m?"Logging in...":"Login"})]})]})})]})]})}const Zt=()=>{const t=q(),[r,s]=a.useState({name:"",type:""}),[l,n]=a.useState(null),[i,p]=a.useState(!1),[u,m]=a.useState(null),[c,g]=a.useState(!1),[x,k]=a.useState(!1),{name:h,role:A}=V();console.log("Logged in user:",h,"Role:",A);const o=S=>{S.target.name==="image"?n(S.target.files[0]):s({...r,[S.target.name]:S.target.value})},b=async()=>{p(!0),m(null);const S=new FormData;S.append("name",r.name),S.append("type",r.type),l&&S.append("image",l);try{const D=await fetch("https://rashen.sceniccottage.com/api/products",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:S});if(D.ok)k(!0),s({name:"",type:""}),n(null);else{const w=await D.json();m(w.message||"Unknown error occurred.")}}catch(D){console.error("Error adding product:",D),m("An error occurred while adding the product.")}finally{p(!1)}},j=S=>{S.preventDefault(),g(!0)};return e.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gray-100",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Add New Product"}),x&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4 text-center",children:"✅ Product added successfully!"}),u&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 text-center",children:["❌ ",u]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Product Name",value:r.name,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0}),e.jsxs("select",{name:"type",value:r.type,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select Product Type"}),e.jsx("option",{value:"fruit",children:"Fruit"}),e.jsx("option",{value:"vegetable",children:"Vegetable"}),e.jsx("option",{value:"rice",children:"Rice"}),e.jsx("option",{value:"potatoes",children:"Potatoes"}),e.jsx("option",{value:"Leaf Vegetable",children:"Leaf Vegetable"}),e.jsx("option",{value:"Grain",children:"Grain"})]}),e.jsx("input",{type:"file",name:"image",onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg"}),e.jsx(G,{open:c,message:"Confirm Product Addition",additionalInfo:"Double check product details and image before submitting.",confirmText:"Yes, Add Product",cancelText:"No, Go Back",icon:e.jsx(et,{}),buttonBackgroundColor:"bg-blue-600",buttonTextColor:"text-white",onConfirm:()=>{g(!1),b()},onCancel:()=>g(!1),children:e.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition duration-300",disabled:i,children:i?"Adding...":"Add Product"})}),e.jsx("button",{type:"button",onClick:()=>t("/product-management"),className:"w-full mt-2 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition duration-300",children:"Cancel"})]})]})})},Jt=()=>{const t=q(),{id:r}=fe(),[s,l]=a.useState({name:"",type:"fruit",image:null}),[n,i]=a.useState(null),[p,u]=a.useState(!0),[m,c]=a.useState(!1),[g,x]=a.useState(null),[k,h]=a.useState(null),[A,o]=a.useState(!1),{name:b,role:j}=V();console.log("Logged in user:",b,"Role:",j),a.useEffect(()=>{(async()=>{try{const v=await z.get(`/api/products/${r}`);l({name:v.data.name,type:v.data.type,image:null}),i(v.data.image||null)}catch{x("❌ Failed to load product details.")}finally{u(!1)}})()},[r]),a.useEffect(()=>{if(g||k){const C=setTimeout(()=>{x(null),h(null)},3e3);return()=>clearTimeout(C)}},[g,k]);const S=C=>{const{name:v,value:E}=C.target;l(N=>({...N,[v]:E}))},D=C=>{const v=C.target.files[0];v&&(l(E=>({...E,image:v})),i(URL.createObjectURL(v)))},w=async()=>{c(!0);try{const C=new FormData;C.append("name",s.name),C.append("type",s.type),s.image&&C.append("image",s.image),await z.put(`/api/products/${r}`,C,{headers:{"Content-Type":"multipart/form-data"}}),h("✅ Product updated successfully! Redirecting..."),setTimeout(()=>{t("/view-products")},2e3)}catch{x("❌ Failed to update product.")}finally{c(!1)}};return p?e.jsx("div",{className:"text-center",children:"Loading..."}):e.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gray-100",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-6 text-center",children:["Editing Product ID: ",r]}),g&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 text-center",children:g}),k&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4 text-center",children:k}),e.jsxs("form",{className:"space-y-4",onSubmit:C=>C.preventDefault(),encType:"multipart/form-data",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Product Name"}),e.jsx("input",{type:"text",name:"name",value:s.name,onChange:S,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Product Type"}),e.jsxs("select",{name:"type",value:s.type,onChange:S,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0,children:[e.jsx("option",{value:"fruit",children:"Fruit"}),e.jsx("option",{value:"vegetable",children:"Vegetable"}),e.jsx("option",{value:"rice",children:"Rice"}),e.jsx("option",{value:"potatoes",children:"Potatoes"}),e.jsx("option",{value:"Leaf Vegetable",children:"Leaf Vegetable"}),e.jsx("option",{value:"Grain",children:"Grain"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:D,className:"w-full p-2 border border-gray-300 rounded-lg"}),n&&e.jsx("img",{src:n,alt:"Preview",className:"mt-2 w-32 h-32 object-cover rounded border"})]}),e.jsx(G,{open:A,message:`Update Confirmation for Product ID: ${r}`,additionalInfo:`Are you sure you want to update "${s.name}" (Product ID: ${r})? Changes will be saved.`,confirmText:"Yes, Update Product",cancelText:"No, Cancel",onConfirm:()=>{o(!1),w()},onCancel:()=>o(!1),icon:e.jsx(wt,{}),children:e.jsx("button",{type:"button",onClick:()=>o(!0),className:"w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition duration-300",disabled:m,children:m?"Updating...":"Update Product"})}),e.jsx("button",{type:"button",onClick:()=>t("/view-products"),className:"w-full mt-2 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition duration-300",children:"Cancel"})]})]})})},es=()=>{const t=q(),{name:r,role:s}=V();return console.log("Logged in user:",r,"Role:",s),e.jsxs("div",{className:"flex flex-col md:flex-row h-screen",children:[e.jsx(re,{}),e.jsxs("div",{className:"p-8 w-full overflow-auto",children:[e.jsxs("div",{className:"text-3xl font-semibold mb-8",children:[e.jsx("h1",{children:"Product Management"}),e.jsx("p",{className:"text-lg text-gray-500",children:"Manage your products effectively"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(oe,{className:"mr-2 text-blue-600"}),"Add New Product"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Add a new product to your catalog."}),e.jsx("button",{className:"bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 w-full sm:w-auto",onClick:()=>t("/add-product"),children:"Add Product"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(tt,{className:"mr-2 text-green-600"}),"View All Products"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"View a complete list of your products."}),e.jsx("button",{className:"bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 w-full sm:w-auto",onClick:()=>t("/view-products"),children:"View Products"})]})]})]})]})},ts=()=>{const t=q(),[r,s]=a.useState([]),[l,n]=a.useState(""),[i,p]=a.useState(!0),[u,m]=a.useState(null),{name:c,role:g}=V();console.log("Logged in user:",c,"Role:",g),a.useEffect(()=>{(async()=>{var o,b;try{const j=await z.get("/api/products");s(j.data)}catch(j){m(((b=(o=j.response)==null?void 0:o.data)==null?void 0:b.message)||"Failed to fetch products.")}finally{p(!1)}})()},[]);const x=async A=>{var o,b;try{await z.delete(`/api/products/${A}`),s(j=>j.filter(S=>S.id!==A)),Ye.success("Product deleted successfully!")}catch(j){Ye.error(((b=(o=j.response)==null?void 0:o.data)==null?void 0:b.message)||"Failed to delete product.")}},k=a.useMemo(()=>[{accessorKey:"id",header:"Product ID",cell:A=>e.jsx("button",{onClick:()=>t(`/product-summary/${A.row.original.id}`),className:"text-blue-600 underline hover:text-blue-800 text-sm",children:He(A.getValue(),l)})},{accessorKey:"name",header:"Product Name",cell:A=>e.jsx("span",{className:"text-sm",children:He(A.getValue(),l)})},{accessorKey:"type",header:"Type",cell:A=>e.jsx("span",{className:"capitalize text-sm",children:A.getValue()})},{accessorKey:"image",header:"Image",cell:A=>A.getValue()?e.jsx("img",{src:A.getValue(),alt:"Product",onError:o=>{o.target.onerror=null,o.target.src="/default-product.png"},className:"w-16 h-16 object-cover rounded"}):e.jsx("span",{className:"text-gray-400 italic text-sm",children:"No Image"})},{id:"actions",header:"Actions",cell:A=>{const o=A.row.original;return e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>t(`/edit-product/${o.id}`),className:"bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-md text-sm",children:"Edit"}),e.jsx(G,{message:`Are you sure you want to delete product "${o.name}" with ID "${o.id}"?`,onConfirm:()=>x(o.id),children:e.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md text-sm",children:"Delete"})})]})}}],[t,l]),h=_t({data:r,columns:k,state:{globalFilter:l},onGlobalFilterChange:n,getCoreRowModel:kt(),getFilteredRowModel:St(),getPaginationRowModel:Ct()});return e.jsxs("div",{className:"flex flex-col items-center min-h-screen bg-gray-50 py-8 relative",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-lg w-full max-w-6xl p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-center text-gray-800 mb-6",children:"View All Products"}),e.jsx("div",{className:"mb-6",children:e.jsx("input",{type:"text",placeholder:"Search by ID or Name",value:l??"",onChange:A=>h.setGlobalFilter(A.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 text-gray-700"})}),i?e.jsx("div",{className:"text-center text-gray-500",children:"Loading..."}):u?e.jsx("div",{className:"text-center text-red-600",children:u}):r.length===0?e.jsx("div",{className:"text-center text-gray-500 py-10",children:"No products found."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-teal-600 text-white",children:h.getHeaderGroups().map(A=>e.jsx("tr",{children:A.headers.map(o=>e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:Ue(o.column.columnDef.header,o.getContext())},o.id))},A.id))}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.getRowModel().rows.map(A=>e.jsx("tr",{className:"hover:bg-gray-50",children:A.getVisibleCells().map(o=>e.jsx("td",{className:"px-6 py-4",children:Ue(o.column.columnDef.cell,o.getContext())},o.id))},A.id))})]})}),e.jsxs("div",{className:"flex justify-center items-center mt-6 gap-4",children:[e.jsx("button",{disabled:!h.getCanPreviousPage(),onClick:()=>h.previousPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"text-gray-700",children:["Page ",h.getState().pagination.pageIndex+1," of ",h.getPageCount()]}),e.jsx("button",{disabled:!h.getCanNextPage(),onClick:()=>h.nextPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Next"})]})]})]}),e.jsx("button",{onClick:()=>t("/product-management"),className:"fixed bottom-8 right-8 bg-gray-800 text-white py-3 px-6 rounded-full shadow-lg hover:bg-gray-900 transition duration-200",children:"Back to Management"})]})};function He(t,r){return r?t.toString().split(new RegExp(`(${r})`,"gi")).map((l,n)=>l.toLowerCase()===r.toLowerCase()?e.jsx("mark",{className:"bg-yellow-200",children:l},n):l):t}const ss=()=>{const t=q(),[r,s]=a.useState({type:"",topic:"",description:"",image:null,document:null,videoUrl:"",externalLink:""}),[l,n]=a.useState(!1),[i,p]=a.useState(null),[u,m]=a.useState(!1),[c,g]=a.useState(!1),{name:x,role:k}=V();a.useEffect(()=>{if(i){const S=setTimeout(()=>p(null),3e3);return()=>clearTimeout(S)}},[i]);const h=S=>{const{name:D,value:w}=S.target;s({...r,[D]:w})},A=S=>{const{name:D,files:w}=S.target;s({...r,[D]:w[0]||null})},o=async S=>{if(S.preventDefault(),!c)return;n(!0),p(null);const D=localStorage.getItem("token");if(!D){p("Unauthorized! Please log in first."),t("/login");return}const w=new FormData;w.append("type",r.type),w.append("topic",r.topic),w.append("description",r.description),r.image&&w.append("image",r.image),r.document&&w.append("document",r.document),r.videoUrl&&w.append("videoUrl",r.videoUrl),r.externalLink&&w.append("externalLink",r.externalLink);try{const C=await fetch("https://rashen.sceniccottage.com/api/publications",{method:"POST",headers:{Authorization:`Bearer ${D}`},body:w});if(C.ok)m(!0),s({type:"",topic:"",description:"",image:null,document:null,videoUrl:"",externalLink:""}),setTimeout(()=>{m(!1),t("/publication")},2e3);else{const v=await C.json();p(v.message||"Unknown error occurred.")}}catch(C){console.error("Error adding publication:",C),p("An error occurred while adding the publication.")}finally{n(!1),g(!1)}},b=()=>{g(!0),o(new Event("submit"))},j=()=>{g(!1)};return e.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gray-100",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Add New Publication"}),i&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 text-center",children:["❌ ",i]}),u&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4 text-center",children:"✅ Publication has been added successfully!"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("select",{name:"type",value:r.type,onChange:h,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"notice",children:"Notice"}),e.jsx("option",{value:"news",children:"News"}),e.jsx("option",{value:"announcement",children:"Announcement"}),e.jsx("option",{value:"event",children:"Event"})]}),e.jsx("input",{type:"text",name:"topic",placeholder:"Topic",value:r.topic,onChange:h,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0}),e.jsx("textarea",{name:"description",placeholder:"Description",value:r.description,onChange:h,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0}),e.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:A,className:"w-full p-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"file",name:"document",accept:".pdf,.doc,.docx,.xls,.xlsx",onChange:A,className:"w-full p-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"url",name:"videoUrl",placeholder:"Video URL (e.g., YouTube)",value:r.videoUrl,onChange:h,className:"w-full p-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"url",name:"externalLink",placeholder:"External Link",value:r.externalLink,onChange:h,className:"w-full p-2 border border-gray-300 rounded-lg"}),e.jsx(G,{onConfirm:b,onCancel:j,message:"Confirm Adding Publication",additionalInfo:"Please verify all details before submission.",confirmText:"Yes, Add Publication",cancelText:"No, Go Back",icon:e.jsx(et,{}),buttonBackgroundColor:"bg-blue-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition duration-300",disabled:l,children:l?"Adding...":"Add Publication"})}),e.jsx("button",{type:"button",onClick:()=>t("/publication"),className:"w-full mt-2 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition duration-300",children:"Cancel"})]})]})})},as=()=>{const t=q(),{name:r,role:s}=V();return console.log("Logged in user:",r,"Role:",s),e.jsxs("div",{className:"flex flex-col md:flex-row h-screen",children:[e.jsx(re,{}),e.jsxs("div",{className:"p-8 w-full overflow-auto",children:[e.jsxs("div",{className:"text-3xl font-semibold mb-8",children:[e.jsx("h1",{children:"Publication Management"}),e.jsx("p",{className:"text-lg text-gray-500",children:"Manage publications efficiently"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(oe,{className:"mr-2 text-blue-600"}),"Add New Publication"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Create a new publication to share with users."}),e.jsx("button",{className:"bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 w-full sm:w-auto",onClick:()=>t("/add-publication"),children:"Add Publication"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(tt,{className:"mr-2 text-green-600"}),"View All Publications"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"See the complete list of all publications."}),e.jsx("button",{className:"bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 w-full sm:w-auto",onClick:()=>t("/view-publications"),children:"View Publications"})]})]})]})]})},ls=()=>{const t=q(),[r,s]=a.useState([]),[l,n]=a.useState("notice"),[i,p]=a.useState(!0),[u,m]=a.useState(null),[c,g]=a.useState(null),{name:x,role:k}=V();console.log("Logged in user:",x,"Role:",k),a.useEffect(()=>{(async()=>{var j,S;try{const D=await z.get("/api/publications");s(D.data)}catch(D){m(((S=(j=D.response)==null?void 0:j.data)==null?void 0:S.message)||"Failed to fetch publications.")}finally{p(!1)}})()},[]),a.useEffect(()=>{if(c||u){const b=setTimeout(()=>{g(null),m(null)},5e3);return()=>clearTimeout(b)}},[c,u]);const h=async b=>{var j,S;try{const D=r.find(w=>w.id===b);await z.delete(`/api/publications/${b}`),s(r.filter(w=>w.id!==b)),g(`✅ Publication "${D==null?void 0:D.topic}" deleted successfully.`)}catch(D){m(((S=(j=D.response)==null?void 0:j.data)==null?void 0:S.message)||"Failed to delete publication.")}},A=r.filter(b=>b.type===l),o=b=>`px-4 py-2 rounded-t-lg font-semibold ${l===b?"bg-teal-600 text-white":"bg-gray-200 text-gray-700"}`;return e.jsxs("div",{className:"flex justify-center items-center min-h-screen bg-gray-50 py-10 relative",children:[e.jsxs("div",{className:"bg-white shadow-xl rounded-lg w-full max-w-6xl p-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-6",children:"View Publications"}),e.jsx("div",{className:"flex justify-center gap-4 mb-6",children:["notice","announcement","news","event"].map(b=>e.jsx("button",{className:o(b),onClick:()=>n(b),children:b.charAt(0).toUpperCase()+b.slice(1)},b))}),c&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4 text-center",children:c}),u&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 text-center",children:["❌ ",u]}),i?e.jsx("div",{className:"text-center text-gray-500",children:"Loading..."}):A.length===0?e.jsxs("div",{className:"text-center text-gray-600",children:["No ",l," found."]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto border rounded-lg",children:[e.jsx("thead",{className:"bg-teal-600 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Topic"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Image"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Actions"})]})}),e.jsx("tbody",{className:"text-gray-700",children:A.map(b=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm",children:b.id}),e.jsx("td",{className:"px-6 py-4 text-sm",children:b.topic}),e.jsx("td",{className:"px-6 py-4 text-sm",children:b.description}),e.jsx("td",{className:"px-6 py-4 text-sm",children:b.image?e.jsx("img",{src:b.image,alt:"Publication",className:"w-20 h-20 object-cover rounded shadow"}):e.jsx("span",{className:"text-gray-400 italic",children:"No image"})}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx(G,{message:`Are you sure you want to delete the publication "${b.topic}"? This action cannot be undone.`,onConfirm:()=>h(b.id),children:e.jsx("button",{className:"bg-red-600 text-white py-1 px-3 rounded-lg hover:bg-red-700 transition duration-200",children:"Delete"})})})]},b.id))})]})})]}),e.jsx("button",{onClick:()=>t("/publication"),className:"fixed bottom-8 right-8 bg-gray-800 text-white py-3 px-6 rounded-full shadow-lg hover:bg-gray-900 transition duration-200",children:"Back to Main Menu"})]})},ge=({trip:t={},selectedVehicle:r={},selectedDriver:s={}})=>{const l=Number(t.estimated_days)||1,n=Number(t.estimated_distance)||0,i=Number(r==null?void 0:r.rent_cost_daily)||Number(r==null?void 0:r.owner_rent)||0,p=Number(r==null?void 0:r.mileage_cost)||0,u=Number(r==null?void 0:r.additional_mileage_cost)||0,m=Number(r==null?void 0:r.fuel_cost)||0,c=Number(r==null?void 0:r.fuel_efficiency)||0,g=Number(s==null?void 0:s.driver_cost)||0,x=Number(t.damage_cost)||0,k=(t.other_trip_costs||[]).reduce((N,f)=>N+(Number(f.cost)||0),0),h=c>0?n/c*m:0,A=Math.min(l*100,n),o=Math.max(n-l*100,0),b=A*p,j=o*u,S=t.driver_required==="Yes"?g*l:0,D=i*l+b+j+S+k;let w=Number(t.discount)||0;w>D&&(w=D);const C=D-w-x,E=D-(h+S+k+i*l)-w;return{totalEstimatedCost:C,profit:E,discount:w}},rs=({trip:t,setTrip:r,vehicles:s=[],customers:l=[],drivers:n=[],handleChange:i,addWaypoint:p,removeWaypoint:u,handleWaypointChange:m,selectedVehicle:c,selectedDriver:g,waypointRefs:x,addOtherCost:k,handleCostChange:h,removeOtherCost:A,fromInputRef:o,toInputRef:b})=>{var N;const[j,S]=a.useState(t.total_estimated_cost||0),[D,w]=a.useState(t.profit||0),C=Array.isArray(t.waypoints)?t.waypoints:[],v=Array.isArray(t.other_trip_costs)?t.other_trip_costs:[];a.useEffect(()=>{const{totalEstimatedCost:f,profit:T,discount:d}=ge({trip:t,selectedVehicle:c,selectedDriver:g});S(f),w(T),r&&r({...t,total_estimated_cost:f,profit:T,discount:d||0})},[t.estimated_days,t.estimated_distance,t.discount,t.damage_cost,t.other_trip_costs,c,g]);const E=(f,T)=>{r(d=>{const _=[...d.waypoints||[]];return _[f]=T,{...d,waypoints:_}})};return a.useEffect(()=>{const f=Number(t.payment_amount||0);r&&r(T=>({...T,advance_payment:f,payment_status:f>0?"Partially_Paid":"Unpaid"}))},[t.payment_amount,r]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer"}),e.jsxs("select",{name:"customer_id",value:t.customer_id||"",onChange:i,className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select Customer"}),l.map(f=>e.jsxs("option",{value:f.customer_id,children:[f.name," ",f.nic?`- ${f.nic}`:""]},f.customer_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle"}),e.jsxs("select",{name:"vehicle_id",value:t.vehicle_id||"",onChange:i,className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select Vehicle"}),s.map(f=>e.jsxs("option",{value:f.vehicle_id||f.id,children:[f.name," (",f.vehicle_number,")"]},f.vehicle_id||f.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Driver (Optional)"}),e.jsxs("select",{name:"driver_id",value:t.driver_id||"",onChange:i,className:"input",children:[e.jsx("option",{value:"",children:"Select Driver"}),n.map(f=>e.jsx("option",{value:f.driver_id||f.id,children:f.name},f.driver_id||f.id))]})]})]}),c&&e.jsxs("div",{className:"bg-purple-50 p-4 rounded-xl border border-purple-300 mt-4 space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-700",children:"Vehicle Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{children:["Fuel Type: ",e.jsx("span",{className:"font-medium",children:(N=c.fuel)==null?void 0:N.type})]}),e.jsxs("div",{children:["Fuel Cost (Rs/L): ",e.jsx("span",{className:"font-medium",children:c.fuel_cost})]}),e.jsxs("div",{children:["Fuel Efficiency (km/L): ",e.jsx("span",{className:"font-medium",children:c.fuel_efficiency})]}),e.jsxs("div",{children:["Mileage Cost (Rs/km): ",e.jsx("span",{className:"font-medium",children:c.mileage_cost})]}),e.jsxs("div",{children:["Additional Mileage Cost (Rs/km): ",e.jsx("span",{className:"font-medium",children:c.additional_mileage_cost})]}),e.jsxs("div",{children:["Daily Rent / Lease: ",e.jsx("span",{className:"font-medium",children:c.rent_cost_daily||c.owner_rent})]})]})]}),g&&e.jsxs("div",{className:"bg-pink-50 p-4 rounded-xl border border-pink-300 mt-4 space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-pink-700",children:"Driver Details"}),e.jsxs("div",{children:["Driver Name: ",e.jsx("span",{className:"font-medium",children:g.name})]}),e.jsxs("div",{children:["Driver Cost per Day (Rs): ",e.jsx("span",{className:"font-medium",children:g.driver_cost})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Location"}),e.jsx("input",{ref:o,type:"text",name:"from_location",value:t.from_location||"",onChange:i,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Location"}),e.jsx("input",{ref:b,type:"text",name:"to_location",value:t.to_location||"",onChange:i,className:"input",required:!0})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Waypoints (Route Order)"}),e.jsxs("button",{type:"button",onClick:p,className:"flex items-center gap-1 px-3 py-1 rounded-lg bg-purple-600 text-white text-sm hover:bg-purple-800",children:[e.jsx(qe,{})," Add"]})]}),C.length===0&&e.jsx("p",{className:"text-gray-500 text-sm italic",children:"No waypoints added"}),e.jsx("div",{className:"space-y-3",children:C.map((f,T)=>e.jsxs("div",{className:"flex items-center gap-3 bg-white p-3 rounded-lg shadow-sm border-l-4 border-purple-600",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-600 text-white flex items-center justify-center font-bold",children:T+1}),e.jsx("input",{type:"text",ref:d=>x.current[T]=d,value:f,onChange:d=>E(T,d.target.value),placeholder:`Enter waypoint ${T+1}`,className:"input flex-1"}),e.jsx("button",{type:"button",onClick:()=>u(T),className:"text-red-500 hover:text-red-700",children:e.jsx(ne,{})})]},T))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Leaving Date & Time"}),e.jsx("input",{type:"datetime-local",name:"leaving_datetime",value:t.leaving_datetime||"",onChange:i,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Estimated Return Date & Time"}),e.jsx("input",{type:"datetime-local",name:"estimated_return_datetime",value:t.estimated_return_datetime||"",onChange:i,className:"input",required:!0,min:t.leaving_datetime||""})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Estimated Days"}),e.jsx("input",{type:"number",name:"estimated_days",value:t.estimated_days||"",onChange:i,className:"input",min:"1",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Estimated Distance (km)"}),e.jsx("input",{type:"number",name:"estimated_distance",value:t.estimated_distance||"",onChange:i,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Number of Passengers"}),e.jsx("input",{type:"number",name:"num_passengers",value:t.num_passengers||"",onChange:i,className:"input"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center justify-between",children:["Other Trip Costs",e.jsx("button",{type:"button",onClick:k,className:"text-purple-600 hover:text-purple-800",children:e.jsx(qe,{})})]}),v.map((f,T)=>e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-2",children:[e.jsxs("select",{value:f.cost_type||"",onChange:d=>h(T,"cost_type",d.target.value),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select Cost Type"}),e.jsx("option",{value:"Meal",children:"Meal"}),e.jsx("option",{value:"Accommodation",children:"Accommodation"}),e.jsx("option",{value:"Driver_Accommodation",children:"Driver Accommodation"}),e.jsx("option",{value:"Driver_Meal",children:"Driver Meal"}),e.jsx("option",{value:"Other",children:"Other"})]}),e.jsx("input",{type:"number",value:f.cost||"",onChange:d=>h(T,"cost",d.target.value),className:"input",placeholder:"Cost Amount",required:!0}),e.jsx("button",{type:"button",onClick:()=>A(T),className:"text-red-600 hover:text-red-800",children:e.jsx(ne,{})})]},T))]}),e.jsxs("div",{children:[e.jsx("label",{className:"label font-semibold",children:"Discount (Rs)"}),e.jsx("input",{type:"number",name:"discount",value:t.discount||0,onChange:i,className:"input",min:"0",placeholder:"Enter discount amount"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"p-5 rounded-xl bg-gray-100 border border-gray-300 shadow-sm",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-700",children:"Total Estimated Cost"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:["Rs ",j.toLocaleString()]})]}),e.jsxs("div",{className:"p-5 rounded-xl bg-purple-100 border border-purple-300 shadow-sm",children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-700",children:"Profit"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-900 mt-2",children:["Rs ",D.toLocaleString()]})]})]}),e.jsxs("div",{className:"bg-pink-50 p-4 rounded-xl border border-pink-300",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-pink-700",children:"Payment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Amount (Rs)"}),e.jsx("input",{type:"number",name:"payment_amount",value:t.payment_amount||"",onChange:i,className:"input",min:"0",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Advance Payment (Rs)"}),e.jsx("input",{type:"number",name:"advance_payment",value:t.advance_payment||"",className:"input bg-gray-100 cursor-not-allowed",readOnly:!0})]})]})]})]})},ns=({trip:t,setTrip:r,fromInputRef:s,toInputRef:l,waypointRefs:n,vehicles:i=[],calculateTotalEstimatedCost:p,mapRef:u,GOOGLE_MAPS_API_KEY:m})=>{var S,D;const c=a.useRef(null),g=a.useRef(null),x=a.useRef(null),k=()=>{if(window.google&&window.google.maps){h();return}if(document.getElementById("google-maps-script"))return;const w=document.createElement("script");w.id="google-maps-script",w.src=`https://maps.googleapis.com/maps/api/js?key=${m}&libraries=places`,w.async=!0,w.defer=!0,w.onload=h,document.head.appendChild(w)};a.useEffect(()=>{k()},[]);const h=()=>{!(u!=null&&u.current)||!window.google||(c.current=new window.google.maps.Map(u.current,{center:{lat:7.8731,lng:80.7718},zoom:7}),g.current=new window.google.maps.DirectionsRenderer,x.current=new window.google.maps.DirectionsService,g.current.setMap(c.current),A(s,w=>j("from_location",w)),A(l,w=>j("to_location",w)),o(),c.current.addListener("click",w=>{new window.google.maps.Geocoder().geocode({location:w.latLng},(v,E)=>{if(E!=="OK"||!(v!=null&&v[0]))return;const N=v[0].formatted_address;r(f=>{const T=Array.isArray(f.waypoints)?f.waypoints:[];return f.from_location?f.to_location?{...f,waypoints:[...T,N]}:{...f,to_location:N,waypoints:T}:{...f,from_location:N,waypoints:T}}),setTimeout(()=>b(),300)})}))},A=(w,C)=>{try{const v=w==null?void 0:w.current;if(!v||!window.google)return;const E=v instanceof HTMLInputElement?v:v.querySelector("input")||v;if(!E)return;const N=new window.google.maps.places.Autocomplete(E);N.addListener("place_changed",()=>{const f=N.getPlace(),T=f.formatted_address||f.name;T&&(C(T),r(d=>({...d,waypoints:Array.isArray(d.waypoints)?d.waypoints:[]})))})}catch(v){console.warn("Autocomplete attach error:",v)}},o=()=>{!window.google||!(n!=null&&n.current)||n.current.forEach((w,C)=>{if(!w||w._auto)return;const v=w instanceof HTMLInputElement?w:w.querySelector("input")||w;if(v)try{const E=new window.google.maps.places.Autocomplete(v);E.addListener("place_changed",()=>{const N=E.getPlace(),f=N.formatted_address||N.name;f&&r(T=>{const _=[...Array.isArray(T.waypoints)?T.waypoints:[]];return _[C]=f,{...T,waypoints:_}})}),w._auto=!0}catch(E){console.warn("Waypoint autocomplete attach failed",E)}})},b=()=>{if(!t.from_location||!t.to_location)return;const w=Array.isArray(t.waypoints)?t.waypoints.filter(E=>E&&E.trim().length>0).map(E=>({location:E,stopover:!0})):[],C=x.current,v=g.current;!C||!v||C.route({origin:t.from_location,destination:t.to_location,travelMode:"DRIVING",waypoints:w,optimizeWaypoints:!1},(E,N)=>{if(N!=="OK"||!E){console.error("Route failed:",N);return}v.setDirections(E);let f=0;const T=E.routes[0].legs||[],d=[];T.forEach((y,P)=>{var $;f+=y.distance.value,P===0&&d.push({location_name:t.from_location,latitude:y.start_location.lat(),longitude:y.start_location.lng()}),d.push({location_name:y.end_address||((($=t.waypoints)==null?void 0:$[P])??t.to_location),latitude:y.end_location.lat(),longitude:y.end_location.lng()})});const _=(f/1e3).toFixed(2);r(y=>{const P={...y};P.estimated_distance=_,P.map_locations=d;const $=i.find(U=>Number(U.vehicle_id)===Number(P.vehicle_id));return P.total_estimated_cost=p(P,$),P})})};a.useEffect(()=>{o()},[(S=t.waypoints)==null?void 0:S.length]),a.useEffect(()=>{t.from_location&&t.to_location&&b()},[t.from_location,t.to_location,(D=t.waypoints)==null?void 0:D.join("|")]);const j=(w,C)=>{r(v=>({...v,[w]:C,waypoints:Array.isArray(v.waypoints)?v.waypoints:[]}))};return e.jsx("div",{ref:u,style:{width:"100%",height:"550px"},className:"rounded-xl border shadow"})},is="AIzaSyCRk-FYPlKX3xi51W9PHTd35fELrAvBs-0",os=()=>{const t=q(),{name:r}=V(),[s,l]=a.useState({customer_id:"",vehicle_id:"",driver_id:"",from_location:"",to_location:"",waypoints:[],up_down:"Both",estimated_distance:0,estimated_days:1,driver_required:"Yes",fuel_required:"Yes",num_passengers:0,discount:0,damage_cost:0,payment_amount:0,advance_payment:0,start_meter:0,end_meter:0,total_estimated_cost:0,total_actual_cost:0,payment_status:"Unpaid",trip_status:"Pending",leaving_datetime:"",estimated_return_datetime:"",map_locations:[],other_trip_costs:[]}),[n,i]=a.useState([]),[p,u]=a.useState([]),[m,c]=a.useState([]),[g,x]=a.useState(!1),[k,h]=a.useState(null),[A,o]=a.useState(!1),[b,j]=a.useState(!1),S=a.useRef(null),D=a.useRef(null),w=a.useRef(null),C=a.useRef([]);a.useEffect(()=>{(async()=>{var R,I;const M=localStorage.getItem("token");if(!M)return t("/login");try{const[B,H,Y]=await Promise.all([Z.get("https://rashen.sceniccottage.com/api/vehicles",{headers:{Authorization:`Bearer ${M}`}}),Z.get("https://rashen.sceniccottage.com/api/customers",{headers:{Authorization:`Bearer ${M}`}}),Z.get("https://rashen.sceniccottage.com/api/drivers",{headers:{Authorization:`Bearer ${M}`}})]);console.log("Fetched dropdown data:",H.data);const J=(B.data||[]).map(L=>{var O,X,ae,de,ce;return{...L,fuel_cost:Number(((O=L.fuel)==null?void 0:O.cost)||0),mileage_cost:Number(((ae=(X=L.mileage_costs)==null?void 0:X[0])==null?void 0:ae.mileage_cost)||0),additional_mileage_cost:Number(((ce=(de=L.mileage_costs)==null?void 0:de[0])==null?void 0:ce.mileage_cost_additional)||0),fuel_efficiency:Number(L.vehicle_fuel_efficiency||0)}}),Q=(((R=Y.data)==null?void 0:R.data)||Y.data||[]).map(L=>({...L,driver_cost:Number(L.driver_charges||0)}));i(J),u(((I=H.data)==null?void 0:I.data)||H.data||[]),c(Q)}catch{h("Failed to load dropdown data.")}})()},[t]);const v=n.find(F=>Number(F.vehicle_id)===Number(s.vehicle_id)||Number(F.id)===Number(s.vehicle_id)),E=m.find(F=>Number(F.driver_id)===Number(s.driver_id)||Number(F.id)===Number(s.driver_id)),N=F=>{const{name:M,value:R}=F.target,I={...s,[M]:R};if(M==="leaving_datetime"||M==="estimated_return_datetime"){const J=new Date(M==="leaving_datetime"?R:I.leaving_datetime),Q=new Date(M==="estimated_return_datetime"?R:I.estimated_return_datetime);if(!isNaN(J.getTime())&&!isNaN(Q.getTime())){const L=Q-J,O=Math.ceil(L/(1e3*60*60*24));I.estimated_days=O>0?O:1}}const{totalEstimatedCost:B,profit:H,discount:Y}=ge({trip:I,selectedVehicle:v,selectedDriver:E});I.total_estimated_cost=B,I.profit=H,I.discount=Y,l(I)},f=()=>l(F=>({...F,waypoints:[...F.waypoints,""]})),T=F=>l(M=>({...M,waypoints:M.waypoints.filter((R,I)=>I!==F)})),d=()=>l(F=>({...F,other_trip_costs:[...F.other_trip_costs,{cost_type:"",cost:0}]})),_=(F,M,R)=>{const I=[...s.other_trip_costs];I[F][M]=M==="cost"?Number(R):R;const{totalEstimatedCost:B,profit:H,discount:Y}=ge({trip:{...s,other_trip_costs:I},selectedVehicle:v,selectedDriver:E});l(J=>({...J,other_trip_costs:I,total_estimated_cost:B,profit:H,discount:Y}))},y=F=>{const M=s.other_trip_costs.filter((H,Y)=>Y!==F),{totalEstimatedCost:R,profit:I,discount:B}=ge({trip:{...s,other_trip_costs:M},selectedVehicle:v,selectedDriver:E});l(H=>({...H,other_trip_costs:M,total_estimated_cost:R,profit:I,discount:B}))},P=()=>{var F;j(!0),(F=document.getElementById("add-trip-form"))==null||F.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},$=()=>j(!1),U=async F=>{var M,R,I,B,H;if(F.preventDefault(),!!b){x(!0),h(null);try{const Y=localStorage.getItem("token");console.log("Submitting trip:",s);const J={customer_id:Number(s.customer_id),vehicle_id:Number(s.vehicle_id),driver_id:s.driver_id?Number(s.driver_id):null,from_location:s.from_location,to_location:s.to_location,up_down:s.up_down,estimated_distance:Number(s.estimated_distance),estimated_days:Number(s.estimated_days),driver_required:s.driver_required,fuel_required:s.fuel_required,num_passengers:Number(s.num_passengers),discount:Number(s.discount||0),damage_cost:Number(s.damage_cost||0),payment_amount:Number(s.payment_amount||0),advance_payment:Number(s.advance_payment||0),start_meter:Number(s.start_meter||0),end_meter:Number(s.end_meter||0),total_estimated_cost:Number(s.total_estimated_cost||0),total_actual_cost:Number(s.total_actual_cost||0),payment_status:s.payment_status,trip_status:s.trip_status,leaving_datetime:s.leaving_datetime,estimated_return_datetime:s.estimated_return_datetime,map_locations:(s.map_locations||[]).map(L=>({location_name:L.location_name,latitude:Number(L.latitude),longitude:Number(L.longitude)})),other_trip_costs:(s.other_trip_costs||[]).map(L=>({cost_type:L.cost_type,cost:Number(L.cost)}))};console.log("Submitting clean payload:",J);const Q=await Z.post("https://rashen.sceniccottage.com/api/trips",J,{headers:{Authorization:`Bearer ${Y}`,"Content-Type":"application/json"}});if(Q.status===200||Q.status===201){const O=`/trip/${((R=(M=Q.data)==null?void 0:M.data)==null?void 0:R.trip_id)||((I=Q.data)==null?void 0:I.trip_id)}`,X=window.open(O,"_blank"),ae=setInterval(()=>{clearInterval(ae),t("/trip-dashboard")},500)}else h("Unexpected response from server.")}catch(Y){h(((H=(B=Y.response)==null?void 0:B.data)==null?void 0:H.message)||"Failed to add trip")}finally{x(!1),j(!1)}}};return e.jsx("div",{className:"bg-gray-50 min-h-screen p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-3xl font-semibold text-violet-800 flex items-center gap-2",children:[e.jsx(At,{})," Trip Creation"]}),e.jsxs("button",{onClick:()=>t("/trip-dashboard"),className:"flex items-center gap-2 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded transition",children:[e.jsx(st,{})," Back to Trips"]})]}),k&&e.jsxs("div",{className:"bg-red-100 text-red-700 border border-red-400 px-4 py-3 rounded mb-4 text-center",children:["❌ ",k]}),A&&e.jsx("div",{className:"bg-green-100 text-green-700 border border-green-400 px-4 py-3 rounded mb-4 text-center",children:"✅ Trip added successfully!"}),e.jsxs("form",{id:"add-trip-form",onSubmit:U,className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(rs,{trip:s,vehicles:n,setTrip:l,customers:p,drivers:m,selectedVehicle:v,selectedDriver:E,handleChange:N,addWaypoint:f,removeWaypoint:T,handleWaypointChange:(F,M)=>N({target:{name:"waypoints",value:M}}),waypointRefs:C,addOtherCost:d,handleCostChange:_,removeOtherCost:y,fromInputRef:D,toInputRef:w}),e.jsx(G,{onConfirm:P,onCancel:$,message:"Confirm Adding Trip",additionalInfo:"Verify all details",confirmText:"Yes, Add Trip",cancelText:"No, Go Back",icon:e.jsx(Se,{}),buttonBackgroundColor:"bg-green-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-indigo-600 to-violet-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition mt-4",disabled:g,children:g?"Adding...":"Add Trip"})})]}),e.jsx("div",{className:"lg:col-span-2 h-[600px]",children:e.jsx(ns,{trip:s,setTrip:l,fromInputRef:D,toInputRef:w,waypointRefs:C,vehicles:n,calculateTotalEstimatedCost:ge,mapRef:S,GOOGLE_MAPS_API_KEY:is})})]})]})})};function cs({stats:t}){return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:e.jsx(ds,{title:"Total Customers",value:t.total,gradient:"from-indigo-600 to-violet-600"})})}function ds({title:t,value:r,gradient:s}){return e.jsxs("div",{className:`p-5 rounded-xl shadow-md text-white bg-gradient-to-r ${s}`,children:[e.jsx("div",{className:"text-md font-semibold opacity-90",children:t}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:r??0})]})}function ms({onAddCustomerClick:t}){return q(),e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow flex flex-col justify-between h-full",onClick:t,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-50",children:e.jsx(oe,{className:"text-blue-600"})}),e.jsx("div",{className:"font-semibold",children:"Add New Customer"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Register a new customer to the system."})]})})}function us({customers:t=[],loading:r,error:s,onSelectCustomer:l}){return e.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:r?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading customers..."}):s?e.jsx("div",{className:"text-center py-12 text-red-500",children:s}):t.length===0?e.jsx("div",{className:"text-center py-12 text-gray-600",children:"No customers found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:e.jsxs("table",{className:"min-w-full table-auto border-collapse",children:[e.jsx("thead",{className:"bg-white sticky top-0 z-10 text-left text-sm text-gray-600 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"",children:"Customer"}),e.jsx("th",{className:"py-3 px-4",children:"Email"}),e.jsx("th",{className:"py-3 px-4",children:"Phone"}),e.jsx("th",{className:"py-3 px-4",children:"NIC No"})]})}),e.jsx("tbody",{children:t.map(n=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition",onClick:()=>l(n),children:[e.jsxs("td",{className:"py-4 px-4 flex items-center gap-3",children:[e.jsx(xs,{name:n.name,src:n.avatar_url}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n.name}),e.jsx("div",{className:"text-xs text-gray-400",children:n.customer_id})]})]}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600",children:n.email||"—"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600",children:n.phone_number||"—"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600",children:n.nic||"—"})]},n.customer_id))})]})})})})}function xs({name:t,src:r}){if(r)return e.jsx("img",{src:r,alt:t,className:"w-10 h-10 rounded-full object-cover"});const s=(t||"U").split(" ").map(l=>l[0]).slice(0,2).join("").toUpperCase();return e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-semibold text-gray-700",children:s})}const hs=({onCancel:t,onSuccess:r})=>{const s=q(),[l,n]=a.useState({name:"",nic:"",nic_photo_front:"",nic_photo_back:"",phone_number:"",email:""}),[i,p]=a.useState(!1),[u,m]=a.useState(null),[c,g]=a.useState(!1),[x,k]=a.useState(!1),[h,A]=a.useState(!1),[o,b]=a.useState(""),[j,S]=a.useState(""),{name:D,role:w}=V();a.useEffect(()=>{if(u){const _=setTimeout(()=>m(null),3e3);return()=>clearTimeout(_)}},[u]);const C=_=>{const{name:y,value:P}=_.target;if(y==="nic"){P===""||T(P)?(n({...l,[y]:P}),b("")):(n({...l,[y]:P}),b("Invalid NIC format"));return}if(y==="phone_number"){P===""||d(P)?(n({...l,[y]:P}),S("")):(n({...l,[y]:P}),S("Invalid Phone Number format"));return}n({...l,[y]:P})},v=_=>{const{name:y,files:P}=_.target,$=P[0];if($){const U=new FileReader;U.onloadend=()=>{n(F=>({...F,[y]:U.result.split(",")[1]}))},U.readAsDataURL($)}},E=async _=>{if(_.preventDefault(),!x)return;p(!0),m(null);const y=localStorage.getItem("token");if(!y){m("Unauthorized! Please log in first."),s("/login");return}try{const P={...l,nic_photo_front:l.nic_photo_front?`data:image/png;base64,${l.nic_photo_front}`:null,nic_photo_back:l.nic_photo_back?`data:image/png;base64,${l.nic_photo_back}`:null},$=await Z.post("https://rashen.sceniccottage.com/api/customers",P,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`}});($.status===200||$.status===201)&&(r&&r($.data.data),g(!0),n({name:"",nic:"",nic_photo_front:"",nic_photo_back:"",phone_number:"",email:""}),setTimeout(()=>{g(!1),t?t():s("/customer-dashboard")},2e3))}catch(P){console.error("Error adding customer:",P),P.response?m(P.response.data.message||`Error: ${P.response.status} ${P.response.statusText}`):m("Network error. Please try again.")}finally{p(!1),k(!1)}},N=()=>{k(!0),E(new Event("submit"))},f=()=>{k(!1),t&&t()},T=_=>{const y=/^[0-9]{9}[vVxX]$/,P=/^[0-9]{12}$/;return y.test(_)||P.test(_)},d=_=>/^0[0-9]{9}$/.test(_);return e.jsx("div",{className:"flex justify-center items-center w-100 min-h-screen bg-grey-100",children:e.jsxs("div",{className:"bg-white p-15 rounded-lg shadow-lg w-full h-full max-w-md relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("button",{onClick:f,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})})}),e.jsx("h2",{className:"text-xl font-semibold mb-6 text-center",children:"Add New Customer"}),u&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 text-center",children:["❌ ",u]}),c&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4 text-center",children:"✅ Customer added successfully!"}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Customer Name",value:l.name,onChange:C,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0}),e.jsx("input",{type:"text",name:"nic",placeholder:"NIC Number",value:l.nic,onChange:C,className:`w-full p-2 border rounded-lg ${o?"border-red-500":"border-gray-300"}`,required:!0}),o&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"NIC Front Image"}),e.jsx("input",{type:"file",accept:"image/*",name:"nic_photo_front",onChange:v,className:"w-full border p-2 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"NIC Back Image"}),e.jsx("input",{type:"file",accept:"image/*",name:"nic_photo_back",onChange:v,className:"w-full border p-2 rounded-lg",required:!0})]}),e.jsx("input",{type:"text",name:"phone_number",placeholder:"Phone Number (e.g., 07XXXXXXXX)",value:l.phone_number,onChange:C,className:`w-full p-2 border rounded-lg ${j?"border-red-500":"border-gray-300"}`,required:!0}),j&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:j}),e.jsx("input",{type:"email",name:"email",placeholder:"Email Address",value:l.email,onChange:C,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0}),e.jsx(G,{onConfirm:N,onCancel:f,message:"Confirm Adding Customer",additionalInfo:"Please verify the details before submission.",confirmText:"Yes, Add Customer",cancelText:"No, Go Back",icon:e.jsx(je,{}),buttonBackgroundColor:"bg-green-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"submit",className:"mt-4 w-full bg-gradient-to-r from-indigo-600 to-violet-600 text-white py-2 rounded-lg hover:bg-blue-800 transition duration-300",disabled:i,children:i?"Adding...":"Add Customer"})})]})]})})};function ps({onSearch:t}){const[r,s]=a.useState(""),l=n=>{const i=n.target.value;s(i),t(i)};return e.jsx("div",{className:"w-full mb-4 outline-none",children:e.jsxs("div",{className:"flex items-center bg-white p-3 rounded-lg  shadow flex",children:[e.jsx(ue,{className:"text-gray-400 mr-3 "}),e.jsx("input",{type:"text",placeholder:"Search customer by name, NIC, phone...",value:r,onChange:l,className:"w-full outline-none text-sm "})]})})}function Te({customer:t,onCancel:r,onSuccess:s}){const[l,n]=a.useState({...t}),[i,p]=a.useState(!1),[u,m]=a.useState(null),[c,g]=a.useState(""),[x,k]=a.useState(""),[h,A]=a.useState("");a.useEffect(()=>{n({...t})},[t]);const o=w=>/^[0-9]{9}[vVxX]$/.test(w)||/^[0-9]{12}$/.test(w),b=w=>/^0[0-9]{9}$/.test(w),j=w=>{const{name:C,value:v}=w.target;C==="nic"&&k(o(v)?"":"Invalid NIC format."),C==="phone_number"&&A(b(v)?"":"Phone must start with 0 and contain 10 digits."),n({...l,[C]:v})},S=(w,C)=>{const v=w.target.files[0];if(!v)return;const E=new FileReader;E.onloadend=()=>n({...l,[C]:E.result}),E.readAsDataURL(v)},D=async()=>{var w,C;if(x||h){m("Please fix validation errors before saving.");return}p(!0),m(null);try{const v={name:l.name,nic:l.nic,phone_number:l.phone_number,email:l.email,nic_photo_front:l.nic_photo_front,nic_photo_back:l.nic_photo_back},E=await z.put(`/api/customers/${t.customer_id}`,v,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});g("Customer updated successfully!"),s(E.data.data),setTimeout(()=>{g(""),r()},1e3)}catch(v){m(((C=(w=v.response)==null?void 0:w.data)==null?void 0:C.message)||"Failed to update customer.")}finally{p(!1)}};return t?e.jsxs("div",{className:"bg-white p-3 w-full max-w-md overflow-auto relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("button",{onClick:r,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})})}),e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx(G,{onConfirm:D,message:"Are you sure you want to update this customer?",confirmText:"Yes, Update",cancelText:"Cancel",icon:e.jsx(ie,{}),buttonBackgroundColor:"bg-green-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"button",className:"p-2 rounded-full bg-green-200 hover:bg-green-300 text-green-700 shadow",disabled:i,title:"Confirm",children:e.jsx(ie,{size:16})})})}),u&&e.jsxs("div",{className:"bg-red-100 text-red-700 border border-red-400 px-4 py-2 rounded text-center mb-4 mt-12",children:["❌ ",u]}),c&&e.jsxs("div",{className:"bg-green-100 text-green-700 border border-green-400 px-4 py-2 rounded text-center mb-4 mt-12",children:["✅ ",c]}),e.jsx("h2",{className:"text-2xl font-bold mb-4 text-center text-gray-800",children:"Edit Customer"}),e.jsxs("form",{className:"space-y-3",onSubmit:w=>w.preventDefault(),children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 font-medium",children:"Full Name"}),e.jsx("input",{type:"text",name:"name",value:l.name,onChange:j,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"Customer Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 font-medium",children:"NIC Number"}),e.jsx("input",{type:"text",name:"nic",value:l.nic,onChange:j,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"NIC Number"}),x&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:x})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 font-medium",children:"Phone Number"}),e.jsx("input",{type:"text",name:"phone_number",value:l.phone_number,onChange:j,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"07XXXXXXXX"}),h&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:h})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 font-medium",children:"Email Address"}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:j,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"Email"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 font-medium mb-1",children:"NIC Photo (Front)"}),l.nic_photo_front&&e.jsx("img",{src:l.nic_photo_front,className:"w-full h-32 object-cover rounded-lg border mb-2",alt:"NIC Front"}),e.jsx("input",{type:"file",accept:"image/*",onChange:w=>S(w,"nic_photo_front"),className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 font-medium mb-1",children:"NIC Photo (Back)"}),l.nic_photo_back&&e.jsx("img",{src:l.nic_photo_back,className:"w-full h-32 object-cover rounded-lg border mb-2",alt:"NIC Back"}),e.jsx("input",{type:"file",accept:"image/*",onChange:w=>S(w,"nic_photo_back"),className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]})]}):null}function gs({customer:t,onClose:r,onDelete:s,onUpdated:l}){var S,D;const[n,i]=a.useState(!1),[p,u]=a.useState({...t}),[m,c]=a.useState(!1),[g,x]=a.useState(null),[k,h]=a.useState(!1),[A,o]=a.useState(""),b=q();if(a.useEffect(()=>{u({...t}),i(!1),x(null),o("")},[t]),!t)return null;const j=async()=>{var w,C;c(!0),x(null);try{await z.delete(`/api/customers/${t.customer_id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),s(t.customer_id)}catch(v){console.error(v),x(((C=(w=v.response)==null?void 0:w.data)==null?void 0:C.message)||"Failed to delete customer.")}finally{c(!1)}};return e.jsx("div",{className:"flex justify-center items-center w-100 min-h-screen bg-gray-100",children:e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl w-full max-w-md overflow-auto h-full relative",children:[g&&e.jsxs("div",{className:"bg-red-100 text-red-800 border border-red-300 px-4 py-2 rounded text-center mb-4",children:["❌ ",g]}),A&&e.jsxs("div",{className:"bg-green-100 text-green-800 border border-green-300 px-4 py-2 rounded text-center mb-4",children:["✅ ",A]}),!n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"absolute top-3 left-3 z-10 flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})}),!n&&e.jsx("button",{onClick:()=>i(!0),className:"p-2 rounded-full bg-blue-200 hover:bg-blue-300 text-blue-700 shadow",title:"Edit Customer",children:e.jsx(xe,{size:16})})]}),e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx(G,{onConfirm:j,message:"Are you sure you want to delete this customer?",confirmText:"Yes, Delete",cancelText:"Cancel",icon:e.jsx(ne,{}),buttonBackgroundColor:"bg-red-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"button",className:"p-2 rounded-full bg-red-200 hover:bg-red-300 text-red-700 shadow",title:"Delete Customer",disabled:m,children:e.jsx(ne,{size:16})})})}),e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Customer Profile"}),e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-28 h-28 rounded-full bg-gray-100 shadow  flex items-center justify-center overflow-hidden cursor-pointer",onClick:()=>b(`/customer-profile/${t.customer_id}`),children:t.avatar?e.jsx("img",{src:t.avatar,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-3xl font-bold text-gray-700",children:((D=(S=t.name)==null?void 0:S.charAt(0))==null?void 0:D.toUpperCase())||"U"})}),e.jsx("h3",{className:"text-xl font-semibold text-black mt-3 cursor-pointer",onClick:()=>b(`/customer-profile/${t.customer_id}`),children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Customer ID: #",t.customer_id]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 shadow-inner",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",e.jsx("br",{})," ",t.email||"-"]}),e.jsx("br",{}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",e.jsx("br",{})," ",t.phone_number||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"NIC:"})," ",e.jsx("br",{})," ",t.nic||"-"]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 shadow-inner",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"NIC Images"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[t.nic_photo_front&&e.jsx("img",{src:t.nic_photo_front,className:"w-full h-32 object-cover rounded-lg shadow border",alt:"NIC Front"}),t.nic_photo_back&&e.jsx("img",{src:t.nic_photo_back,className:"w-full h-32 object-cover rounded-lg shadow border",alt:"NIC Back"})]})]})]}),n&&e.jsx(Te,{customer:t,onCancel:()=>i(!1),onSuccess:w=>{l(w),i(!1)}})]})})}function fs(){const{name:t,role:r}=V(),[s,l]=a.useState([]),[n,i]=a.useState(!0),[p,u]=a.useState(null),[m,c]=a.useState(null),[g,x]=a.useState(!1),[k,h]=a.useState(""),[A,o]=a.useState(!1),[b,j]=a.useState(!1),[S,D]=a.useState("");a.useEffect(()=>{(async()=>{var d,_;try{i(!0);const y=await z.get("/api/customers",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),P=Array.isArray(y.data.data)?y.data.data:[];l(P)}catch(y){console.error(y),c(((_=(d=y.response)==null?void 0:d.data)==null?void 0:_.message)||"Failed to fetch customers")}finally{i(!1)}})()},[]);const w={total:s.length,active:s.filter(T=>T.status==="active").length,pro:s.filter(T=>T.subscription==="pro").length,newThisMonth:s.filter(T=>{if(!T.created_at)return!1;const d=new Date(T.created_at),_=new Date;return d.getMonth()===_.getMonth()&&d.getFullYear()===_.getFullYear()}).length},C=s.filter(T=>{var _,y,P,$;const d=k.toLowerCase();return((_=T.name)==null?void 0:_.toLowerCase().includes(d))||((y=T.nic)==null?void 0:y.toLowerCase().includes(d))||((P=T.phone_number)==null?void 0:P.toLowerCase().includes(d))||(($=T.email)==null?void 0:$.toLowerCase().includes(d))}),v=T=>{u(T),x(!1),j(!1)},E=()=>u(null),N=T=>{l(d=>d.filter(_=>_.customer_id!==T)),u(null)},f=T=>{l(d=>d.map(_=>_.customer_id===T.customer_id?T:_)),u(T),j(!1),D("Customer updated successfully!"),setTimeout(()=>D(""),3e3)};return e.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-gray-50",children:[e.jsx(re,{}),e.jsx("main",{className:"flex-1 overflow-auto p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Customer Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage customers and related information"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:t})," — ",r]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-1 mt-6 items-stretch",children:[e.jsx("div",{className:"lg:col-span-3 h-full",children:e.jsx("div",{className:"h-full",children:e.jsx(cs,{stats:w})})}),e.jsx("div",{className:"lg:col-span-1 h-full",children:e.jsx("div",{className:"h-full flex flex-col",children:e.jsx(ms,{onAddCustomerClick:()=>{x(!0),o(!1),u(!1)}})})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(ps,{onSearch:T=>h(T)})}),e.jsx("div",{className:"mt-8",children:e.jsx(us,{customers:C,loading:n,error:m,onSelectCustomer:v})})]})}),g&&e.jsx(hs,{onCancel:()=>x(!1),onSuccess:T=>{l([...s,T]),x(!1)}}),b&&p&&e.jsx(Te,{customer:p,onCancel:()=>j(!1),onSuccess:f}),p&&!b&&e.jsx(gs,{customer:p,onClose:E,onDelete:N,onUpdated:f}),S&&e.jsx("div",{className:"fixed top-5 right-5 bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded shadow-lg z-50",children:S})]})}function bs({stats:t}){return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:e.jsx(js,{title:"Total Drivers",value:t.total,gradient:"from-indigo-600 to-violet-600"})})}function js({title:t,value:r,gradient:s}){return e.jsxs("div",{className:`p-5 rounded-xl shadow-md text-white bg-gradient-to-r ${s}`,children:[e.jsx("div",{className:"text-md font-semibold opacity-90",children:t}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:r??0})]})}function vs({onAddDriverClick:t}){return q(),e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow flex flex-col justify-between h-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-50",children:e.jsx(oe,{onClick:t,className:"text-blue-600"})}),e.jsx("div",{className:"font-semibold",children:"Add New Driver"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Register a new Driver to the system."})]})})}function ys({drivers:t=[],loading:r,error:s,onSelectDriver:l}){return e.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:r?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading drivers..."}):s?e.jsx("div",{className:"text-center py-12 text-red-500",children:s}):t.length===0?e.jsx("div",{className:"text-center py-12 text-gray-600",children:"No drivers found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"max-h-[420px] overflow-y-auto",children:e.jsxs("table",{className:"min-w-full table-fixed",children:[e.jsx("thead",{className:"bg-white border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4 text-left text-sm text-gray-600 w-1/4 z-20 bg-white",children:"Driver"}),e.jsx("th",{className:"py-3 px-4 text-left text-sm text-gray-600 w-1/6 z-20 bg-white",children:"Phone Number"}),e.jsx("th",{className:"py-3 px-4 text-left text-sm text-gray-600 w-1/6 z-20 bg-white",children:"Driver Charges"}),e.jsx("th",{className:"py-3 px-4 text-left text-sm text-gray-600 w-1/8  z-20 bg-white",children:"NIC"}),e.jsx("th",{className:"py-3 px-4 text-left text-sm text-gray-600 w-1/12  z-20 bg-white",children:"Age"}),e.jsx("th",{className:"py-3 px-4 text-left text-sm text-gray-600 w-1/6  z-20 bg-white",children:"License No"}),e.jsx("th",{className:"py-3 px-4 text-left text-sm text-gray-600 w-1/6  z-20 bg-white",children:"License Expiry"})]})}),e.jsx("tbody",{children:t.map(n=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition",onClick:()=>l&&l(n),children:[e.jsx("td",{className:"py-4 px-4 align-top",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ns,{name:n.name,src:n.avatar_url||n.image}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:["ID: ",n.driver_id]})]})]})}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.phone_number||"-"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.driver_charges??"-"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.nic||"-"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.age??"-"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.license_number||"-"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.license_expiry_date?new Date(n.license_expiry_date).toISOString().split("T")[0]:"N/A"})]},n.driver_id))})]})})})})}function Ns({name:t,src:r}){if(r)return e.jsx("img",{src:r,alt:t,className:"w-10 h-10 rounded-full object-cover"});const s=(t||"U").split(" ").map(l=>l[0]).slice(0,2).join("").toUpperCase();return e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-semibold text-gray-700",children:s})}const ws=({onCancel:t,onSuccess:r})=>{const s=q(),[l,n]=a.useState({name:"",phone_number:"",driver_charges:"",nic:"",age:"",license_number:"",license_expiry_date:"",image:""}),[i,p]=a.useState(!1),[u,m]=a.useState(null),[c,g]=a.useState(""),[x,k]=a.useState(""),[h,A]=a.useState(""),[o,b]=a.useState(!1),{name:j,role:S}=V();a.useEffect(()=>{if(u){const d=setTimeout(()=>m(null),3e3);return()=>clearTimeout(d)}},[u]);const D=d=>{const _=/^[0-9]{9}[vVxX]$/,y=/^[0-9]{12}$/;return _.test(d)||y.test(d)},w=d=>/^0[0-9]{9}$/.test(d),C=d=>d>=18&&d<=80,v=d=>{const{name:_,value:y}=d.target;if(_==="nic"){n({...l,[_]:y}),y===""||D(y)?g(""):g("Invalid NIC format");return}if(_==="phone_number"){n({...l,[_]:y}),y===""||w(y)?k(""):k("Invalid phone number format");return}if(_==="age"){n({...l,[_]:y}),y===""||C(y)?A(""):A("Driver must be 18 years or older");return}n({...l,[_]:y})},E=d=>{const _=d.target.files[0];if(!_)return;const y=new FileReader;y.onloadend=()=>{n(P=>({...P,image:y.result.split(",")[1]}))},y.readAsDataURL(_)},N=async d=>{var y,P;if(d.preventDefault(),!o)return;if(c||x||h){m("Please fix validation errors before submitting.");return}if(!D(l.nic)){m("Invalid NIC format.");return}if(!w(l.phone_number)){m("Invalid phone number format.");return}if(!C(l.age)){m("Driver must be at least 18 years old.");return}p(!0),m(null);const _=localStorage.getItem("token");if(!_){m("Unauthorized! Please log in first."),s("/login");return}try{const $={...l,driver_charges:parseFloat(l.driver_charges),age:parseInt(l.age),image:l.image?`data:image/png;base64,${l.image}`:null},U=await Z.post("https://rashen.sceniccottage.com/api/drivers",$,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`}});r(U.data.data),n({name:"",phone_number:"",driver_charges:"",nic:"",age:"",license_number:"",license_expiry_date:"",image:""})}catch($){m(((P=(y=$.response)==null?void 0:y.data)==null?void 0:P.message)||"Network error")}finally{p(!1),b(!1)}},f=()=>{b(!0),N(new Event("submit"))},T=()=>{b(!1)};return e.jsx("div",{className:"flex justify-center items-center w-100 min-h-screen bg-gray-100",children:e.jsxs("div",{className:"bg-white p-15 rounded-lg shadow-lg w-full h-full max-w-md relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("button",{onClick:t,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})})}),e.jsx("h2",{className:"text-xl font-semibold mb-6 text-center",children:"Add New Driver"}),u&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 text-center",children:["❌ ",u]}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Driver Name",value:l.name,onChange:v,className:"w-full p-2 border rounded-lg border-gray-300",required:!0}),e.jsx("input",{type:"text",name:"phone_number",placeholder:"Phone Number (e.g., 0712345678)",value:l.phone_number,onChange:v,className:`w-full p-2 border rounded-lg ${x?"border-red-500":"border-gray-300"}`,required:!0}),x&&e.jsx("p",{className:"text-red-500 text-sm",children:x}),e.jsx("input",{type:"number",name:"driver_charges",placeholder:"Driver Charges (LKR)",value:l.driver_charges,onChange:v,className:"w-full p-2 border rounded-lg border-gray-300",required:!0}),e.jsx("input",{type:"text",name:"nic",placeholder:"NIC Number",value:l.nic,onChange:v,className:`w-full p-2 border rounded-lg ${c?"border-red-500":"border-gray-300"}`,required:!0}),c&&e.jsx("p",{className:"text-red-500 text-sm",children:c}),e.jsx("input",{type:"number",name:"age",placeholder:"Age",value:l.age,onChange:v,className:`w-full p-2 border rounded-lg ${h?"border-red-500":"border-gray-300"}`,required:!0}),h&&e.jsx("p",{className:"text-red-500 text-sm",children:h}),e.jsx("input",{type:"text",name:"license_number",placeholder:"License Number",value:l.license_number,onChange:v,className:"w-full p-2 border rounded-lg border-gray-300",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"License Expiry Date"}),e.jsx("input",{type:"date",name:"license_expiry_date",value:l.license_expiry_date,onChange:v,className:"w-full p-2 border rounded-lg border-gray-300",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Driver Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:E,className:"w-full border p-2 rounded-lg",required:!0})]}),e.jsx(G,{onConfirm:f,onCancel:T,message:"Confirm Adding Driver",confirmText:"Yes, Add Driver",cancelText:"No, Go Back",icon:e.jsx(je,{}),buttonBackgroundColor:"bg-blue-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"submit",className:"mt-4 w-full py-2 rounded-lg bg-gradient-to-r from-indigo-600 to-violet-600 text-white hover:bg-blue-600",disabled:i,children:i?"Adding...":"Add Driver"})})]})]})})};function _s({onSearch:t}){const[r,s]=a.useState(""),l=n=>{const i=n.target.value;s(i),t(i)};return e.jsx("div",{className:"w-full mb-4 outline-none",children:e.jsxs("div",{className:"flex items-center bg-white p-3 rounded-lg  shadow flex",children:[e.jsx(ue,{className:"text-gray-400 mr-3 "}),e.jsx("input",{type:"text",placeholder:"Search Driver by name, NIC, phone...",value:r,onChange:l,className:"w-full outline-none text-sm "})]})})}function De({driver:t,onUpdated:r,onCancel:s}){var S;const[l,n]=a.useState({...t}),[i,p]=a.useState(!1),[u,m]=a.useState(null),[c,g]=a.useState(""),[x,k]=a.useState(""),[h,A]=a.useState(""),o=D=>{const{name:w,value:C}=D.target;if(w==="nic"){const v=/^[0-9]{9}[vVxX]$/,E=/^[0-9]{12}$/;k(!v.test(C)&&!E.test(C)?"Invalid NIC format.":"")}w==="phone_number"&&A(/^0\d{9}$/.test(C)?"":"Phone must start with 0 and contain 10 digits."),n({...l,[w]:C})},b=(D,w)=>{const C=D.target.files[0];if(!C)return;const v=new FileReader;v.onloadend=()=>n({...l,[w]:v.result}),v.readAsDataURL(C)},j=async()=>{var D,w,C,v,E;if(x||h){m("Please fix validation errors before saving.");return}p(!0),m(null);try{const N=await z.put(`/api/drivers/${t.driver_id}`,{name:l.name,phone_number:l.phone_number,driver_charges:l.driver_charges,nic:l.nic,age:l.age,license_number:l.license_number,license_expiry_date:l.license_expiry_date,image:l.image},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),f=((D=N.data)==null?void 0:D.data)||((w=N.data)==null?void 0:w.driver)||N.data;r(f),g("Driver updated successfully!"),setTimeout(()=>{g(""),s()},1e3)}catch(N){console.error("Update driver error:",N),console.error("Response data:",(C=N.response)==null?void 0:C.data),m(((E=(v=N.response)==null?void 0:v.data)==null?void 0:E.message)||"Failed to update driver.")}finally{p(!1)}};return e.jsxs("div",{className:"bg-white p-3 h-200 w-full max-w-md overflow-auto relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("button",{onClick:s,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})})}),e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx(G,{onConfirm:j,message:"Are you sure you want to update this driver?",confirmText:"Yes, Update",cancelText:"Cancel",icon:e.jsx(ie,{}),buttonBackgroundColor:"bg-green-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"button",className:"p-2 rounded-full bg-green-200 hover:bg-green-300 text-green-700 shadow",disabled:i,title:"Confirm",children:e.jsx(ie,{size:16})})})}),u&&e.jsxs("div",{className:"bg-red-100 text-red-700 border border-red-400 px-4 py-2 rounded text-center mb-4 mt-12",children:["❌ ",u]}),c&&e.jsxs("div",{className:"bg-green-100 text-green-700 border border-green-400 px-4 py-2 rounded text-center mb-4 mt-12",children:["✅ ",c]}),e.jsx("h2",{className:"text-2xl font-bold mb-4 text-center text-gray-800",children:"Edit Driver"}),e.jsxs("form",{className:"space-y-1",onSubmit:D=>D.preventDefault(),children:[e.jsx("label",{className:"block text-gray-600 font-medium",children:"Driver Name:"}),e.jsx("input",{type:"text",name:"name",value:l.name,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"Driver Name"}),e.jsx("label",{className:"block text-gray-600 font-medium",children:"Phone Number:"}),e.jsx("input",{type:"text",name:"phone_number",value:l.phone_number,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"Phone Number"}),h&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:h}),e.jsx("label",{className:"block text-gray-600 font-medium",children:"Driver Charges:"}),e.jsx("input",{type:"number",name:"driver_charges",value:l.driver_charges,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"Driver Charges"}),e.jsx("label",{className:"block text-gray-600 font-medium",children:"Driver NIC:"}),e.jsx("input",{type:"text",name:"nic",value:l.nic,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"NIC"}),x&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:x}),e.jsx("label",{className:"block text-gray-600 font-medium",children:"Driver Age:"}),e.jsx("input",{type:"number",name:"age",value:l.age,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"Age"}),e.jsx("label",{className:"block text-gray-600 font-medium",children:"License Number:"}),e.jsx("input",{type:"text",name:"license_number",value:l.license_number,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"License Number"}),e.jsx("label",{className:"block text-gray-600 font-medium",children:"License Expiry Date:"}),e.jsx("input",{type:"date",name:"license_expiry_date",value:(S=l.license_expiry_date)==null?void 0:S.split("T")[0],onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 font-medium mb-1",children:"Driver Photo:"}),l.image&&e.jsx("img",{src:l.image,alt:"Driver",className:"w-full h-32 object-cover rounded-lg border mb-2"}),e.jsx("input",{type:"file",accept:"image/*",onChange:D=>b(D,"image"),className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]})}function Cs({driver:t,onClose:r,onDelete:s,onUpdated:l}){var S,D;const[n,i]=a.useState(!1),[p,u]=a.useState({...t}),[m,c]=a.useState(!1),[g,x]=a.useState(null),[k,h]=a.useState(!1),[A,o]=a.useState(""),b=q();if(a.useEffect(()=>{u({...t}),i(!1),x(null),o("")},[t]),!t)return null;const j=async()=>{var w,C;c(!0),x(null);try{await z.delete(`/api/drivers/${t.driver_id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),s(t.driver_id),o("Driver deleted successfully!"),setTimeout(()=>o(""),2e3)}catch(v){console.error(v),x(((C=(w=v.response)==null?void 0:w.data)==null?void 0:C.message)||"Failed to delete driver.")}finally{c(!1)}};return e.jsx("div",{className:"flex justify-center items-center w-100 h-full bg-gray-100",children:e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl w-full max-w-md overflow-auto h-full relative",children:[g&&e.jsxs("div",{className:"bg-red-100 text-red-800 border border-red-300 px-4 py-2 rounded text-center mb-4",children:["❌ ",g]}),A&&e.jsxs("div",{className:"bg-green-100 text-green-800 border border-green-300 px-4 py-2 rounded text-center mb-4",children:["✅ ",A]}),!n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"absolute top-3 left-3 z-10 flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})}),e.jsx("button",{onClick:()=>i(!0),className:"p-2 rounded-full bg-blue-200 hover:bg-blue-300 text-blue-700 shadow",title:"Edit Driver",children:e.jsx(xe,{size:16})})]}),e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx(G,{onConfirm:j,message:"Are you sure you want to delete this driver?",confirmText:"Yes, Delete",cancelText:"Cancel",icon:e.jsx(ne,{}),buttonBackgroundColor:"bg-red-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"button",className:"p-2 rounded-full bg-red-200 hover:bg-red-300 text-red-700 shadow",title:"Delete Driver",disabled:m,children:e.jsx(ne,{size:16})})})}),e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Driver Profile"}),e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-28 h-28 rounded-full bg-gray-200 shadow border flex items-center justify-center overflow-hidden underline",onClick:()=>b(`/driver-profile/${t.driver_id}`),children:t.image?e.jsx("img",{src:t.image,alt:"Driver",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-3xl font-bold text-gray-700",children:((D=(S=t.name)==null?void 0:S.charAt(0))==null?void 0:D.toUpperCase())||"D"})}),e.jsx("h3",{className:"text-xl font-semibold text-black mt-3 cursor-pointer ",onClick:()=>b(`/driver-profile/${t.driver_id}`),children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Driver ID: #",t.driver_id]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 shadow-inner",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",e.jsx("br",{})," ",t.phone_number||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Driver Charges:"})," ",e.jsx("br",{})," ",t.driver_charges||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"NIC:"})," ",e.jsx("br",{})," ",t.nic||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Age:"})," ",e.jsx("br",{})," ",t.age||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"License Number:"})," ",e.jsx("br",{})," ",t.license_number||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"License Expiry:"})," ",e.jsx("br",{})," ",t.license_expiry_date?new Date(t.license_expiry_date).toISOString().split("T")[0]:"-"]})]})]})]}),n&&e.jsx(De,{driver:t,onCancel:()=>i(!1),onUpdated:w=>{l(w),i(!1)}})]})})}function Ss(){const{name:t,role:r}=V(),[s,l]=a.useState([]),[n,i]=a.useState(!0),[p,u]=a.useState(null),[m,c]=a.useState(null),[g,x]=a.useState(!1),[k,h]=a.useState(!1),[A,o]=a.useState(!1),[b,j]=a.useState(""),[S,D]=a.useState("");a.useEffect(()=>{(async()=>{var _,y;try{i(!0);const P=await z.get("/api/drivers",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),$=Array.isArray(P.data.data)?P.data.data:[];l($)}catch(P){console.error(P),u(((y=(_=P.response)==null?void 0:_.data)==null?void 0:y.message)||"Failed to fetch drivers")}finally{i(!1)}})()},[]);const w={total:s.length,active:s.filter(d=>d.status==="active").length,inactive:s.filter(d=>d.status==="inactive").length,assigned:s.filter(d=>d.assigned_vehicle).length},C=s.filter(d=>{var y,P,$;const _=b.toLowerCase();return((y=d.name)==null?void 0:y.toLowerCase().includes(_))||((P=d.nic)==null?void 0:P.toLowerCase().includes(_))||(($=d.phone_number)==null?void 0:$.toLowerCase().includes(_))}),v=d=>{c(d),x(!1),h(!1),o(!0)},E=()=>{h(!0)},N=()=>{c(null),o(!1)},f=d=>{l(_=>_.filter(y=>y.driver_id!==d)),c(null),o(!1)},T=d=>{l(_=>_.map(y=>y.driver_id===d.driver_id?d:y)),c(d),h(!1),D("Driver updated successfully!"),setTimeout(()=>D(""),3e3)};return e.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-gray-50",children:[e.jsx(re,{}),e.jsx("main",{className:"flex-1 overflow-auto p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Driver Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage drivers and all driver-related data"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:t})," — ",r]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-1 mt-6 items-stretch",children:[e.jsx("div",{className:"lg:col-span-3 h-full",children:e.jsx(bs,{stats:w})}),e.jsx("div",{className:"lg:col-span-1 h-full",children:e.jsx(vs,{onAddDriverClick:()=>{x(!0),o(!1),c(null)}})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(_s,{onSearch:d=>j(d)})}),e.jsx("div",{className:"mt-8",children:e.jsx(ys,{drivers:C,loading:n,error:p,onSelectDriver:v})})]})}),g&&e.jsx(ws,{onCancel:()=>x(!1),onSuccess:d=>{l([...s,d]),x(!1)}}),k&&m&&e.jsx(De,{driver:m,onCancel:()=>h(!1),onUpdated:T}),m&&A&&!k&&e.jsx(Cs,{driver:m,onClose:N,onDelete:f,onUpdated:T,onEdit:E}),S&&e.jsx("div",{className:"fixed top-5 right-5 bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded shadow-lg z-50",children:S})]})}function ks({stats:t}){return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:e.jsx(As,{title:"Total Vehicle Owners",value:t.total,gradient:"from-indigo-600 to-violet-600"})})}function As({title:t,value:r,gradient:s}){return e.jsxs("div",{className:`p-5 rounded-xl shadow-md text-white bg-gradient-to-r ${s}`,children:[e.jsx("div",{className:"text-md font-semibold opacity-90",children:t}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:r??0})]})}function Ts({onAddOwnerClick:t}){return q(),e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow flex flex-col justify-between h-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-50",children:e.jsx(oe,{onClick:t,className:"text-blue-600"})}),e.jsx("div",{className:"font-semibold",children:"Add New Vehicle Owner"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Register a new Vehicle Owner to the system."})]})})}function Ds({owners:t=[],loading:r,error:s,onSelectOwner:l}){return e.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:r?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading owners..."}):s?e.jsx("div",{className:"text-center py-12 text-red-500",children:s}):t.length===0?e.jsx("div",{className:"text-center py-12 text-gray-600",children:"No Vehicle owners found."}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("table",{className:"min-w-full table-auto",children:e.jsx("thead",{className:"text-left text-sm text-gray-600 border-b bg-white sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4",children:"Vehicle Owner"}),e.jsx("th",{className:"py-3 px-4",children:"Phone Number"})]})})}),e.jsx("div",{className:"max-h-[420px] overflow-y-auto",children:e.jsx("table",{className:"min-w-full table-auto",children:e.jsx("tbody",{children:t.map(n=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition",onClick:()=>l(n),children:[e.jsxs("td",{className:"py-4 px-4 flex items-center gap-3",children:[e.jsx(Es,{name:n.owner_name,src:n.avatar_url}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n.owner_name}),e.jsx("div",{className:"text-xs text-gray-400",children:n.owner_id})]})]}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600",children:n.contact_number})]},n.owner_id))})})})]})})}function Es({name:t,src:r}){if(r)return e.jsx("img",{src:r,alt:t,className:"w-10 h-10 rounded-full object-cover"});const s=(t||"U").split(" ").map(l=>l[0]).slice(0,2).join("").toUpperCase();return e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-semibold text-gray-700",children:s})}const Ps=({onCancel:t,onSuccess:r})=>{const s=q(),[l,n]=a.useState({owner_name:"",contact_number:""}),[i,p]=a.useState(!1),[u,m]=a.useState(null),[c,g]=a.useState(!1),[x,k]=a.useState(!1),[h,A]=a.useState(""),{name:o,role:b}=V();a.useEffect(()=>{if(u){const C=setTimeout(()=>m(null),3e3);return()=>clearTimeout(C)}},[u]);const j=C=>{const{name:v,value:E}=C.target;v==="contact_number"&&(/^0\d{9}$/.test(E)?A(""):A("Phone must start with 0 and contain exactly 10 digits.")),n({...l,[v]:E})},S=async C=>{if(C.preventDefault(),!x)return;p(!0),m(null);const v=localStorage.getItem("token");if(!v){m("Unauthorized! Please log in first."),s("/login");return}try{const E=await Z.post("https://rashen.sceniccottage.com/api/owners",l,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`}});(E.status===200||E.status===201)&&(g(!0),r(E.data.data),n({owner_name:"",contact_number:""}))}catch(E){console.error("Error adding owner:",E),E.response?m(E.response.data.message||`Error: ${E.response.status} ${E.response.statusText}`):m("Network error. Please try again.")}finally{p(!1),k(!1)}},D=()=>{k(!0),S(new Event("submit"))},w=()=>{k(!1)};return e.jsx("div",{className:"flex justify-center items-center w-100 min-h-screen bg-white-100",children:e.jsxs("div",{className:"bg-white p-15 rounded-lg shadow-lg w-full h-full max-w-md relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("button",{onClick:t,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})})}),e.jsx("h2",{className:"text-xl font-semibold mb-6 text-center",children:"Add New Vehicle Owner"}),u&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4 text-center",children:["❌ ",u]}),c&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4 text-center",children:"✅ Vehicle owner added successfully!"}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsx("input",{type:"text",name:"owner_name",placeholder:"Owner Name",value:l.owner_name,onChange:j,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0}),e.jsx("input",{type:"text",name:"contact_number",placeholder:"Contact Number (e.g., 0771234567)",value:l.contact_number,onChange:j,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0}),h&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:h}),e.jsx(G,{onConfirm:D,onCancel:w,message:"Confirm Adding Vehicle Owner",additionalInfo:"Please verify the details before submission.",confirmText:"Yes, Add Owner",cancelText:"No, Go Back",icon:e.jsx(je,{}),buttonBackgroundColor:"bg-blue-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"submit",className:" mt-5 w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition duration-300",disabled:i,children:i?"Adding...":"Add Owner"})})]})]})})};function $s({onSearch:t}){const[r,s]=a.useState(""),l=n=>{const i=n.target.value;s(i),t(i)};return e.jsx("div",{className:"w-full mb-4 outline-none",children:e.jsxs("div",{className:"flex items-center bg-white p-3 rounded-lg  shadow flex",children:[e.jsx(ue,{className:"text-gray-400 mr-3 "}),e.jsx("input",{type:"text",placeholder:"Search Owmer by name, phone...",value:r,onChange:l,className:"w-full outline-none text-sm "})]})})}function ot({owner:t,onUpdated:r,onCancel:s}){const[l,n]=a.useState({...t}),[i,p]=a.useState(!1),[u,m]=a.useState(null),[c,g]=a.useState(""),[x,k]=a.useState(""),h=o=>{const{name:b,value:j}=o.target;b==="contact_number"&&k(/^0\d{9}$/.test(j)?"":"Phone must start with 0 and contain 10 digits."),n({...l,[b]:j})},A=async()=>{var o,b;if(x){m("Please fix validation errors before saving.");return}p(!0),m(null);try{const j={owner_name:l.owner_name,contact_number:l.contact_number},S=await z.put(`/api/owners/${t.owner_id}`,j,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});r(S.data.data),g("Owner updated successfully!"),setTimeout(()=>{g(""),s()},800)}catch(j){m(((b=(o=j.response)==null?void 0:o.data)==null?void 0:b.message)||"Failed to update owner.")}finally{p(!1)}};return e.jsxs("div",{className:"bg-white p-2 w-full max-w-md overflow-auto relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("button",{onClick:s,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})})}),e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx(G,{onConfirm:A,message:"Are you sure you want to update this owner?",confirmText:"Yes, Update",cancelText:"Cancel",icon:e.jsx(ie,{}),buttonBackgroundColor:"bg-green-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"button",className:"p-2 rounded-full bg-green-200 hover:bg-green-300 text-green-700 shadow",disabled:i,title:"Confirm",children:e.jsx(ie,{size:16})})})}),u&&e.jsxs("div",{className:"bg-red-100 text-red-700 border border-red-400 px-4 py-2 rounded text-center mb-4 mt-12",children:["❌ ",u]}),c&&e.jsxs("div",{className:"bg-green-100 text-green-700 border border-green-400 px-4 py-2 rounded text-center mb-4 mt-12",children:["✅ ",c]}),e.jsx("h2",{className:"text-2xl font-bold mb-4 text-center text-gray-800",children:"Edit Owner"}),e.jsxs("form",{className:"space-y-3",onSubmit:o=>o.preventDefault(),children:[e.jsx("label",{className:"block text-gray-600 font-medium",children:"Owner Name:"}),e.jsx("input",{type:"text",name:"owner_name",value:l.owner_name,onChange:h,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"Owner Name"}),e.jsx("label",{className:"block text-gray-600 font-medium",children:"Contact Number:"}),e.jsx("input",{type:"text",name:"contact_number",value:l.contact_number,onChange:h,className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"07XXXXXXXX"}),x&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:x})]})]})}function Ms({owner:t,onClose:r,onDelete:s,onUpdated:l}){const[n,i]=a.useState(!1),[p,u]=a.useState(null),[m,c]=a.useState("");if(!t)return null;const g=async()=>{var x,k;try{await z.delete(`/api/owners/${t.owner_id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),s(t.owner_id),c("Owner deleted successfully!"),setTimeout(()=>c(""),1500)}catch(h){u(((k=(x=h.response)==null?void 0:x.data)==null?void 0:k.message)||"Failed to delete owner.")}};return e.jsx("div",{className:"flex justify-center items-center w-100 min-h-screen bg-gray-100",children:e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl w-100 overflow-auto h-full relative",children:[p&&e.jsxs("div",{className:"bg-red-100 text-red-800 border border-red-300 px-4 py-2 rounded text-center mb-4",children:["❌ ",p]}),m&&e.jsxs("div",{className:"bg-green-100 text-green-800 border border-green-300 px-4 py-2 rounded text-center mb-4",children:["✅ ",m]}),!n&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:r,className:"absolute top-3 left-3 p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})}),e.jsx("button",{onClick:()=>i(!0),className:"absolute top-3 left-14 p-2 rounded-full bg-blue-200 hover:bg-blue-300 text-blue-700 shadow",title:"Edit Owner",children:e.jsx(xe,{size:16})}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(G,{onConfirm:g,message:"Are you sure you want to delete this Owner?",confirmText:"Yes, Delete",cancelText:"Cancel",children:e.jsx("button",{className:"p-2 rounded-full bg-red-200 hover:bg-red-300 text-red-700 shadow",children:e.jsx(ne,{size:16})})})})]}),!n&&e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800 mt-5",children:"Owner Profile"}),!n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-28 h-28 rounded-full bg-gray-100 shadow flex items-center justify-center overflow-hidden",children:e.jsx(Ze,{className:"text-4xl text-gray-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-black mt-3",children:t.owner_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Owner ID: #",t.owner_id]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 shadow-inner",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Details"}),e.jsx("div",{className:"grid grid-cols-2 gap-y-3 text-sm",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"}),e.jsx("br",{})," ",t.contact_number]})})]}),t.nic_photo_front||t.nic_photo_back?e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 shadow-inner",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"NIC Images"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[t.nic_photo_front&&e.jsx("img",{src:t.nic_photo_front,className:"w-full h-32 object-cover rounded-lg shadow border",alt:"NIC Front"}),t.nic_photo_back&&e.jsx("img",{src:t.nic_photo_back,className:"w-full h-32 object-cover rounded-lg shadow border",alt:"NIC Back"})]})]}):null]}),n&&e.jsx(ot,{owner:t,onCancel:()=>i(!1),onUpdated:x=>{l(x),i(!1)}})]})})}function Is(){const{name:t,role:r}=V(),[s,l]=a.useState([]),[n,i]=a.useState(!0),[p,u]=a.useState(null),[m,c]=a.useState(!1),[g,x]=a.useState(null),[k,h]=a.useState(!1),[A,o]=a.useState(""),[b,j]=a.useState(!1),[S,D]=a.useState("");a.useEffect(()=>{(async()=>{var _,y;try{i(!0);const P=await z.get("/api/owners",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),$=Array.isArray(P.data.data)?P.data.data:[];l($)}catch(P){console.error(P),x(((y=(_=P.response)==null?void 0:_.data)==null?void 0:y.message)||"Failed to fetch owners")}finally{i(!1)}})()},[]);const w={total:s.length,newThisMonth:s.filter(d=>{if(!d.created_at)return!1;const _=new Date(d.created_at),y=new Date;return _.getMonth()===y.getMonth()&&_.getFullYear()===y.getFullYear()}).length},C=s.filter(d=>{var y,P;const _=A.toLowerCase();return((y=d.owner_name)==null?void 0:y.toLowerCase().includes(_))||((P=d.contact_number)==null?void 0:P.toLowerCase().includes(_))}),v=d=>{u(d),h(!1),j(!1),c(!0)},E=()=>{j(!0)},N=()=>{u(null),c(!1)},f=d=>{l(_=>_.filter(y=>y.owner_id!==d)),u(null),c(!1)},T=d=>{l(_=>_.map(y=>y.owner_id===d.owner_id?d:y)),u(d),j(!1),D("Owner updated successfully!"),setTimeout(()=>D(""),3e3)};return e.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-gray-50",children:[e.jsx(re,{}),e.jsx("main",{className:"flex-1 overflow-auto p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Vehicle Owner Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage vehicle owners and their contact info"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:t})," — ",r]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-1 mt-6 items-stretch",children:[e.jsx("div",{className:"lg:col-span-3 h-full",children:e.jsx(ks,{stats:w})}),e.jsx("div",{className:"lg:col-span-1 h-full flex flex-col",children:e.jsx(Ts,{onAddOwnerClick:()=>{h(!0),c(!1),u(!1)}})})]}),e.jsx("div",{className:"mt-6",children:e.jsx($s,{onSearch:d=>o(d)})}),e.jsx("div",{className:"mt-8",children:e.jsx(Ds,{owners:C,loading:n,error:g,onSelectOwner:v})})]})}),k&&e.jsx(Ps,{onCancel:()=>h(!1),onSuccess:d=>{l([...s,d]),h(!1)}}),b&&p&&e.jsx(ot,{owner:p,onCancel:()=>j(!1),onSuccess:T}),p&&!b&&m&&e.jsx(Ms,{owner:p,onClose:N,onDelete:f,onUpdated:T,onEdit:E}),S&&e.jsx("div",{className:"fixed top-5 right-5 bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded shadow-lg z-50",children:S})]})}function Ls({stats:t}){return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:e.jsx(Fs,{title:"Total Vehicles",value:t.total})})}function Fs({title:t,value:r}){return e.jsxs("div",{className:"p-5 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-600 to-violet-600",children:[e.jsx("div",{className:"text-md font-semibold opacity-90",children:t}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:r??0})]})}function zs({onAddVehicleClick:t}){return q(),e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow flex flex-col justify-between h-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-50",children:e.jsx(oe,{onClick:t,className:"text-blue-600"})}),e.jsx("div",{className:"font-semibold",children:"Add New Vehicle"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Register a new Vehicle to the system."})]})})}function Rs({vehicles:t=[],loading:r,error:s,onSelectVehicle:l}){return e.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:r?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading vehicles..."}):s?e.jsx("div",{className:"text-center py-12 text-red-500",children:s}):t.length===0?e.jsx("div",{className:"text-center py-12 text-gray-600",children:"No vehicles found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"max-h-[500px] overflow-y-auto rounded",children:e.jsxs("table",{className:"min-w-full table-fixed",children:[e.jsx("thead",{className:"bg-white sticky top-0 z-20 text-sm text-gray-600 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4 text-left w-1/5",children:"Vehicle"}),e.jsx("th",{className:"py-3 px-4 text-left w-1/6",children:"Number Plate"}),e.jsx("th",{className:"py-3 px-4 text-left w-1/6",children:"Type"}),e.jsx("th",{className:"py-3 px-4 text-left w-1/8",children:"AC"}),e.jsx("th",{className:"py-3 px-4 text-left w-1/8",children:"Fuel"}),e.jsx("th",{className:"py-3 px-4 text-left w-1/6",children:"Rent (Rs)"}),e.jsx("th",{className:"py-3 px-4 text-left w-1/6",children:"Availability"}),e.jsx("th",{className:"py-3 px-4 text-left w-1/6",children:"Owner"}),e.jsx("th",{className:"py-3 px-4 text-left w-1/6",children:"Contact"}),e.jsx("th",{className:"py-3 px-4 text-left w-1/4",children:"Mileage Costs"})]})}),e.jsx("tbody",{children:t.filter(Boolean).map(n=>{var i,p,u,m;return e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition",onClick:()=>l&&l(n),children:[e.jsx("td",{className:"py-4 px-4 align-top",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Bs,{name:n.name,src:n.avatar_url}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n.name}),e.jsx("div",{className:"text-xs text-gray-400",children:n.vehicle_id})]})]})}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.vehicle_number||"—"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.type||"—"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.ac_type||"—"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:((i=n.fuel)==null?void 0:i.type)||"—"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:n.rent_cost_daily||"—"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-white text-xs ${n.vehicle_availability==="Yes"?"bg-green-500":"bg-red-500"}`,children:n.vehicle_availability||"—"})}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:((p=n.owner)==null?void 0:p.owner_name)||"—"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:((u=n.owner)==null?void 0:u.contact_number)||"—"}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600 align-top",children:((m=n.mileage_costs)==null?void 0:m.length)>0?e.jsx("ul",{className:"list-disc ml-4",children:n.mileage_costs.map(c=>e.jsxs("li",{children:["Base: ",c.mileage_cost,", Additional: ",c.mileage_cost_additional]},c.mileage_cost_id))}):e.jsx("span",{className:"text-gray-400",children:"No data"})})]},n.vehicle_id)})})]})})})})}function Bs({name:t,src:r}){if(r)return e.jsx("img",{src:r,alt:t,className:"w-10 h-10 rounded-full object-cover"});const s=(t||"V").split(" ").map(l=>l[0]).slice(0,2).join("").toUpperCase();return e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-semibold text-gray-700",children:s})}const Os=({onClose:t,onSuccess:r})=>{const s=q(),{name:l,role:n}=V(),[i,p]=a.useState({vehicle_number:"",name:"",type:"",rent_cost_daily:"",ac_type:"",owner_id:"",fuel_id:"",owner_cost_monthly:"",mileage_cost:"",mileage_cost_additional:"",meter_number:"",last_service_meter_number:"",license_expiry_date:"",insurance_expiry_date:"",eco_test_expiry_date:"",vehicle_fuel_efficiency:"",license_image:"",insurance_card_image:"",eco_test_image:"",book_image:"",image:""}),[u,m]=a.useState([]),[c,g]=a.useState([]),[x,k]=a.useState(!1),[h,A]=a.useState(null),[o,b]=a.useState(!1),[j,S]=a.useState(!1),[D,w]=a.useState({}),C=["Car","Van","Bus","Bike"],v=["AC","Non_AC"];a.useEffect(()=>{(async()=>{var y,P;const _=localStorage.getItem("token");if(!_){A("Unauthorized! Please log in first."),s("/login");return}try{const[$,U]=await Promise.all([Z.get("https://rashen.sceniccottage.com/api/owners",{headers:{Authorization:`Bearer ${_}`}}),Z.get("https://rashen.sceniccottage.com/api/fuels",{headers:{Authorization:`Bearer ${_}`}})]);m(((y=$.data)==null?void 0:y.data)||$.data||[]),g(((P=U.data)==null?void 0:P.data)||U.data||[])}catch{A("Failed to load dropdown data. Please try again.")}})()},[s]);const E=d=>{const{name:_,value:y}=d.target;p(P=>({...P,[_]:y}))},N=d=>{const{name:_,files:y}=d.target,P=y[0];if(P){const $=new FileReader;$.onloadend=()=>{const U=$.result.split(",")[1];p(F=>({...F,[_]:U})),w(F=>({...F,[_]:$.result}))},$.readAsDataURL(P)}},f=async d=>{var _,y;if(d.preventDefault(),!!j){k(!0),A(null);try{const P=localStorage.getItem("token"),$=await Z.post("https://rashen.sceniccottage.com/api/vehicles",i,{headers:{Authorization:`Bearer ${P}`,"Content-Type":"application/json"}});($.status===200||$.status===201)&&(b(!0),r($.data.data),setTimeout(()=>t(),2e3))}catch(P){A(((y=(_=P.response)==null?void 0:_.data)==null?void 0:y.message)||"Failed to add vehicle")}finally{k(!1),S(!1)}}},T=()=>{S(!0)};return e.jsx("div",{className:"fixed inset-0 bg-white/40 bg-opacity-40 backdrop-blur-md flex justify-center items-start overflow-auto z-50 p-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-6xl mt-12 relative p-8",children:[e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("button",{onClick:t,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:18})})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(G,{onConfirm:T,onCancel:()=>S(!1),message:"Confirm Adding Vehicle",additionalInfo:"Please verify all vehicle details before submission.",confirmText:"Yes, Add Vehicle",cancelText:"No, Go Back",icon:e.jsx(Se,{}),buttonBackgroundColor:"bg-green-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"submit",className:"p-2 rounded-full bg-green-200 hover:bg-green-300 text-green-700 shadow",disabled:x,title:"Confirm",children:e.jsx(ie,{size:18})})})}),e.jsx("h2",{className:"text-xl font-semibold mb-6 text-center flex items-center justify-center gap-2",children:"Add New Vehicle"}),h&&e.jsxs("div",{className:"bg-red-100 text-red-700 border border-red-400 px-4 py-3 rounded mb-4 text-center",children:["❌ ",h]}),o&&e.jsx("div",{className:"bg-green-100 text-green-700 border border-green-400 px-4 py-3 rounded mb-4 text-center",children:"✅ Vehicle added successfully!"}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle Number"}),e.jsx("input",{name:"vehicle_number",placeholder:"e.g. ABC-1234",value:i.vehicle_number,onChange:E,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle Name"}),e.jsx("input",{name:"name",placeholder:"e.g. Toyota Aqua",value:i.name,onChange:E,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle Type"}),e.jsxs("select",{name:"type",value:i.type,onChange:E,className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select Type"}),C.map(d=>e.jsx("option",{children:d},d))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Daily Rent Cost (Rs)"}),e.jsx("input",{type:"number",name:"rent_cost_daily",value:i.rent_cost_daily,onChange:E,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"AC Type"}),e.jsxs("select",{name:"ac_type",value:i.ac_type,onChange:E,className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select AC Type"}),v.map(d=>e.jsx("option",{value:d,children:d==="Non_AC"?"Non-AC":"AC"},d))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fuel Type"}),e.jsxs("select",{name:"fuel_id",value:i.fuel_id,onChange:E,className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select Fuel"}),c.map(d=>e.jsxs("option",{value:d.fuel_id,children:[d.type," - Rs.",d.cost]},d.fuel_id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Owner"}),e.jsxs("select",{name:"owner_id",value:i.owner_id,onChange:E,className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select Owner"}),u.map(d=>e.jsxs("option",{value:d.owner_id,children:[d.name||d.owner_name," (",d.nic,")"]},d.owner_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Owner Monthly Cost (Rs)"}),e.jsx("input",{type:"number",name:"owner_cost_monthly",value:i.owner_cost_monthly,onChange:E,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Mileage Cost (Rs/km)"}),e.jsx("input",{type:"number",name:"mileage_cost",value:i.mileage_cost,onChange:E,className:"input",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Additional Mileage Cost (Rs/km)"}),e.jsx("input",{type:"number",name:"mileage_cost_additional",value:i.mileage_cost_additional,onChange:E,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Current Meter Number"}),e.jsx("input",{type:"number",name:"meter_number",value:i.meter_number,onChange:E,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Last Service Meter Number"}),e.jsx("input",{type:"number",name:"last_service_meter_number",value:i.last_service_meter_number,onChange:E,className:"input",required:!0})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fuel Efficiency (km/l)"}),e.jsx("input",{type:"number",step:"0.1",name:"vehicle_fuel_efficiency",value:i.vehicle_fuel_efficiency,onChange:E,className:"input",required:!0})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"License Expiry Date"}),e.jsx("input",{type:"date",name:"license_expiry_date",value:i.license_expiry_date,onChange:E,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Insurance Expiry Date"}),e.jsx("input",{type:"date",name:"insurance_expiry_date",value:i.insurance_expiry_date,onChange:E,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Eco Test Expiry Date"}),e.jsx("input",{type:"date",name:"eco_test_expiry_date",value:i.eco_test_expiry_date,onChange:E,className:"input"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6 mt-6",children:[["license_image","License Image"],["insurance_card_image","Insurance Card"],["eco_test_image","Eco Test Image"],["book_image","Vehicle Book"],["image","Main Vehicle Image"]].map(([d,_])=>e.jsxs("div",{className:"flex flex-col items-center relative",children:[e.jsx("label",{className:"label mb-2 text-sm font-medium text-gray-700",children:_}),e.jsxs("div",{className:"relative w-36 h-36 border-2 border-dashed rounded-xl flex flex-col items-center justify-center bg-gray-50 hover:bg-green-50 transition overflow-hidden",children:[D[d]?e.jsx("img",{src:D[d],alt:_,className:"w-full h-full object-cover rounded-xl"}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"text-gray-400 text-2xl mb-2"}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Upload"})]}),e.jsx("input",{type:"file",accept:"image/*",name:d,onChange:N,className:"absolute inset-0 opacity-0 cursor-pointer z-10"})]})]},d))})]})]})})};function Us({onSearch:t}){const[r,s]=a.useState(""),l=n=>{const i=n.target.value;s(i),t(i)};return e.jsx("div",{className:"w-full mb-4 outline-none",children:e.jsxs("div",{className:"flex items-center bg-white p-3 rounded-lg  shadow flex",children:[e.jsx(ue,{className:"text-gray-400 mr-3 "}),e.jsx("input",{type:"text",placeholder:"Search Vehicle by name, vehicle number...",value:r,onChange:l,className:"w-full outline-none text-sm "})]})})}function Ee({vehicle:t,onCancel:r,onSuccess:s}){const[l,n]=a.useState(t||{}),[i,p]=a.useState([]),[u,m]=a.useState([]),[c,g]=a.useState({}),[x,k]=a.useState({}),[h,A]=a.useState(!0),[o,b]=a.useState(!1),[j,S]=a.useState(null),D=["Car","Van","Bus","Bike"],w=["AC","Non_AC"],C=["license_image","insurance_card_image","eco_test_image","book_image","image"];a.useEffect(()=>{(async()=>{var T,d;try{const _=localStorage.getItem("token"),[y,P]=await Promise.all([z.get("/api/owners",{headers:{Authorization:`Bearer ${_}`}}),z.get("/api/fuels",{headers:{Authorization:`Bearer ${_}`}})]);p(((T=y.data)==null?void 0:T.data)||y.data||[]),m(((d=P.data)==null?void 0:d.data)||P.data||[])}catch{S("Failed to fetch owners or fuels data.")}})(),t&&(n(t),g({license_image:t.license_image,insurance_card_image:t.insurance_card_image,eco_test_image:t.eco_test_image,book_image:t.book_image,image:t.image})),A(!1)},[t]);const v=f=>{const{name:T,value:d}=f.target;n(_=>({..._,[T]:d}))},E=f=>{const{name:T,files:d}=f.target,_=d==null?void 0:d[0];if(!_)return;const y=new FileReader;y.onloadend=()=>{const P=y.result.split(",")[1];k($=>({...$,[T]:!0})),n($=>({...$,[T]:P})),g($=>({...$,[T]:y.result}))},y.readAsDataURL(_)},N=async()=>{var f,T,d;b(!0),S(null);try{const _=localStorage.getItem("token"),y={...l};C.forEach(U=>{x[U]||(y[U]=null)});const P=await z.put(`/api/vehicles/${l.vehicle_id}`,y,{headers:{Authorization:`Bearer ${_}`}}),$=((f=P.data)==null?void 0:f.data)||P.data;s($),r()}catch(_){S(((d=(T=_.response)==null?void 0:T.data)==null?void 0:d.message)||"Failed to update vehicle")}finally{b(!1)}};return h?e.jsx("div",{className:"flex justify-center items-center min-h-[300px] text-gray-500",children:"Loading vehicle data..."}):e.jsx("div",{className:"fixed inset-0 bg-white/40 backdrop-blur-md flex justify-center items-start overflow-auto z-50 p-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-6xl mt-12 relative p-8",children:[e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("button",{onClick:r,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:18})})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(G,{onConfirm:N,message:"Confirm Vehicle Update",additionalInfo:"Please verify all vehicle details before submission.",confirmText:"Yes, Update Vehicle",cancelText:"No, Go Back",icon:e.jsx(Se,{}),buttonBackgroundColor:"bg-green-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"submit",className:"p-2 rounded-full bg-green-200 hover:bg-green-300 text-green-700 shadow",disabled:o,title:"Confirm",children:e.jsx(ie,{size:18})})})}),e.jsx("h2",{className:"text-xl font-semibold mb-6 text-center flex items-center justify-center gap-2",children:"Edit Vehicle"}),j&&e.jsxs("div",{className:"bg-red-100 text-red-700 border border-red-400 px-4 py-3 rounded mb-4 text-center",children:["❌ ",j]}),e.jsxs("form",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle Number"}),e.jsx("input",{name:"vehicle_number",value:l.vehicle_number,onChange:v,className:"input",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle Name"}),e.jsx("input",{name:"name",value:l.name,onChange:v,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle Type"}),e.jsxs("select",{name:"type",value:l.type,onChange:v,className:"input",children:[e.jsx("option",{value:"",children:"Select Type"}),D.map(f=>e.jsx("option",{children:f},f))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Daily Rent Cost (Rs)"}),e.jsx("input",{type:"number",name:"rent_cost_daily",value:l.rent_cost_daily,onChange:v,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"AC Type"}),e.jsxs("select",{name:"ac_type",value:l.ac_type,onChange:v,className:"input",children:[e.jsx("option",{value:"",children:"Select AC Type"}),w.map(f=>e.jsx("option",{children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fuel Type"}),e.jsxs("select",{name:"fuel_id",value:l.fuel_id,onChange:v,className:"input",children:[e.jsx("option",{value:"",children:"Select Fuel"}),u.map(f=>e.jsxs("option",{value:f.fuel_id,children:[f.type," - Rs.",f.cost]},f.fuel_id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Owner"}),e.jsxs("select",{name:"owner_id",value:l.owner_id,onChange:v,className:"input",children:[e.jsx("option",{value:"",children:"Select Owner"}),i.map(f=>e.jsxs("option",{value:f.owner_id,children:[f.owner_name||f.name," (",f.nic,")"]},f.owner_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Owner Monthly Cost (Rs)"}),e.jsx("input",{type:"number",name:"owner_cost_monthly",value:l.owner_cost_monthly,onChange:v,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Mileage Cost (Rs/km)"}),e.jsx("input",{type:"number",name:"mileage_cost",value:l.mileage_cost,onChange:v,className:"input"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Additional Mileage Cost (Rs/km)"}),e.jsx("input",{type:"number",name:"mileage_cost_additional",value:l.mileage_cost_additional,onChange:v,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Current Meter Number"}),e.jsx("input",{type:"number",name:"meter_number",value:l.meter_number,onChange:v,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Last Service Meter Number"}),e.jsx("input",{type:"number",name:"last_service_meter_number",value:l.last_service_meter_number,onChange:v,className:"input"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fuel Efficiency (km/l)"}),e.jsx("input",{type:"number",step:"0.1",name:"vehicle_fuel_efficiency",value:l.vehicle_fuel_efficiency,onChange:v,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"License Expiry Date"}),e.jsx("input",{type:"date",name:"license_expiry_date",value:l.license_expiry_date,onChange:v,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Insurance Expiry Date"}),e.jsx("input",{type:"date",name:"insurance_expiry_date",value:l.insurance_expiry_date,onChange:v,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Eco Test Expiry Date"}),e.jsx("input",{type:"date",name:"eco_test_expiry_date",value:l.eco_test_expiry_date,onChange:v,className:"input"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6 mt-6",children:C.map(f=>e.jsxs("div",{className:"flex flex-col items-center relative",children:[e.jsx("label",{className:"label mb-2 text-sm font-medium text-gray-700",children:f.replace("_"," ").toUpperCase()}),e.jsxs("div",{className:"relative w-36 h-36 border-2 border-dashed rounded-xl flex flex-col items-center justify-center bg-gray-50 hover:bg-green-50 overflow-hidden",children:[c[f]?e.jsx("img",{src:c[f],alt:f,className:"w-full h-full object-cover rounded-xl"}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"text-gray-400 text-2xl mb-2"}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Upload"})]}),e.jsx("input",{type:"file",accept:"image/*",name:f,onChange:E,className:"absolute inset-0 opacity-0 cursor-pointer z-10"})]})]},f))})]})]})})}function Ys({vehicle:t,onClose:r,onDelete:s,onUpdated:l}){var b,j,S,D,w,C;const[n,i]=a.useState(!1),[p,u]=a.useState({...t}),[m,c]=a.useState(!1),[g,x]=a.useState(null),[k,h]=a.useState(""),A=q();if(a.useEffect(()=>{u({...t}),i(!1),x(null),h("")},[t]),!t)return null;const o=async()=>{var v,E;c(!0),x(null);try{await z.delete(`/api/vehicles/${t.vehicle_id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),s(t.vehicle_id),h("Vehicle deleted successfully!"),setTimeout(()=>h(""),2e3)}catch(N){console.error(N),x(((E=(v=N.response)==null?void 0:v.data)==null?void 0:E.message)||"Failed to delete vehicle.")}finally{c(!1)}};return e.jsx("div",{className:"flex justify-center items-center w-100 h-full bg-gray-100",children:e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl w-full max-w-md overflow-auto h-full relative",children:[g&&e.jsxs("div",{className:"bg-red-100 text-red-800 border border-red-300 px-4 py-2 rounded text-center mb-4",children:["❌ ",g]}),k&&e.jsxs("div",{className:"bg-green-100 text-green-800 border border-green-300 px-4 py-2 rounded text-center mb-4",children:["✅ ",k]}),!n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"absolute top-3 left-3 flex gap-3",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-700 shadow",title:"Close",children:e.jsx(le,{size:16})}),e.jsx("button",{onClick:()=>i(!0),className:"p-2 rounded-full bg-blue-200 hover:bg-blue-300 text-blue-700 shadow",title:"Edit Vehicle",children:e.jsx(xe,{size:16})})]}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(G,{onConfirm:o,message:"Are you sure you want to delete this vehicle?",confirmText:"Yes, Delete",cancelText:"Cancel",icon:e.jsx(ne,{}),buttonBackgroundColor:"bg-red-600",buttonTextColor:"text-white",children:e.jsx("button",{className:"p-2 rounded-full bg-red-200 hover:bg-red-300 text-red-700 shadow",disabled:m,children:e.jsx(ne,{size:16})})})}),e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Vehicle Profile"}),e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-28 h-28 rounded-2xl bg-gray-200 shadow border flex items-center justify-center overflow-hidden cursor-pointer",onClick:()=>A(`/vehicles/${t.vehicle_id}`),children:t.image?e.jsx("img",{src:t.image,alt:"Vehicle",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-3xl font-bold text-gray-700",children:((j=(b=t.name)==null?void 0:b.charAt(0))==null?void 0:j.toUpperCase())||"V"})}),e.jsx("h3",{className:"text-xl font-semibold text-black mt-3 cursor-pointer",onClick:()=>A(`/vehicles/${t.vehicle_id}`),children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Vehicle ID: #",t.vehicle_id]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 shadow-inner",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Vehicle Number:"})," ",e.jsx("br",{})," ",t.vehicle_number||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",e.jsx("br",{})," ",t.type||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Owner:"})," ",e.jsx("br",{})," ",((S=t.owner)==null?void 0:S.owner_name)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",e.jsx("br",{})," ",((D=t.owner)==null?void 0:D.contact_number)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fuel Type:"})," ",e.jsx("br",{})," ",((w=t.fuel)==null?void 0:w.type)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Daily Rent:"})," ",e.jsx("br",{})," ",t.rent_cost_daily||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Monthly Owner Cost:"})," ",e.jsx("br",{})," ",t.owner_cost_monthly||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Mileage Cost:"})," ",e.jsx("br",{})," ",(C=t.mileage_costs)!=null&&C[0]?`Base: ${t.mileage_costs[0].mileage_cost}, Additional: ${t.mileage_costs[0].mileage_cost_additional}`:"-"]})]})]})]}),n&&e.jsx(Ee,{vehicle:t,onCancel:()=>i(!1),onSuccess:v=>{l(v),i(!1)}})]})})}function qs(){const{name:t,role:r}=V(),[s,l]=a.useState([]),[n,i]=a.useState(!0),[p,u]=a.useState(null),[m,c]=a.useState(!1),[g,x]=a.useState(null),[k,h]=a.useState(!1),[A,o]=a.useState(""),[b,j]=a.useState(!1),[S,D]=a.useState("");a.useEffect(()=>{(async()=>{var _,y;try{i(!0);const P=await z.get("/api/vehicles",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log("API Response:",P.data);const $=Array.isArray(P.data)?P.data:[];l($)}catch(P){console.error(P),x(((y=(_=P.response)==null?void 0:_.data)==null?void 0:y.message)||"Failed to fetch vehicles")}finally{i(!1)}})()},[]);const w={total:s.length,active:s.filter(d=>d.status==="available").length,rented:s.filter(d=>d.status==="rented").length,newThisMonth:s.filter(d=>{if(!d.created_at)return!1;const _=new Date(d.created_at),y=new Date;return _.getMonth()===y.getMonth()&&_.getFullYear()===y.getFullYear()}).length},C=s.filter(d=>{const _=A.toLowerCase();return(d.vehicle_number||"").toLowerCase().includes(_)||(d.name||"").toLowerCase().includes(_)||(d.type||"").toLowerCase().includes(_)}),v=d=>{u(d),h(!1),j(!1),c(!0)},E=()=>{j(!0),c(!1)},N=()=>{u(null),c(!1)},f=d=>{l(_=>_.filter(y=>y.vehicle_id!==d)),u(null),c(!1)},T=d=>{d!=null&&d.vehicle_id&&(l(_=>_.map(y=>(y==null?void 0:y.vehicle_id)===d.vehicle_id?d:y)),u(d),j(!1),D("Vehicle updated successfully!"),setTimeout(()=>D(""),3e3))};return e.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-gray-50",children:[e.jsx(re,{}),e.jsx("main",{className:"flex-1 overflow-auto p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Vehicle Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage all vehicles in the system"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:t})," — ",r]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-1 mt-6 items-stretch",children:[e.jsx("div",{className:"lg:col-span-3 h-full",children:e.jsx(Ls,{stats:w})}),e.jsx("div",{className:"lg:col-span-1 h-full flex flex-col",children:e.jsx(zs,{onAddVehicleClick:()=>{h(!0),c(!1),u(null)}})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Us,{onSearch:d=>o(d)})}),e.jsx("div",{className:"mt-8",children:e.jsx(Rs,{vehicles:C,loading:n,error:g,onSelectVehicle:v})})]})}),k&&e.jsx(Ce,{onClose:()=>h(!1),children:e.jsx(Os,{onCancel:()=>h(!1),onClose:()=>h(!1),onSuccess:d=>{l([...s,d]),h(!1)}})}),b&&p&&e.jsx(Ce,{onClose:()=>j(!1),children:e.jsx(Ee,{vehicle:p,onCancel:()=>j(!1),onSuccess:T})}),p&&!b&&m&&e.jsx(Ys,{vehicle:p,onClose:N,onDelete:f,onUpdated:T,onEdit:E}),S&&e.jsx("div",{className:"fixed top-5 right-5 bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded shadow-lg z-50",children:S})]})}function Vs({stats:t}){return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:e.jsx(Xs,{title:"Total Admins",value:t.total,gradient:"from-indigo-600 to-violet-600"})})}function Xs({title:t,value:r,gradient:s}){return e.jsxs("div",{className:`p-5 rounded-xl shadow-md text-white bg-gradient-to-r ${s}`,children:[e.jsx("div",{className:"text-md font-semibold opacity-90",children:t}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:r??0})]})}function Gs({onAddAdminClick:t}){return q(),e.jsx("div",{className:"flex flex-col gap-4 h-full cursor-pointer",onClick:t,children:e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow flex flex-col justify-between h-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-50",children:e.jsx(oe,{className:"text-blue-600"})}),e.jsx("div",{className:"font-semibold",children:"Add New Admin Role"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Register a new Admin Role to the system."})]})})}function Hs({admins:t=[],loading:r,error:s,onSelectAdmin:l,onDeleteAdmin:n}){return e.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:r?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading admin roles..."}):s?e.jsx("div",{className:"text-center py-12 text-red-500",children:s}):t.length===0?e.jsx("div",{className:"text-center py-12 text-gray-600",children:"No admin roles found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{className:"text-left text-sm text-gray-600 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4",children:"Admin ID"}),e.jsx("th",{className:"py-3 px-4",children:"Email"}),e.jsx("th",{className:"py-3 px-4",children:"Role"}),e.jsx("th",{className:"py-3 px-4",children:"Action"})]})}),e.jsx("tbody",{children:t.map(i=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition",onClick:()=>l&&l(i),children:[e.jsxs("td",{className:"py-4 px-4 flex items-center gap-3",children:[e.jsx(Ws,{name:i.role}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i.email.split("@")[0]}),e.jsx("div",{className:"text-xs text-gray-400",children:i.admin_id})]})]}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600",children:i.email}),e.jsx("td",{className:"py-4 px-4 text-sm text-gray-600",children:i.role}),e.jsx("td",{className:"py-4 px-4",children:e.jsx(G,{onConfirm:()=>n(i),onCancel:()=>{},message:"Are you sure you want to delete this vehicle?",confirmText:"Yes, Delete",cancelText:"Cancel",icon:e.jsx(Tt,{}),buttonBackgroundColor:"bg-red-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"button",className:"bg-indigo-500 text-white px-3 py-1 rounded-xl hover:bg-red-800 transition",disabled:r,children:"Delete"})})})]},i.id))})]})})})}function Ws({name:t}){const r=(t||"A").split(" ").map(s=>s[0]).slice(0,2).join("").toUpperCase();return e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-semibold text-gray-700",children:r})}const Ks=({onClose:t,onSuccess:r})=>{const s=q(),{name:l,role:n}=V(),[i,p]=a.useState({email:"",password:"",role:"Admin",driver_id:null,customer_id:null}),[u,m]=a.useState([]),[c,g]=a.useState([]),[x,k]=a.useState(!1),[h,A]=a.useState(!1),[o,b]=a.useState(null),[j,S]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const f=localStorage.getItem("token");if(!f){b("Unauthorized! Please log in first."),s("/login");return}const T=await Z.get("https://rashen.sceniccottage.com/api/admin-roles/without-admin",{headers:{Authorization:`Bearer ${f}`}});m(T.data.data.drivers||[]),g(T.data.data.customers||[])}catch(f){console.error("Error fetching available users:",f),b("Failed to fetch available users.")}})()},[s]);const D=N=>{const{name:f,value:T}=N.target;p(d=>({...d,[f]:T}))},w=N=>{const f=N.target.value;p(T=>({...T,role:f,driver_id:f==="Driver"?T.driver_id:null,customer_id:f==="Customer"?T.customer_id:null}))},C=async N=>{var f,T;if(N.preventDefault(),!!h)try{k(!0);const d=localStorage.getItem("token"),_={email:i.email,password:i.password,role:i.role,driver_id:i.role==="Driver"?i.driver_id:null,customer_id:i.role==="Customer"?i.customer_id:null},y=await Z.post("https://rashen.sceniccottage.com/api/admin-roles",_,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`}});(y.status===200||y.status===201)&&(S(!0),r(y.data.data),setTimeout(()=>{S(!1)},2e3))}catch(d){console.error("Error creating admin role:",d),b(((T=(f=d.response)==null?void 0:f.data)==null?void 0:T.message)||"Failed to create admin role. Try again.")}finally{k(!1),A(!1)}},v=()=>{A(!0),C(new Event("submit"))},E=()=>{A(!1)};return e.jsx("div",{className:"flex justify-center items-center w-100 min-h-screen bg-white-100",children:e.jsxs("div",{className:"bg-white p-10 rounded-lg shadow-lg  h-full w-full max-w-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-center",children:"Create New Admin Role"}),o&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 p-3 rounded mb-4 text-center",children:["❌ ",o]}),j&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 p-3 rounded mb-4 text-center",children:"✅ Admin role created successfully!"}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsx("input",{type:"email",name:"email",placeholder:"Email",value:i.email,onChange:D,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0}),e.jsx("input",{type:"password",name:"password",placeholder:"Password",value:i.password,onChange:D,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0}),e.jsxs("select",{name:"role",value:i.role,onChange:w,className:"w-full p-2 border border-gray-300 rounded-lg",required:!0,children:[e.jsx("option",{value:"SuperAdmin",children:"SuperAdmin"}),e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Driver",children:"Driver"}),e.jsx("option",{value:"Customer",children:"Customer"})]}),i.role==="Driver"&&e.jsxs("select",{name:"driver_id",value:i.driver_id||"",onChange:N=>p({...i,driver_id:Number(N.target.value)}),className:"w-full border p-2 rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select a Driver (without account)"}),u.map(N=>e.jsxs("option",{value:N.driver_id,children:[N.name," — ",N.phone_number]},N.driver_id))]}),i.role==="Customer"&&e.jsxs("select",{name:"customer_id",value:i.customer_id||"",onChange:N=>p({...i,customer_id:Number(N.target.value)}),className:"w-full border p-2 rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select a Customer (without account)"}),c.map(N=>e.jsxs("option",{value:N.customer_id,children:[N.name," — ",N.phone_number]},N.customer_id))]}),e.jsx(G,{onConfirm:v,onCancel:E,message:"Confirm Creating Admin Role",additionalInfo:"Please double-check the email, password, and role details.",confirmText:"Yes, Create",cancelText:"No, Cancel",icon:e.jsx(je,{}),buttonBackgroundColor:"bg-blue-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition duration-300",disabled:x,children:x?"Creating...":"Create Admin Role"})}),e.jsx("button",{type:"button",onClick:t,className:"w-full mt-2 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition duration-300",children:"Cancel"})]})]})})};function Qs({onSearch:t}){const[r,s]=a.useState(""),l=n=>{const i=n.target.value;s(i),t(i)};return e.jsx("div",{className:"w-full mb-4 outline-none",children:e.jsxs("div",{className:"flex items-center bg-white p-3 rounded-lg  shadow flex",children:[e.jsx(ue,{className:"text-gray-400 mr-3 "}),e.jsx("input",{type:"text",placeholder:"Search admin by name, role...",value:r,onChange:l,className:"w-full outline-none text-sm "})]})})}function Zs(){const{name:t,role:r}=V(),[s,l]=a.useState([]),[n,i]=a.useState(!0),[p,u]=a.useState(null),[m,c]=a.useState(null),[g,x]=a.useState(!1),[k,h]=a.useState(!1),[A,o]=a.useState(""),[b,j]=a.useState("");a.useEffect(()=>{(async()=>{var v,E;try{const N=await z.get("/api/admin-roles",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),f=Array.isArray(N.data.data)?N.data.data:[];l(f)}catch(N){console.error("Error fetching admins:",N),u(((E=(v=N.response)==null?void 0:v.data)==null?void 0:E.message)||"Failed to fetch admin data.")}finally{i(!1)}})()},[]);const S={total:s.length,active:s.filter(C=>C.status==="active").length,inactive:s.filter(C=>C.status==="inactive").length,newThisMonth:s.filter(C=>{if(!C.created_at)return!1;const v=new Date(C.created_at),E=new Date;return v.getMonth()===E.getMonth()&&v.getFullYear()===E.getFullYear()}).length},D=s.filter(C=>{const v=A.toLowerCase();return C.email.toLowerCase().includes(v)||C.role&&C.role.toLowerCase().includes(v)}),w=async C=>{var v,E;if(C){i(!0),u(null);try{await z.delete(`/api/admin-roles/${C.admin_id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),l(N=>N.filter(f=>f.admin_id!==C.admin_id)),c(null),j("Admin deleted successfully!"),setTimeout(()=>j(""),2e3)}catch(N){console.error(N),u(((E=(v=N.response)==null?void 0:v.data)==null?void 0:E.message)||"Failed to delete admin.")}finally{i(!1)}}};return e.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-gray-50",children:[e.jsx(re,{}),e.jsx("main",{className:"flex-1 overflow-auto p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Admin Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage all admins in the system"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:t})," — ",r]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-1 mt-6 items-stretch",children:[e.jsx("div",{className:"lg:col-span-3 h-full",children:e.jsx(Vs,{stats:S})}),e.jsx("div",{className:"lg:col-span-1 h-full flex flex-col",children:e.jsx(Gs,{onAddAdminClick:()=>{x(!0),c(null)}})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Qs,{onSearch:C=>o(C)})}),e.jsx("div",{className:"mt-8",children:e.jsx(Hs,{admins:D,loading:n,error:p,onDeleteAdmin:w})})]})}),g&&e.jsx(Ks,{onCancel:()=>x(!1),onClose:()=>x(!1),onSuccess:C=>{l([C,...s]),x(!1)}}),b&&e.jsx("div",{className:"fixed top-5 right-5 bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded shadow-lg z-50",children:b})]})}const Js=({title:t,children:r,footer:s})=>{const[l,n]=a.useState(!1);return e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-violet-700  rounded-2xl p-6 200 transition hover:shadow-lg mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",onClick:()=>n(!l),children:[e.jsx("div",{className:"flex items-center",children:e.jsx("h2",{className:"text-xl font-semibold text-white",children:t})}),e.jsx("button",{className:"text-sm text-white underline-white hover:text-gray-100 transition",children:l?e.jsx(at,{}):e.jsx(lt,{})})]}),e.jsx("div",{className:"border-b pb-2 mb-4 border-white"}),!l&&e.jsx("div",{className:"transition-all",children:r}),!l&&s&&e.jsx("div",{className:"mt-5 border-t pt-3",children:s})]})},ct=({title:t,children:r,footer:s})=>{const[l,n]=a.useState(!1);return e.jsxs("div",{className:"bg-white shadow-sm rounded-2xl p-4 border border-white transition hover:shadow-lg mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3   p-1 rounded-xl",onClick:()=>n(!l),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-8 bg-indigo-800 rounded mr-3"}),e.jsx("h2",{className:"text-xl font-bold text-indigo-900",children:t})]}),e.jsx("button",{className:"text-sm text-blue-800 underline hover:text-blue-800 transition",children:l?e.jsx(at,{}):e.jsx(lt,{})})]}),e.jsx("div",{className:"border-b pb-2 mb-4"}),!l&&e.jsx("div",{className:"transition-all",children:r}),!l&&s&&e.jsx("div",{className:"mt-5 border-t pt-3",children:s})]})},ee=({label:t,value:r})=>e.jsxs("div",{className:"flex justify-between items-center py-2 px-3 rounded-lg hover:bg-white-50 transition",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:t}),e.jsx("span",{className:"font-semibold text-gray-90text-gray-600 font-medium0",children:r??"-"})]}),se=({label:t,value:r})=>e.jsxs("div",{className:"flex justify-between items-center py-2 px-3 rounded-lg hover:bg-white-50 transition",children:[e.jsx("span",{className:"text-white font-medium",children:t}),e.jsx("span",{className:"font-semibold text-white text-gray-600 font-medium0",children:r??"-"})]}),ea=({trip:t,isBase64:r})=>{var u;const s=t.customer;if(!s)return e.jsx("div",{className:"text-sm font-semibold text-white mt-2",children:"No customer data"});const l=s.nic_photo_frontt?r(s.nic_photo_frontt)?`data:image/jpeg;base64,${s.nic_photo_frontt}`:s.nic_photo_front:null,n=s.nic_photo_front?r(s.nic_photo_front)?`data:image/jpeg;base64,${s.nic_photo_front}`:s.nic_photo_front:null,i=s.nic_photo_back?r(s.nic_photo_back)?`data:image/jpeg;base64,${s.nic_photo_back}`:s.nic_photo_back:null,p=((u=s.name)==null?void 0:u.split(" ").map(m=>m[0]).join("").toUpperCase())||"?";return e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-violet-600 rounded-xl  p-4 flex flex-col items-center text-sm",children:[l?e.jsx("img",{src:l,alt:"Customer Avatar",className:"w-32 h-32 object-cover rounded-full shadow border mb-4"}):e.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-300 flex items-center justify-center text-3xl font-bold text-black shadow mb-4",children:p}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:s.name}),e.jsxs("div",{className:"w-full flex flex-col gap-2 mt-2 text-white",children:[e.jsx(se,{label:"NIC",value:s.nic}),e.jsx(se,{label:"Phone",value:s.phone_number}),e.jsx(se,{label:"Email",value:s.email})]}),e.jsxs("div",{className:"flex gap-3 mt-4 flex-wrap justify-center",children:[n&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:n,alt:"NIC Front",className:"w-36 h-24 object-cover rounded-lg shadow border-2 border-white"}),e.jsx("span",{className:"text-xs text-white mt-1",children:"NIC Front"})]}),i&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:i,alt:"NIC Back",className:"w-36 h-24 object-cover rounded-lg shadow border-2 border-white"}),e.jsx("span",{className:"text-xs text-white mt-1",children:"NIC Back"})]})]})]})},ta=({trip:t,isBase64:r})=>{var l;if(!t.driver)return e.jsx("div",{className:"text-sm font-semibold text-gray-100 mt-2",children:"No driver assigned"});const s=(l=t.driver)!=null&&l.image?r(t.driver.image)?`data:image/jpeg;base64,${t.driver.image}`:t.driver.image:null;return e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-violet-600 border-gray-200 rounded-xl shadow-md p-4 flex flex-col items-center text-sm",children:[s&&e.jsx("img",{src:s,alt:"Driver",className:"w-40 h-40 object-cover rounded-full shadow mb-4 border-2 border-white"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-100 mb-1",children:t.driver.name}),e.jsxs("div",{className:"w-full flex flex-col gap-2 mt-2",children:[e.jsx(se,{label:"Phone",value:t.driver.phone_number}),e.jsx(se,{label:"NIC",value:t.driver.nic}),e.jsx(se,{label:"Age",value:t.driver.age}),e.jsx(se,{label:"License No.",value:t.driver.license_number}),e.jsx(se,{label:"Charges",value:`Rs. ${t.driver.driver_charges}`})]})]})},sa=({trip:t,isBase64:r})=>{const s=t.vehicle;if(!s)return e.jsx("div",{className:"text-sm font-semibold text-gray-100 mt-2",children:"No vehicle assigned"});const l=s.image?r(s.image)?`data:image/jpeg;base64,${s.image}`:s.image:null;return e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-violet-600 border-gray-200 rounded-xl shadow-md p-4 flex flex-col items-center text-sm",children:[l&&e.jsx("img",{src:l,alt:"Vehicle",className:"w-56 h-40 object-cover rounded-xl shadow mb-4 border-2 border-white"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-100 mb-1",children:s.name}),e.jsxs("div",{className:"w-full flex flex-col gap-2 mt-2",children:[e.jsx(se,{label:"Number",value:s.vehicle_number}),e.jsx(se,{label:"Type",value:s.type}),e.jsx(se,{label:"AC Type",value:s.ac_type}),e.jsx(se,{label:"Fuel Efficiency",value:s.vehicle_fuel_efficiency?`${s.vehicle_fuel_efficiency} km/l`:"-"}),e.jsx(se,{label:"License Expiry",value:s.license_expiry_date?new Date(s.license_expiry_date).toLocaleDateString():"-"}),e.jsx(se,{label:"Insurance Expiry",value:s.insurance_expiry_date?new Date(s.insurance_expiry_date).toLocaleDateString():"-"}),e.jsx(se,{label:"Last Service Meter",value:s.last_service_meter_number})]})]})},aa=({trip:t,formatCurrency:r,formatDate:s})=>{var l,n;return e.jsxs(ct,{title:"Cost Summary",children:[e.jsx("div",{className:"bg-gray-100 p-1 rounded-lg",children:e.jsx("div",{className:"flex flex-col gap-1 text-gray-600 font-medium",children:[["Vehicle Rent (Daily)",t.vehicle_rent_daily],["Driver Cost",t.driver_cost],["Mileage Extra Cost",t.additional_mileage_cost],["Mileage Cost (Applied)",t.mileage_cost],["Discount",t.discount],["Damage Cost",t.damage_cost]].map(([i,p],u)=>e.jsx(ee,{label:i,value:r(p)},u))})}),((l=t.other_trip_costs)==null?void 0:l.length)>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Other Trip Costs"}),e.jsx("ul",{className:"text-sm list-disc ml-5 space-y-1",children:t.other_trip_costs.map(i=>e.jsxs("li",{children:[i.cost_type,": ",e.jsx("span",{className:"font-medium",children:r(i.cost_amount)})]},i.trip_other_cost_id))})]}),e.jsx("br",{}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Payments"}),e.jsx("div",{className:"border-b pb-2 mb-4"}),e.jsx("div",{className:"bg-gray-100 p-1 rounded-lg",children:e.jsxs("div",{className:"flex flex-col gap-1 text-gray-600 font-medium",children:[e.jsx(ee,{label:"Advance Payment",value:r(t.advance_payment)}),e.jsx(ee,{label:"Payment Amount",value:r(t.payment_amount)}),e.jsx(ee,{label:"Payment Status",value:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${t.payment_status==="Paid"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.payment_status})})]})}),((n=t.payments)==null?void 0:n.length)>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"All Payments"}),e.jsx("ul",{className:"text-sm list-disc ml-5 space-y-1",children:t.payments.map(i=>e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:r(i.amount)})," ",e.jsxs("span",{className:"text-gray-500 text-xs",children:["(",s(i.payment_date),")"]})]},i.payment_id))})]}),e.jsxs("div",{className:"mt-5 p-2 bg-gradient-to-r from-indigo-100 to-violet-100 border-l-4 border-indigo-400 rounded-xl flex items-center justify-between shadow-md hover:shadow-lg transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{className:"text-indigo-600 text-xl"}),e.jsx("div",{children:e.jsx("div",{className:"text-md font-bold text-indigo-800",children:"Estimated Cost"})})]}),e.jsx("div",{className:"text-xl font-bold text-indigo-900",children:r(t.total_estimated_cost)})]}),e.jsxs("div",{className:"mt-5 p-2 bg-gradient-to-r from-indigo-200 to-violet-200 border-l-4 border-indigo-600 rounded-xl flex items-center justify-between shadow-md hover:shadow-lg transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{className:"text-indigo-700 text-xl"}),e.jsx("div",{children:e.jsx("div",{className:"text-md font-bold text-indigo-800",children:"Total Actual Cost"})})]}),e.jsx("div",{className:"text-xl font-bold text-indigo-900",children:r(t.total_actual_cost)})]})]})},la=({tripStatus:t,onAddPayment:r,onAddDamage:s,onCompleteTrip:l,onAlterReturnDate:n,onAlterMeter:i,onGetPrint:p,onStartTrip:u,onEndTrip:m,onCancelTrip:c})=>{const g="bg-white px-3 py-2 rounded-lg shadow cursor-pointer hover:shadow-md transition flex items-center gap-2 text-sm",x="p-2 rounded-md flex items-center justify-center",k=t==="Pending",h=t==="Ongoing",A=t==="Ended",o=t==="Ended"||t==="Completed"||t==="Pending"||t==="Ongoing"||t==="Cancelled",b=t==="Pending"||t==="Ongoing",j=t!=="Completed"&&t!=="Cancelled",S=t!=="Completed"&&t!=="Cancelled",D=t!=="Completed"&&t!=="Cancelled";return e.jsxs("div",{className:"flex flex-wrap gap-2",children:[k&&e.jsxs("div",{className:g,onClick:u,children:[e.jsx("div",{className:`${x} bg-green-50`,children:e.jsx(Dt,{className:"text-green-600 text-base"})}),e.jsx("div",{children:"Start Trip"})]}),h&&e.jsxs("div",{className:g,onClick:m,children:[e.jsx("div",{className:`${x} bg-red-50`,children:e.jsx(Et,{className:"text-red-600 text-base"})}),e.jsx("div",{children:"End Trip"})]}),S&&e.jsxs("div",{className:g,onClick:r,children:[e.jsx("div",{className:`${x} bg-blue-50`,children:e.jsx(Je,{className:"text-blue-600 text-base"})}),e.jsx("div",{children:"Add Payment"})]}),D&&e.jsxs("div",{className:g,onClick:s,children:[e.jsx("div",{className:`${x} bg-red-50`,children:e.jsx(_e,{className:"text-red-600 text-base"})}),e.jsx("div",{children:"Add Damage"})]}),A&&e.jsxs("div",{className:g,onClick:l,children:[e.jsx("div",{className:`${x} bg-green-50`,children:e.jsx(ie,{className:"text-green-600 text-base"})}),e.jsx("div",{children:"Complete Trip"})]}),j&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:g,onClick:n,children:[e.jsx("div",{className:`${x} bg-purple-50`,children:e.jsx(Pt,{className:"text-purple-600 text-base"})}),e.jsx("div",{children:"Alter Dates"})]}),e.jsxs("div",{className:g,onClick:i,children:[e.jsx("div",{className:`${x} bg-yellow-50`,children:e.jsx(_e,{className:"text-yellow-600 text-base"})}),e.jsx("div",{children:"Alter Meter"})]})]}),o&&e.jsxs("div",{className:g,onClick:p,children:[e.jsx("div",{className:`${x} bg-indigo-50`,children:e.jsx($t,{className:"text-indigo-600 text-base"})}),e.jsx("div",{children:"Print"})]}),b&&e.jsxs("div",{className:g,onClick:c,children:[e.jsx("div",{className:`${x} bg-red-100`,children:e.jsx(rt,{className:"text-red-700 text-base"})}),e.jsx("div",{children:"Cancel Trip"})]})]})},ra=({open:t,onClose:r,tripId:s,onSuccess:l})=>{const[n,i]=a.useState(""),[p,u]=a.useState(!1);if(!t)return null;const m=async()=>{var c,g;if(!n)return alert("Enter damage amount");try{u(!0),await z.patch(`/api/trips/${s}/damage`,{damage_amount:Number(n)},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),l(),r(),setTimeout(()=>{alert("Damage Cost Added!")},100)}catch(x){console.error(x),alert(((g=(c=x==null?void 0:x.response)==null?void 0:c.data)==null?void 0:g.message)||"Failed to add damage cost")}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/60 backdrop-blur-sm z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-xl w-80",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add Damage Cost"}),e.jsx("input",{type:"number",className:"w-full border border-gray-300 rounded px-3 py-2 mb-4",placeholder:"Enter damage amount (Rs)",value:n,onChange:c=>i(c.target.value)}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-300 rounded",children:"Cancel"}),e.jsx("button",{onClick:m,disabled:p,className:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-violet-600 text-white rounded hover:bg-indigo-700",children:p?"Saving...":"Add"})]})]})})},na=({open:t,onClose:r,tripId:s,onSuccess:l})=>{const[n,i]=a.useState(""),[p,u]=a.useState(""),[m,c]=a.useState(!1);if(!t)return null;const g=async()=>{var x,k;if(!n||!p)return alert("Amount and Payment Date are required.");try{c(!0),await z.post(`/api/trips/${s}/payment`,{amount:Number(n),payment_date:p},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),l(),r(),setTimeout(()=>{alert("Payment Added!")},100)}catch(h){console.error(h),alert(((k=(x=h==null?void 0:h.response)==null?void 0:x.data)==null?void 0:k.message)||"Failed to add payment")}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/60 backdrop-blur-sm z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-xl w-80",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add Payment"}),e.jsx("input",{type:"number",className:"w-full border border-gray-300 rounded px-3 py-2 mb-3",placeholder:"Enter payment amount (Rs)",value:n,onChange:x=>i(x.target.value)}),e.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded px-3 py-2 mb-4",value:p,onChange:x=>u(x.target.value)}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-300 rounded",children:"Cancel"}),e.jsx("button",{onClick:g,disabled:m,className:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-violet-600 text-white rounded hover:bg-purple-700",children:m?"Saving...":"Add Payment"})]})]})})},ia=({open:t,onClose:r,tripId:s,onSuccess:l})=>{const[n,i]=a.useState(""),[p,u]=a.useState(""),[m,c]=a.useState(!1);if(!t)return null;const g=async()=>{var x,k;if(!n||!p)return alert("Please select both dates");try{c(!0),await z.patch(`/api/trips/${s}/update-dates`,{leaving_datetime:n,actual_return_datetime:p},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),l(),r(),setTimeout(()=>{alert("Dates Updated!")},100)}catch(h){console.error(h),alert(((k=(x=h==null?void 0:h.response)==null?void 0:x.data)==null?void 0:k.message)||"Failed to update dates")}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/60 backdrop-blur-sm z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-xl w-96",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Alter Trip Dates"}),e.jsx("label",{className:"font-medium",children:"Leaving Date"}),e.jsx("input",{type:"datetime-local",value:n,onChange:x=>i(x.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 mb-4"}),e.jsx("label",{className:"font-medium",children:"Actual Return Date"}),e.jsx("input",{type:"datetime-local",value:p,onChange:x=>u(x.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 mb-4"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-300 rounded",children:"Cancel"}),e.jsx("button",{onClick:g,disabled:m,className:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-violet-600 text-white rounded hover:bg-indigo-700",children:m?"Saving...":"Update"})]})]})})},oa=({open:t,onClose:r,tripId:s,onSuccess:l})=>{const[n,i]=a.useState(""),[p,u]=a.useState(""),[m,c]=a.useState(!1);if(!t)return null;const g=async()=>{var x,k;if(!n||!p)return alert("Please enter both Start and End meter readings");try{c(!0),await z.patch(`/api/trips/${s}/update-meter`,{start_meter:Number(n),end_meter:Number(p)},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),l(),r(),setTimeout(()=>{alert("Meter Readings Updated!")},100)}catch(h){console.error(h),alert(((k=(x=h==null?void 0:h.response)==null?void 0:x.data)==null?void 0:k.message)||"Failed to update meter readings")}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/60 backdrop-blur-sm z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-xl w-96",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Alter Meter Readings"}),e.jsx("label",{className:"font-medium",children:"Start Meter"}),e.jsx("input",{type:"number",value:n,onChange:x=>i(x.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 mb-4",placeholder:"Enter start meter"}),e.jsx("label",{className:"font-medium",children:"End Meter"}),e.jsx("input",{type:"number",value:p,onChange:x=>u(x.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 mb-4",placeholder:"Enter end meter"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-300 rounded",children:"Cancel"}),e.jsx("button",{onClick:g,disabled:m,className:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-violet-600 text-white rounded hover:bg-indigo-700",children:m?"Saving...":"Update"})]})]})})},ca=({open:t,onClose:r,tripId:s,onSuccess:l})=>{const[n,i]=a.useState(!1);if(!t)return null;const p=async()=>{var u,m;try{i(!0),await z.patch(`/api/trips/${s}/complete`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),l(),r(),setTimeout(()=>{alert("Trip Completed!")},100)}catch(c){console.error(c),alert(((m=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:m.message)||"Failed to complete trip")}finally{i(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/60 backdrop-blur-sm z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-xl w-80",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Complete Trip"}),e.jsxs("p",{className:"mb-4 text-gray-700",children:["Are you sure you want to mark this trip as ",e.jsx("strong",{children:"Completed"}),"?"]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-300 rounded",children:"Cancel"}),e.jsx("button",{onClick:p,disabled:n,className:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-violet-600 text-white rounded hover:bg-indigo-700",children:n?"Completing...":"Complete"})]})]})})},da=({open:t,onClose:r,tripId:s,onSuccess:l})=>{const[n,i]=a.useState(null),[p,u]=a.useState(!0);a.useEffect(()=>{t&&m()},[t,s]);const m=async()=>{u(!0);try{const k=await z.get(`/api/trips/${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});i(k.data.data)}catch(k){console.error(k),alert("Failed to fetch trip details for printing")}finally{u(!1)}},c=k=>k==null?"-":`Rs. ${Number(k).toLocaleString()}`,g=k=>k?new Date(k).toLocaleString():"-",x=()=>{var h,A,o,b,j,S,D,w,C,v,E,N,f;if(!n)return;const k=window.open("","_blank");k.document.write(`
    <html>
      <head>
        <title>Invoice - Trip #${s}</title>

        <style>
          @page {
            size: A4;
            margin: 10mm;
          }

          body {
            font-family: Arial, sans-serif;
            width: 100%;
            margin: 0;
            padding: 0;
            font-size: 13px;
          }

          .page {
            width: 210mm;
            min-height: 297mm;
            padding: 10mm;
            box-sizing: border-box;
            margin: auto;
          }

          .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
          }

          .logo {
            height: 80px;
          }

          .title {
            text-align: right;
            font-size: 30px;
            font-weight: bold;
            color: #3C007E;
          }

          h3 {
            margin-bottom: 8px;
            border-bottom: 2px solid #cfcfcf;
            padding-bottom: 4px;
            color: #3C007E;
          }

          .section {
            margin-top: 10px;
          }
          
          .row {
            display: flex;
            justify-content: space-between;
            gap: 15px;
          }

          .col {
            width: 48%;
          }

          table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
          }

          th {
            text-align: left;
            background: #f2f2f2;
            padding: 5px;
            border: 1px solid #ccc;
            font-size: 13px;
          }

          td {
            padding: 5px;
            border: 1px solid #ccc;
            font-size: 13px;
          }

          .space {
            margin-bottom: 6px;
          }
        </style>

      </head>

      <body>
        <div class="page">

          <!-- HEADER -->
          <div class="header">
            <img src="/images/CP-Logo.png" class="logo" alt="Company Logo" />
            <div class="title">TRIP INVOICE</div>
          </div>

          <!-- INVOICE META -->
          <div class="section">
            <table>
              <tr><th>Invoice Date</th><td>${n.leaving_datetime?new Date(n.leaving_datetime).toLocaleDateString():"-"}</td></tr>
              <tr><th>Trip ID</th><td>${s}</td></tr>
            </table>
          </div>

          <!-- CUSTOMER + DRIVER -->
          <div class="section row">
            <div class="col">
              <h3>Customer Details</h3>
              <div class="space"><strong>Name:</strong> ${((h=n.customer)==null?void 0:h.name)||"-"}</div>
              <div class="space"><strong>NIC:</strong> ${((A=n.customer)==null?void 0:A.nic)||"-"}</div>
              <div class="space"><strong>Phone:</strong> ${((o=n.customer)==null?void 0:o.phone_number)||"-"}</div>
              <div class="space"><strong>Email:</strong> ${((b=n.customer)==null?void 0:b.email)||"-"}</div>
            </div>

            <div class="col">
              <h3>Driver Details</h3>
              <div class="space"><strong>Name:</strong> ${((j=n.driver)==null?void 0:j.name)||"-"}</div>
              <div class="space"><strong>NIC:</strong> ${((S=n.driver)==null?void 0:S.nic)||"-"}</div>
              <div class="space"><strong>Phone:</strong> ${((D=n.driver)==null?void 0:D.phone_number)||"-"}</div>
            </div>
          </div>

          <!-- TRIP SUMMARY + VEHICLE -->
          <div class="section row">
            <div class="col">
              <h3>Trip Summary</h3>
              <div class="space"><strong>Leaving Date:</strong> ${g(n.leaving_datetime)}</div>
              <div class="space"><strong>Estimated Return:</strong> ${g(n.estimated_return_datetime)}</div>
              <div class="space"><strong>Actual Return:</strong> ${g(n.actual_return_datetime)}</div>
              <div class="space"><strong>Passenger Count:</strong> ${n.num_passengers||"-"}</div>
            </div>

            <div class="col">
              <h3>Vehicle Details</h3>
              <div class="space"><strong>Name:</strong> ${((w=n.vehicle)==null?void 0:w.name)||"-"}</div>
              <div class="space"><strong>Vehicle No:</strong> ${((C=n.vehicle)==null?void 0:C.vehicle_number)||"-"}</div>
              <div class="space"><strong>Type:</strong> ${((v=n.vehicle)==null?void 0:v.type)||"-"}</div>
              
            </div>
          </div>

          <!-- DISTANCE + ROUTE -->
          <div class="section row">
            <div class="col">
              <h3>Distance</h3>
              <div class="space"><strong>Estimated Distance:</strong> ${n.estimated_distance||"-"} km</div>
              <div class="space"><strong>Actual Distance:</strong> ${n.actual_distance||"-"} km</div>
              <div class="space"><strong>Start Meter:</strong> ${n.start_meter||"-"}</div>
              <div class="space"><strong>End Meter:</strong> ${n.end_meter||"-"}</div>
            </div>

            <div class="col">
              <h3>Route</h3>
              ${(E=n.map)!=null&&E.length?n.map.sort((T,d)=>T.sequence-d.sequence).map(T=>`<div class="space"><strong>Route ${T.sequence}:</strong> ${T.location_name}</div>`).join(""):"<div>No routes recorded</div>"}
            </div>
          </div>

          <!-- COSTS + PAYMENTS SIDE BY SIDE -->
          <div class="section row">

            <!-- COSTS -->
            <div class="col">
              <h3>Costs</h3>
              <table>
                <tr><th>Vehicle Rent (Daily)</th><td>${c(n.vehicle_rent_daily)}</td></tr>
                <tr><th>Driver Cost</th><td>${c(n.driver_cost)}</td></tr>
                <tr><th>Fuel Cost</th><td>${c(n.fuel_cost)}</td></tr>
                <tr><th>Mileage Cost</th><td>${c(n.mileage_cost)}</td></tr>
                <tr><th>Mileage Extra Cost</th><td>${c(n.additional_mileage_cost)}</td></tr>
                <tr><th>Damage Cost</th><td>${c(n.damage_cost)}</td></tr>
               ${(N=n.other_trip_costs)!=null&&N.length?n.other_trip_costs.map(T=>`<tr>
                                  <th>${T.cost_type}:</th>
                                  <td>${c(T.cost_amount)}</td>
                                </tr>`).join(""):""}
                <tr><th>Discount</th><td>${c(n.discount)}</td></tr>              
              </table>
            </div>

            <!-- PAYMENTS -->
            <div class="col">
              <h3>Payments</h3>
              ${(f=n.payments)!=null&&f.length?`
                    <table>
                      <thead>
                        <tr><th>Date</th><th>Amount</th></tr>
                      </thead>
                      <tbody>
                        ${n.payments.map(T=>`<tr><td>${g(T.payment_date)}</td><td>${c(T.amount)}</td></tr>`).join("")}
                      </tbody>
                    </table>
                  `:"<p>No payments recorded</p>"}
            </div>
          </div>

          <!-- TOTALS -->
          <div class="section">
            <table>
              <tr><th>Total Estimated Cost</th><td>${c(n.total_estimated_cost)}</td></tr>
              <tr><th>Total Payments</th><td>${c(n.payment_ammount)}</td></tr>
              <tr><th>Total Actual Cost</th><td>${c(n.total_actual_cost)}</td></tr>
            </table>
          </div>

        </div>
      </body>
    </html>
  `),k.document.close(),k.focus(),k.onafterprint=()=>{r(),l()},k.print()};return t?p?e.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-black bg-opacity-40 text-white",children:"Loading..."}):e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/60 backdrop-blur-sm z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-xl w-96",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Print Trip #",s]}),e.jsx("p",{className:"mb-4 text-gray-600",children:"This will open the trip details in a printable format."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-300 rounded",children:"Cancel"}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-violet-600 text-white rounded hover:bg-indigo-700",children:"Print"})]})]})}):null},ma=({open:t,tripId:r,onClose:s,onSuccess:l})=>{const[n,i]=a.useState(""),[p,u]=a.useState(!1);if(!t)return null;const m=async()=>{var c,g;if(!n||isNaN(n))return alert("Enter a valid start meter");try{u(!0),await z.patch(`/api/trips/${r}/start`,{start_meter:Number(n)},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),l(),s(),setTimeout(()=>{alert("Trip Started!")},100)}catch(x){console.error(x),alert(((g=(c=x==null?void 0:x.response)==null?void 0:c.data)==null?void 0:g.message)||"Failed to start trip")}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center backdrop-blur-sm bg-white/50 z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-xl w-80",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Start Trip"}),e.jsx("input",{type:"number",placeholder:"Enter start meter",value:n,onChange:c=>i(c.target.value),className:"border rounded px-3 py-2 w-full mb-4 border-gray-300"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded",children:"Cancel"}),e.jsx("button",{onClick:m,disabled:p,className:"px-4 py-2 bg-green-600 text-white hover:bg-green-700 rounded",children:p?"Starting...":"Confirm"})]})]})})},ua=({open:t,tripId:r,currentMeter:s,onClose:l,onSuccess:n})=>{const[i,p]=a.useState(s||""),[u,m]=a.useState(!1);if(a.useEffect(()=>{p(s||"")},[s]),!t)return null;const c=async()=>{var g,x;if(!i||isNaN(i))return alert("Enter a valid end meter");try{m(!0),await z.patch(`/api/trips/${r}/end`,{end_meter:Number(i)},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),n(),l(),setTimeout(()=>{alert("Trip Ended!")},100)}catch(k){console.error(k),alert(((x=(g=k==null?void 0:k.response)==null?void 0:g.data)==null?void 0:x.message)||"Failed to end trip")}finally{m(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center backdrop-blur-sm bg-white/50 z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-xl w-80",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"End Trip"}),e.jsx("input",{type:"number",placeholder:"Enter end meter",value:i,onChange:g=>p(g.target.value),className:"border rounded px-3 py-2 w-full mb-4 border-gray-300"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded",children:"Cancel"}),e.jsx("button",{onClick:c,disabled:u,className:"px-4 py-2 bg-red-600 text-white hover:bg-red-700 rounded",children:u?"Ending...":"Confirm"})]})]})})},xa=({open:t,onClose:r,tripId:s,onSuccess:l})=>{const[n,i]=a.useState(!1);if(!t)return null;const p=async()=>{var u,m;if(window.confirm("Are you sure you want to cancel this trip?"))try{i(!0),await z.patch(`/api/trips/${s}/cancel`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),l(),r(),setTimeout(()=>{alert("Trip Canceled!")},100)}catch(c){console.error(c),alert(((m=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:m.message)||"Failed to cancel trip")}finally{i(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-50 p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-xl w-96",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-red-600",children:"Cancel Trip"}),e.jsx("p",{className:"mb-4",children:"Are you sure you want to cancel this trip? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-300 rounded",children:"Close"}),e.jsx("button",{onClick:p,disabled:n,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:n?"Cancelling...":"Cancel Trip"})]})]})})},ha=()=>{var H;const{id:t}=fe(),r=q(),[s,l]=a.useState(null),[n,i]=a.useState(!0),[p,u]=a.useState(null),[m,c]=a.useState(!0),[g,x]=a.useState(!0),[k,h]=a.useState(!0),[A,o]=a.useState(!1),[b,j]=a.useState(!1),[S,D]=a.useState(!1),[w,C]=a.useState(!1),[v,E]=a.useState(!1),[N,f]=a.useState(!1),[T,d]=a.useState("customer"),[_,y]=a.useState(!1),[P,$]=a.useState(!1),[U,F]=a.useState(!1);a.useEffect(()=>{M()},[t]);const M=async()=>{var Y,J;i(!0),u(null);try{const Q=await z.get(`/api/trips/${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});l(Q.data.data)}catch(Q){console.error(Q),u(((J=(Y=Q==null?void 0:Q.response)==null?void 0:Y.data)==null?void 0:J.message)||"Failed to fetch trip.")}finally{i(!1)}},R=Y=>Y==null?"-":`Rs. ${Number(Y).toLocaleString()}`,I=Y=>Y?new Date(Y).toLocaleString():"-",B=Y=>typeof Y=="string"&&/^[A-Za-z0-9+/=]+$/.test(Y.replace(/\s/g,""));return n?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"text-gray-600 text-lg animate-pulse",children:"Loading trip details..."})}):p?e.jsxs("div",{className:"text-center mt-20 text-red-600 text-lg",children:["❌ ",p]}):s?e.jsx("div",{className:"min-h-screen  bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-violet-600 h-220 p-2 rounded-xl shadow-md mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("button",{onClick:()=>r(-1),className:"px-3 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition flex items-center -mt-11 gap-2",children:e.jsx(st,{size:18})}),e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-3 mt-2",children:["Trip ID: ",s.trip_id]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-center mb-4",children:[e.jsx("span",{className:`px-2 py-1 rounded-md font-semibold ${s.trip_status==="Pending"?"bg-yellow-100 text-yellow-800":s.trip_status==="Ongoing"?"bg-blue-100 text-blue-800":s.trip_status==="Completed"?"bg-green-100 text-green-800":s.trip_status==="Ended"?"bg-gray-200 text-gray-700":s.trip_status==="Cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-700"}`,children:s.trip_status}),e.jsx("span",{className:`px-2 py-1 rounded-md font-semibold ${s.payment_status==="Paid"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.payment_status})]})]}),e.jsx("div",{className:"w-10"})]}),e.jsxs(Js,{title:"Trip Participants",children:[e.jsxs("div",{className:"flex gap-4 border-b border-gray-200 pb-2",children:[e.jsx("button",{onClick:()=>d("customer"),className:`px-4 py-2 font-semibold transition ${T==="customer"?"border-b-2 border-white text-white":"text-white hover:text-white"}`,children:"Customer"}),e.jsx("button",{onClick:()=>d("driver"),className:`px-4 py-2 font-semibold transition ${T==="driver"?"border-b-2 border-white text-white":"text-white hover:text-white"}`,children:"Driver"}),e.jsx("button",{onClick:()=>d("vehicle"),className:`px-4 py-2 font-semibold transition ${T==="vehicle"?"border-b-2 border-white text-white":"text-white hover:text-white"}`,children:"Vehicle"})]}),e.jsxs("div",{className:"mt-4",children:[T==="customer"&&e.jsx(ea,{trip:s,isBase64:B}),T==="driver"&&e.jsx(ta,{trip:s,isBase64:B}),T==="vehicle"&&e.jsx(sa,{trip:s,isBase64:B})]})]})]})}),e.jsx(ra,{open:A,onClose:()=>o(!1),tripId:s.trip_id,onSuccess:M}),e.jsx(na,{open:b,tripId:s.trip_id,onClose:()=>j(!1),onSuccess:M}),e.jsx(ia,{open:S,onClose:()=>D(!1),tripId:s.trip_id,onSuccess:M}),e.jsx(oa,{open:w,onClose:()=>C(!1),tripId:s.trip_id,onSuccess:M}),e.jsx(ca,{open:v,onClose:()=>E(!1),tripId:s.trip_id,onSuccess:M}),e.jsx(da,{open:N,onClose:()=>f(!1),tripId:s.trip_id,onSuccess:M}),e.jsx(ma,{open:_,tripId:s.trip_id,onClose:()=>y(!1),onSuccess:M}),e.jsx(ua,{open:P,tripId:s.trip_id,currentMeter:s.start_meter,onClose:()=>$(!1),onSuccess:M}),e.jsx(xa,{open:U,tripId:s.trip_id,onClose:()=>F(!1),onSuccess:M}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(la,{tripStatus:s.trip_status,onStartTrip:()=>y(!0),onEndTrip:()=>$(!0),onAddPayment:()=>j(!0),onAddDamage:()=>o(!0),onAlterReturnDate:()=>D(!0),onAlterMeter:()=>C(!0),onCompleteTrip:()=>E(!0),onGetPrint:()=>f(!0),onCancelTrip:()=>F(!0)})}),e.jsxs("div",{className:"max-h-[780px] overflow-y-auto pr-2",children:[e.jsxs(ct,{title:"Trip Summary",children:[e.jsxs("div",{className:"bg-gray-100 p-1 rounded-lg",children:[e.jsx(ee,{label:"From",value:s.from_location}),e.jsx(ee,{label:"To",value:s.to_location}),e.jsx(ee,{label:"Passengers",value:s.num_passengers})]}),e.jsx("br",{}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Distance & Route"}),e.jsx("div",{className:"border-b pb-2 mb-4"}),e.jsxs("div",{className:"bg-gray-100 p-1 rounded-lg",children:[e.jsx(ee,{label:"Estimated Distance",value:s.estimated_distance?s.estimated_distance+" km":"-"}),e.jsx(ee,{label:"Actual Distance",value:s.actual_distance?s.actual_distance+" km":"-"}),e.jsx(ee,{label:"Start Meter",value:s.start_meter}),e.jsx(ee,{label:"End Meter",value:s.end_meter})]}),e.jsx("h4",{className:"mt-3 font-semibold",children:"Route / Map"}),(H=s.map)!=null&&H.length?e.jsx("ol",{className:"list-decimal list-inside space-y-2 text-sm",children:s.map.slice().sort((Y,J)=>Y.sequence-J.sequence).map(Y=>e.jsxs("li",{children:[e.jsxs("span",{className:"font-medium",children:[Y.sequence,". ",Y.location_name]}),e.jsxs("span",{className:"text-gray-500 text-xs",children:[" ","(",Y.latitude,", ",Y.longitude,")"]})]},Y.map_id))}):e.jsx("div",{className:"text-sm text-gray-500",children:"No map locations recorded"}),e.jsx("br",{}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Dates"}),e.jsx("div",{className:"border-b pb-2 mb-4"}),e.jsxs("div",{className:"bg-gray-100 p-1 rounded-lg",children:[e.jsx(ee,{label:"Leaving Date",value:I(s.leaving_datetime)}),e.jsx(ee,{label:"Estimated Return",value:I(s.estimated_return_datetime)}),e.jsx(ee,{label:"Actual Return",value:I(s.actual_return_datetime)}),e.jsx(ee,{label:"Estimated Days",value:s.estimated_days}),e.jsx(ee,{label:"Actual Days",value:s.actual_days})]})]}),e.jsx(aa,{trip:s,formatCurrency:R,formatDate:I})]})]})]})]})}):e.jsx("div",{className:"text-center mt-20 text-gray-600",children:"Trip not found"})};function pa({onAddTripClick:t}){return q(),e.jsx("div",{className:"flex flex-col gap-4 h-33",children:e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow flex flex-col justify-between h-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-50",children:e.jsx(oe,{onClick:t,className:"text-blue-600"})}),e.jsx("div",{className:"font-semibold",children:"Add New Trip"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add a new Trip to the system."})]})})}function ga({stats:t,onStatusSelect:r}){return e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(he,{title:"Total",value:t.total,icon:e.jsx(Mt,{}),onClick:()=>r("")}),e.jsx(he,{title:"Pending",value:t.pending,icon:e.jsx(It,{}),onClick:()=>r("Pending")}),e.jsx(he,{title:"Ongoing",value:t.ongoing,icon:e.jsx(Lt,{className:"animate-spin"}),onClick:()=>r("Ongoing")}),e.jsx(he,{title:"Completed",value:t.completed,icon:e.jsx(Ft,{}),onClick:()=>r("Completed")}),e.jsx(he,{title:"Ended",value:t.ended,icon:e.jsx(zt,{}),onClick:()=>r("Ended")}),e.jsx(he,{title:"Cancelled",value:t.cancelled,icon:e.jsx(rt,{}),onClick:()=>r("Cancelled")})]})}function he({title:t,value:r,icon:s,onClick:l}){return e.jsxs("div",{onClick:l,className:`p-5 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-600 to-violet-600 \r
      cursor-pointer hover:opacity-90 active:scale-95 transition flex items-center justify-between`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold opacity-90",children:t}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:r??0})]}),e.jsx("div",{className:"text-3xl opacity-90",children:s})]})}function fa({onSearch:t}){const[r,s]=a.useState(""),l=n=>{const i=n.target.value;s(i),t(i)};return e.jsx("div",{className:"w-full mb-4",children:e.jsxs("div",{className:"flex items-center bg-white p-3 rounded-xl shadow border border-gray-200",children:[e.jsx(ue,{className:"text-gray-400 mr-3",size:20}),e.jsx("input",{type:"text",placeholder:"Search trips by From, To, Customer, Vehicle, Driver...",value:r,onChange:l,className:"w-full bg-transparent outline-none text-sm"})]})})}function ba({trips:t=[],loading:r,error:s,onSelectTrip:l,onSelectDriver:n,onSelectVehicle:i,onSelectCustomer:p,onStartTrip:u,onEndTrip:m}){return e.jsx("div",{className:"bg-white rounded-xl shadow p-4",children:r?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading Trips..."}):s?e.jsx("div",{className:"text-center py-12 text-red-500",children:s}):t.length===0?e.jsx("div",{className:"text-center py-12 text-gray-600",children:"No trips found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:e.jsxs("table",{className:"min-w-full table-auto border-collapse",children:[e.jsx("thead",{className:"bg-white sticky top-0 z-10 text-left text-sm text-gray-600 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"ID"}),e.jsx("th",{className:"px-4 py-3",children:"From"}),e.jsx("th",{className:"px-4 py-3",children:"To"}),e.jsx("th",{className:"px-4 py-3",children:"Customer"}),e.jsx("th",{className:"px-4 py-3",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3",children:"Driver"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Payment"}),e.jsx("th",{className:"px-4 py-3",children:"Leaving"}),e.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(c=>{var g,x,k;return e.jsxs("tr",{className:"hover:bg-gray-50 transition cursor-pointer",children:[e.jsx("td",{className:"px-4 py-4 text-blue-600 hover:underline",onClick:()=>l(c),children:c.trip_id}),e.jsx("td",{className:"px-4 py-4",children:c.from_location}),e.jsx("td",{className:"px-4 py-4",children:c.to_location}),e.jsx("td",{className:"px-4 py-4 text-blue-600 hover:underline cursor-pointer",onClick:()=>p(c),children:(g=c.customer)==null?void 0:g.name}),e.jsx("td",{className:"px-4 py-4 text-blue-600 hover:underline cursor-pointer",onClick:()=>i(c),children:(x=c.vehicle)==null?void 0:x.name}),e.jsx("td",{className:"px-4 py-4 text-blue-600 hover:underline cursor-pointer",onClick:()=>n(c),children:((k=c.driver)==null?void 0:k.name)||"N/A"}),e.jsx("td",{className:"px-4 py-4",children:c.trip_status}),e.jsx("td",{className:"px-4 py-4",children:c.payment_status}),e.jsx("td",{className:"px-4 py-4",children:new Date(c.leaving_datetime).toLocaleString()}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[c.trip_status==="Pending"&&e.jsx("button",{onClick:h=>{h.stopPropagation(),u(c.trip_id)},className:"bg-gradient-to-r from-indigo-500 to-violet-500 text-white px-3 py-1 rounded",children:"Start"}),c.trip_status==="Ongoing"&&e.jsx("button",{onClick:h=>{var A;h.stopPropagation(),m(c.trip_id,(A=c.vehicle)==null?void 0:A.meter_number)},className:"bg-gradient-to-r from-indigo-500 to-violet-500 text-white px-3 py-1 rounded",children:"End"})]})})]},c.trip_id)})})]})})})})}function ja(){const{name:t,role:r}=V(),s=q(),[l,n]=a.useState([]),[i,p]=a.useState([]),[u,m]=a.useState(!0),[c,g]=a.useState(null),[x,k]=a.useState(""),[h,A]=a.useState("Pending"),[o,b]=a.useState(new Date().getMonth()+1),[j,S]=a.useState(new Date().getFullYear()),[D,w]=a.useState([]),[C,v]=a.useState(!1),[E,N]=a.useState(!1),[f,T]=a.useState(null),[d,_]=a.useState(null),[y,P]=a.useState(null),[$,U]=a.useState(""),[F,M]=a.useState(""),R=async()=>{var L,O;m(!0);try{const X=`${j}-${o.toString().padStart(2,"0")}-01`,ae=`${j}-${o.toString().padStart(2,"0")}-31`;let de=`?start_date=${X}&end_date=${ae}`;const ce=await z.get(`/api/trips${de}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),me=Array.isArray(ce.data.data)?ce.data.data:[];n(me),w(me),I(me),p(me)}catch(X){console.error(X),g(((O=(L=X.response)==null?void 0:L.data)==null?void 0:O.message)||"Failed to fetch trips.")}finally{m(!1)}},I=L=>{let O=L;if(h&&(O=O.filter(X=>X.trip_status===h)),x){const X=x.toLowerCase();O=O.filter(ae=>ae.from_location.toLowerCase().includes(X)||ae.to_location.toLowerCase().includes(X)||ae.customer.name.toLowerCase().includes(X)||ae.driver.name.toLowerCase().includes(X))}n(O),p(O)};a.useEffect(()=>{I(D),R()},[h,o,j]),a.useEffect(()=>{const L=l.filter(O=>{var ae,de,ce,me,Pe,$e;const X=x.toLowerCase();return((ae=O.from_location)==null?void 0:ae.toLowerCase().includes(X))||((de=O.to_location)==null?void 0:de.toLowerCase().includes(X))||((me=(ce=O.customer)==null?void 0:ce.name)==null?void 0:me.toLowerCase().includes(X))||(($e=(Pe=O.driver)==null?void 0:Pe.name)==null?void 0:$e.toLowerCase().includes(X))});p(L)},[x,l]);const B={total:D.length,pending:D.filter(L=>L.trip_status==="Pending").length,ongoing:D.filter(L=>L.trip_status==="Ongoing").length,ended:D.filter(L=>L.trip_status==="Ended").length,completed:D.filter(L=>L.trip_status==="Completed").length,cancelled:D.filter(L=>L.trip_status==="Cancelled").length},H=L=>{T(L),_(null),v(!0)},Y=async()=>{if(!f||d===null||isNaN(d)){alert("Enter valid start meter");return}await z.patch(`/api/trips/${f}/start`,{start_meter:d},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),v(!1),R(),U("Trip started!"),setTimeout(()=>U(""),3e3)},J=(L,O)=>{T(L),P(O||null),N(!0)},Q=async()=>{if(!f||y===null||isNaN(y)){alert("Enter valid end meter");return}await z.patch(`/api/trips/${f}/end`,{end_meter:y},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),N(!1),R(),U("Trip Ended!"),setTimeout(()=>U(""),3e3)};return e.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-gray-50",children:[e.jsx(re,{}),e.jsx("main",{className:"flex-1 overflow-auto p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Trip Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage Trips and all Trip-related data"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:t})," — ",r,F&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 text-center",children:["❌ ",F]}),$&&e.jsxs("div",{className:"bg-green-200 border border-green-400 font-semibold text-green-700 px-4 py-3 rounded mb-4 text-center",children:["✅ ",$]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-6 items-stretch",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(ga,{stats:B,onStatusSelect:L=>A(L)})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(pa,{onAddTripClick:()=>s("/create-trip")})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-6 items-center",children:[e.jsx(fa,{onSearch:k}),e.jsx("label",{children:"Month:"}),e.jsx("select",{value:o,onChange:L=>b(Number(L.target.value)),className:"w-30 border rounded-xl px-3 py-2 items-center border-gray-300",children:[...Array(12)].map((L,O)=>e.jsx("option",{value:O+1,className:"rounded-xl bg-gray-100 text-gray-800",children:new Date(0,O).toLocaleString("default",{month:"long"})},O+1))}),e.jsx("label",{children:"Year:"}),e.jsx("input",{type:"number",value:j,onChange:L=>S(Number(L.target.value)),className:"w-25 border rounded-xl px-3 py-2 items-center w-24 border-gray-300"})]}),e.jsx("div",{className:"mt-8",children:e.jsx(ba,{trips:i,loading:u,error:c,onSelectTrip:L=>s(`/trip/${L.trip_id}`),onSelectDriver:L=>{var O,X;(O=L.driver)!=null&&O.driver_id&&s(`/driver-profile/${(X=L.driver)==null?void 0:X.driver_id}`)},onSelectVehicle:L=>{var O;return s(`/vehicles/${(O=L.vehicle)==null?void 0:O.vehicle_id}`)},onSelectCustomer:L=>{var O;return s(`/customer-profile/${(O=L.customer)==null?void 0:O.customer_id}`)},onStartTrip:H,onEndTrip:J})})]})}),C&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center backdrop-blur-sm bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-xl w-80",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Start Trip"}),e.jsx("input",{type:"number",placeholder:"Enter start meter",className:"border rounded px-3 py-2 w-full mb-4 border-gray-300",value:d??"",onChange:L=>_(Number(L.target.value))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 bg-gray-300 hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{onClick:Y,className:"px-4 py-2 bg-green-600 text-white hover:bg-green-700",children:"Confirm"})]})]})}),E&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center backdrop-blur-sm bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-xl w-80",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"End Trip"}),e.jsx("input",{type:"number",placeholder:"Enter end meter",className:"border rounded px-3 py-2 w-full mb-4 border-gray-300",value:y??"",onChange:L=>P(Number(L.target.value))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{onClick:Q,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Confirm"})]})]})})]})}const va=({driver:t,openImage:r,refreshDriver:s})=>{const l=q(),[n,i]=a.useState(!1),p=[{label:"Driver",src:t.image},{label:"License",src:t.license_image}];return e.jsxs("div",{className:"relative w-72 bg-gradient-to-r from-indigo-600 to-violet-700 shadow-lg rounded-xl p-4 flex flex-col items-center gap-4 overflow-y-auto sticky top-0 h-screen",children:[n&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center",children:e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-2xl w-[40%] max-w-lg relative max-h-[110vh] -mt-4",children:e.jsx(De,{driver:t,onCancel:()=>i(!1),onUpdated:()=>{i(!1),s()}})})}),e.jsx("button",{onClick:()=>l(-1),className:"absolute top-4 left-4 p-3 bg-gradient-to-r from-indigo-600 to-violet-700 text-white rounded-full shadow hover:bg-gray-600",children:e.jsx(Ae,{size:20})}),e.jsx("img",{src:t.image||"/default-driver.png",alt:t.name,className:"w-32 h-32 rounded-full border-2 border-gray-100 object-cover shadow-md mt-8"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("h2",{className:"text-xl font-bold text-white text-center",children:t.name}),e.jsx("button",{onClick:()=>i(!0),className:"text-white hover:text-yellow-300 transition",children:e.jsx(xe,{size:18})})]}),e.jsx("div",{className:"text-sm text-white space-y-1 w-full mt-2",children:[["Phone",t.phone_number],["NIC",t.nic],["Charges",`Rs. ${t.driver_charges||"0"}`],["License No",t.license_number],["License Expiry",t.license_expiry_date?t.license_expiry_date.split("T")[0]:"-"]].map(([u,m])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-semibold w-36",children:[u,":"]}),e.jsx("span",{children:m||"-"})]},u))}),e.jsxs("div",{className:"w-full mt-4",children:[e.jsx("h3",{className:"text-sm font-bold text-white mb-2 text-center",children:"Documents"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:p.filter(u=>u.src).map(u=>e.jsxs("div",{className:"flex flex-col text-white items-center border rounded-sm overflow-hidden shadow hover:shadow-md cursor-pointer p-1",onClick:()=>r(u.src),children:[e.jsx("img",{src:u.src,alt:u.label,className:"w-20 h-20 object-cover rounded"}),e.jsx("span",{className:"text-xs font-semibold mt-1",children:u.label})]},u.label))})]})]})},ya=({trips:t})=>{const[r,s]=a.useState([]),[l,n]=a.useState("all"),[i,p]=a.useState("all"),[u,m]=a.useState("all"),[c,g]=a.useState(0),x=q(),k=["all",...Array.from(new Set(t.map(o=>te(o.created_at).format("YYYY")))).sort((o,b)=>b-o)],h=["all",...Array.from({length:12},(o,b)=>String(b+1).padStart(2,"0"))],A=["all","Pending","Ongoing","Completed","Cancelled","Ended"];return a.useEffect(()=>{let o=[...t];l!=="all"&&(o=o.filter(j=>te(j.created_at).format("YYYY")===l)),i!=="all"&&(o=o.filter(j=>te(j.created_at).format("MM")===i)),u!=="all"&&(o=o.filter(j=>j.trip_status===u)),s(o);const b=o.reduce((j,S)=>S.trip_status==="Completed"?j+Number(S.driver_cost||S.payment_amount||S.total_actual_cost||0):j,0);g(b)},[t,l,i,u]),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-500 to-violet-600",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Total Trips"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:r.length})]}),e.jsxs("div",{className:"p-4 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-500 to-violet-600",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Total Earnings"}),e.jsxs("div",{className:"text-xl font-bold mt-1",children:["Rs. ",c.toLocaleString()]}),e.jsx("div",{className:"text-sm opacity-90 mt-1",children:"Completed Trips Only"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 font-semibold",children:"Year:"}),e.jsx("select",{className:"border p-2 rounded",value:l,onChange:o=>n(o.target.value),children:k.map(o=>e.jsx("option",{value:o,children:o==="all"?"All Years":o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 font-semibold",children:"Month:"}),e.jsx("select",{className:"border p-2 rounded",value:i,onChange:o=>p(o.target.value),children:h.map(o=>e.jsx("option",{value:o,children:o==="all"?"All Months":te(`2025-${o}-01`).format("MMMM")},o))})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("strong",{children:"Status: "}),A.map(o=>e.jsx("button",{className:`px-3 py-1 rounded-full text-sm font-semibold transition ${u===o?"bg-gradient-to-r from-indigo-500 to-violet-600 text-white shadow-md":"bg-gray-200 text-gray-800 hover:bg-purple-400 hover:text-white"}`,onClick:()=>m(o),children:o==="all"?"All":o},o))]}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-md rounded-xl p-4",children:r.length===0?e.jsx("p",{className:"p-4 text-center text-gray-500",children:"No trips found."}):e.jsxs("table",{className:"w-full table-auto border-collapse text-sm text-center",children:[e.jsx("thead",{className:"bg-white border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2",children:"Trip ID"}),e.jsx("th",{className:"p-2",children:"From"}),e.jsx("th",{className:"p-2",children:"To"}),e.jsx("th",{className:"p-2",children:"Passengers"}),e.jsx("th",{className:"p-2",children:"Payment"}),e.jsx("th",{className:"p-2",children:"Driver Cost"}),e.jsx("th",{className:"p-2",children:"Status"}),e.jsx("th",{className:"p-2",children:"Created"})]})}),e.jsx("tbody",{children:r.map(o=>e.jsxs("tr",{className:"text-left hover:bg-gray-50 transition",children:[e.jsx("td",{className:"p-1 cursor-pointer",onClick:()=>x(`/trip/${o.trip_id}`),children:o.trip_id}),e.jsx("td",{className:"p-1",children:o.from_location}),e.jsx("td",{className:"p-1",children:o.to_location}),e.jsx("td",{className:"p-1",children:o.num_passengers}),e.jsx("td",{className:"p-1",children:o.payment_amount||"-"}),e.jsx("td",{className:"p-1",children:o.driver_cost||"0"}),e.jsx("td",{className:"p-1",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${o.trip_status==="Completed"?"bg-green-200 text-green-800":o.trip_status==="Pending"?"bg-yellow-200 text-yellow-800":o.trip_status==="Cancelled"?"bg-red-200 text-red-800":"bg-blue-200 text-blue-800"}`,children:o.trip_status})}),e.jsx("td",{className:"p-1",children:te(o.created_at).format("YYYY-MM-DD")})]},o.trip_id))})]})})]})},Na=()=>{const{driverId:t}=fe(),[r,s]=a.useState(null),[l,n]=a.useState(!0),[i,p]=a.useState(null),[u,m]=a.useState(null);a.useEffect(()=>{c()},[t]);const c=async()=>{n(!0),p(null);try{const g=await z.get(`/api/drivers/${t}`);s(g.data.data)}catch{p("Failed to fetch driver details.")}finally{n(!1)}};return l?e.jsx("p",{className:"p-6",children:"Loading driver..."}):i?e.jsx("p",{className:"p-6 text-red-500",children:i}):r?e.jsxs("div",{className:"flex gap-6 p-4",children:[e.jsx(va,{driver:r,openImage:m,refreshDriver:c}),e.jsx(ya,{trips:r.trips||[]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",onClick:()=>m(null),children:e.jsx("img",{src:u,alt:"Zoom",className:"max-w-[90%] max-h-[90%] rounded-lg shadow-xl"})})]}):e.jsx("p",{className:"p-6",children:"No driver found."})},wa=({vehicle:t,openImage:r,refreshVehicle:s})=>{var u,m,c,g,x,k,h,A,o,b;const l=[{label:"Vehicle",src:t.image},{label:"License",src:t.license_image},{label:"Insurance",src:t.insurance_card_image},{label:"Eco Test",src:t.eco_test_image},{label:"Book",src:t.book_image}],[n,i]=a.useState(!1),p=q();return e.jsxs("div",{className:"relative w-72 bg-gradient-to-r from-indigo-600 to-violet-700 shadow-lg rounded-xl p-4 flex flex-col items-center gap-4 overflow-y-auto sticky top-0 h-screen",children:[n&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center",children:e.jsx(Ee,{vehicle:t,onCancel:()=>i(!1),onSuccess:()=>{i(!1),s()}})}),e.jsx("button",{onClick:()=>p(-1),className:"absolute top-4 left-4 p-3 bg-gradient-to-r from-indigo-600 to-violet-700 text-white rounded-full shadow hover:bg-gray-600",children:e.jsx(Ae,{size:20})}),e.jsx("img",{src:t.image,alt:t.name,className:"w-32 h-32 rounded-full border-2 border-gray-100 object-cover shadow-md mt-8"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t.name}),e.jsx("button",{onClick:()=>i(!0),className:"text-white hover:text-yellow-300",children:e.jsx(xe,{size:18})})]}),e.jsx("div",{className:"text-sm text-white space-y-1 w-full",children:[["Number",t.vehicle_number],["Type",t.type],["Daily Rent",`Rs. ${t.rent_cost_daily}`],["AC",t.ac_type],["Owner Cost/Month",`Rs. ${t.owner_cost_monthly}`],["Fuel",`${(u=t.fuel)==null?void 0:u.type}`],["Fuel Cost",`Rs. ${(m=t.fuel)==null?void 0:m.cost}`],["Efficiency",`${t.vehicle_fuel_efficiency} km/L`],["Meter",`${t.meter_number} km`],["Last Service",`${t.last_service_meter_number} km`],["Availability",t.vehicle_availability],["Owner",(c=t.owner)==null?void 0:c.owner_name],["Mileage Cost",`Rs. ${(x=(g=t.mileage_costs)==null?void 0:g[0])==null?void 0:x.mileage_cost}`],["Additional Mileage",`Rs. ${(h=(k=t.mileage_costs)==null?void 0:k[0])==null?void 0:h.mileage_cost_additional}`],["License Expiry",(A=t.license_expiry_date)==null?void 0:A.split("T")[0]],["Insurance Expiry",(o=t.insurance_expiry_date)==null?void 0:o.split("T")[0]],["ECO Test Expiry",(b=t.eco_test_expiry_date)==null?void 0:b.split("T")[0]]].map(([j,S])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-semibold w-40",children:[j,":"]}),e.jsx("span",{children:S||"-"})]},j))}),e.jsxs("div",{className:"w-full mt-4",children:[e.jsx("h3",{className:"text-sm font-bold text-white mb-2 text-center",children:"Documents"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:l.filter(j=>j.src).map(j=>e.jsxs("div",{className:"flex flex-col text-white items-center border rounded-sm overflow-hidden shadow hover:shadow-md cursor-pointer p-1",onClick:()=>r(j.src),children:[e.jsx("img",{src:j.src,alt:j.label,className:"w-14 h-14 object-cover rounded"}),e.jsx("span",{className:"text-xs font-semibold mt-1",children:j.label})]},j.label))})]})]})},_a=({trips:t,totalEarning:r,filterStatus:s,setFilterStatus:l,tripDateFilterType:n,setTripDateFilterType:i,tripSelectedMonth:p,setTripSelectedMonth:u,tripSelectedYear:m,setTripSelectedYear:c})=>{const g=["all","Pending","Ongoing","Ended","Completed","Cancelled"],x=q(),k=s==="all"?t.length:t.filter(h=>h.trip_status===s).length;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-500 to-violet-600",children:[e.jsx("div",{className:"text-md font-semibold opacity-100",children:"Total Trips"}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:k})]}),e.jsxs("div",{className:"p-4 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-500 to-violet-600",children:[e.jsx("div",{className:"text-md font-semibold opacity-100",children:"Total Earnings"}),e.jsxs("div",{className:"text-xl font-bold mt-2",children:["Rs. ",r.toLocaleString()]}),e.jsx("div",{className:"text-sm opacity-90 mt-1",children:"Completed Trips Only"})]})]}),e.jsxs("div",{className:"flex gap-2 items-center mb-4",children:[e.jsx("label",{className:"text-sm font-semibold",children:"Filter Trips by:"}),e.jsxs("select",{value:n,onChange:h=>{i(h.target.value),u(""),c("")},className:"border px-2 py-1 rounded",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"year",children:"Year"})]}),n==="month"&&e.jsx("input",{type:"month",value:p,onChange:h=>u(h.target.value),className:"border px-2 py-1 rounded"}),n==="year"&&e.jsx("input",{type:"number",placeholder:"YYYY",value:m,onChange:h=>c(h.target.value),className:"border px-2 py-1 rounded w-20"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:g.map(h=>e.jsx("button",{className:`px-3 py-1 rounded-full text-sm font-semibold transition ${s===h?"bg-gradient-to-r from-indigo-500 to-violet-600 text-white shadow-md":"bg-gray-200 text-gray-800 hover:bg-purple-400 hover:text-white"}`,onClick:()=>l(h),children:h},h))}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-md rounded-xl p-4",children:t.length?e.jsxs("table",{className:"w-full table-auto border-collapse text-sm",children:[e.jsx("thead",{className:"bg-white border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-left",children:"Trip ID"}),e.jsx("th",{className:"p-2 text-left",children:"Customer"}),e.jsx("th",{className:"p-2 text-left",children:"Driver"}),e.jsx("th",{className:"p-2 text-left",children:"From"}),e.jsx("th",{className:"p-2 text-left",children:"To"}),e.jsx("th",{className:"p-2 text-left",children:"Passengers"}),e.jsx("th",{className:"p-2 text-left",children:"Payment"}),e.jsx("th",{className:"p-2 text-left",children:"Driver Cost"}),e.jsx("th",{className:"p-2 text-left",children:"Mileage"}),e.jsx("th",{className:"p-2 text-left",children:"Additional Mileage"}),e.jsx("th",{className:"p-2 text-left",children:"Status"}),e.jsx("th",{className:"p-2 text-left",children:"Created At"})]})}),e.jsx("tbody",{children:t.map(h=>e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"p-1 cursor-pointer",onClick:()=>x(`/trip/${h.trip_id}`),children:h.trip_id}),e.jsx("td",{className:"p-1",children:h.customer_id}),e.jsx("td",{className:"p-1",children:h.driver_id||"-"}),e.jsx("td",{className:"p-1",children:h.from_location}),e.jsx("td",{className:"p-1",children:h.to_location}),e.jsx("td",{className:"p-1",children:h.num_passengers}),e.jsx("td",{className:"p-1",children:h.payment_amount||"-"}),e.jsx("td",{className:"p-1",children:h.driver_cost||"0"}),e.jsx("td",{className:"p-1",children:h.mileage_cost||"0"}),e.jsx("td",{className:"p-1",children:h.additional_mileage_cost||"0"}),e.jsx("td",{className:"p-1",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${h.trip_status==="Completed"?"bg-green-200 text-green-800":h.trip_status==="Pending"?"bg-yellow-200 text-yellow-800":h.trip_status==="Cancelled"?"bg-red-200 text-red-800":"bg-blue-200 text-blue-800"}`,children:h.trip_status})}),e.jsx("td",{className:"p-1",children:te(h.created_at).format("YYYY-MM-DD HH:mm")})]},h.trip_id))})]}):e.jsx("p",{className:"p-4 text-center text-gray-500",children:"No trips found."})})]})},Ca=({costs:t,costDateFilterType:r,setCostDateFilterType:s,costSelectedMonth:l,setCostSelectedMonth:n,costSelectedYear:i,setCostSelectedYear:p})=>{const u=t.reduce((m,c)=>m+Number(c.cost||0),0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 items-center mb-4",children:[e.jsx("label",{className:"text-sm font-semibold",children:"Filter Costs by:"}),e.jsxs("select",{value:r,onChange:m=>{s(m.target.value),n(""),p("")},className:"border px-2 py-1 rounded",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"year",children:"Year"})]}),r==="month"&&e.jsx("input",{type:"month",value:l,onChange:m=>n(m.target.value),className:"border px-2 py-1 rounded"}),r==="year"&&e.jsx("input",{type:"number",placeholder:"YYYY",value:i,onChange:m=>p(m.target.value),className:"border px-2 py-1 rounded w-20"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4",children:e.jsxs("div",{className:"p-4 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-500 to-violet-600",children:[e.jsx("div",{className:"text-sm font-semibold opacity-100",children:"Total Costs"}),e.jsxs("div",{className:"text-xl font-bold mt-2",children:["Rs. ",u.toLocaleString()]})]})}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-md rounded-md",children:t.length?e.jsxs("table",{className:"w-full table-auto border-collapse text-sm",children:[e.jsx("thead",{className:"bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-left",children:"Cost ID"}),e.jsx("th",{className:"p-2 text-left",children:"Date"}),e.jsx("th",{className:"p-2 text-left",children:"Cost Type"}),e.jsx("th",{className:"p-2 text-left",children:"Amount"})]})}),e.jsx("tbody",{children:t.map(m=>{var c;return e.jsxs("tr",{className:" hover:bg-gray-50 transition",children:[e.jsx("td",{className:"p-1",children:m.vehicle_other_cost_id}),e.jsx("td",{className:"p-1",children:(c=m.date)==null?void 0:c.split("T")[0]}),e.jsx("td",{className:"p-1",children:m.cost_type}),e.jsxs("td",{className:"p-1",children:["Rs. ",Number(m.cost).toLocaleString()]})]},m.vehicle_other_cost_id)})})]}):e.jsx("p",{className:"p-4 text-center text-gray-500",children:"No other costs found."})})]})},Sa={Lease_Cost:"Lease_Cost",Service_Cost:"Service_Cost",Repairs_Cost:"Repairs_Cost",Insurance_Amount:"Insurance_Amount",Revenue_License:"Revenue_License",Eco_Test_Cost:"Eco_Test_Cost",Fuel_Cost:"Fuel_Cost"},ka=({vehicleId:t,isOpen:r,onClose:s,onSuccess:l})=>{const[n,i]=a.useState(""),[p,u]=a.useState(""),[m,c]=a.useState(te().format("YYYY-MM-DD")),[g,x]=a.useState(!1),[k,h]=a.useState(null);if(!r)return null;const A=async o=>{var b;o.preventDefault(),x(!0),h(null);try{const j={vehicle_id:Number(t),date:new Date(m).toISOString(),cost:Number(p),cost_type:n};console.log("sending payload:",j),await z.post("/api/vehicle-other-costs",j),l(),s()}catch(j){console.error("ERR ADDING COST:",((b=j.response)==null?void 0:b.data)||j),h("Something went wrong. Please try again.")}finally{x(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-white/40 backdrop-blur-md flex justify-center items-center h-full overflow-auto z-50",children:e.jsxs("div",{className:"bg-white w-96 p-6 rounded-xl shadow-xl relative",children:[e.jsx("button",{onClick:s,className:"absolute top-3 right-3 text-gray-600 hover:text-black",children:"✕"}),e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Add Vehicle Other Cost"}),k&&e.jsx("p",{className:"text-red-500 text-sm",children:k}),e.jsxs("form",{onSubmit:A,className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cost Type"}),e.jsxs("select",{value:n,onChange:o=>i(o.target.value),className:"border px-2 py-2 rounded w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select cost type"}),Object.values(Sa).map(o=>e.jsx("option",{value:o,children:o.replace(/_/g," ")},o))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cost Amount"}),e.jsx("input",{type:"number",value:p,onChange:o=>u(o.target.value),className:"border px-2 py-2 rounded w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date"}),e.jsx("input",{type:"date",value:m,onChange:o=>c(o.target.value),className:"border px-2 py-2 rounded w-full",required:!0})]}),e.jsx("button",{type:"submit",disabled:g,className:"bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700 transition w-full",children:g?"Adding...":"Add Cost"})]})]})})},Aa=()=>{const{id:t}=fe(),[r,s]=a.useState(null),[l,n]=a.useState(!0),[i,p]=a.useState(null),[u,m]=a.useState("trips"),[c,g]=a.useState([]),[x,k]=a.useState(0),[h,A]=a.useState("all"),[o,b]=a.useState("all"),[j,S]=a.useState(""),[D,w]=a.useState(""),[C,v]=a.useState([]),[E,N]=a.useState("all"),[f,T]=a.useState(""),[d,_]=a.useState(""),[y,P]=a.useState(!1);a.useEffect(()=>{$()},[t]),a.useEffect(()=>{r&&(F(),M())},[r,h,o,j,D,E,f,d]);const $=async()=>{n(!0),p(null);try{const I=await z.get(`/api/vehicles/${t}`);s(I.data)}catch(I){console.error(I),p("Failed to fetch vehicle details.")}finally{n(!1)}},U=I=>{const B=I.filter(H=>H.trip_status==="Completed").reduce((H,Y)=>H+Number(Y.payment_amount||0),0);k(B)},F=()=>{if(!(r!=null&&r.trips))return;let I=[...r.trips];h!=="all"&&(I=I.filter(B=>B.trip_status===h)),o==="month"&&j&&(I=I.filter(B=>te(B.created_at).format("YYYY-MM")===j)),o==="year"&&D&&(I=I.filter(B=>te(B.created_at).format("YYYY")===D)),g(I),U(I)},M=()=>{if(!(r!=null&&r.vehicle_other_costs))return;let I=[...r.vehicle_other_costs];E==="month"&&f?I=I.filter(B=>B.date&&te(B.date).format("YYYY-MM")===f):E==="year"&&d&&(I=I.filter(B=>B.date&&te(B.date).year()===Number(d))),v(I)},R=I=>{if(!I)return;window.open().document.write(`<img src="${I}" style="width:100%" />`)};return l?e.jsx("p",{className:"p-6",children:"Loading vehicle..."}):i?e.jsx("p",{className:"p-6 text-red-500",children:i}):r?e.jsxs("div",{className:"flex h-screen p-6 gap-6",children:[e.jsx(wa,{vehicle:r,openImage:R,refreshVehicle:$}),e.jsxs("div",{className:"flex-1 space-y-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex gap-3 border-b pb-2",children:[e.jsx("button",{onClick:()=>m("trips"),className:`px-4 py-2 text-sm font-semibold rounded-t-lg ${u==="trips"?"bg-gradient-to-r from-indigo-500 to-violet-600 text-white shadow":"bg-gray-200 text-gray-800 hover:bg-purple-400 hover:text-white"}`,children:"Trips"}),e.jsx("button",{onClick:()=>m("costs"),className:`px-4 py-2 text-sm font-semibold rounded-t-lg ${u==="costs"?"bg-gradient-to-r from-indigo-500 to-violet-600 text-white shadow":"bg-gray-200 text-gray-800 hover:bg-purple-400 hover:text-white"}`,children:"Other Costs"})]}),u==="trips"&&e.jsx(_a,{trips:c,totalEarning:x,filterStatus:h,setFilterStatus:A,tripDateFilterType:o,setTripDateFilterType:b,tripSelectedMonth:j,setTripSelectedMonth:S,tripSelectedYear:D,setTripSelectedYear:w}),u==="costs"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow flex flex-col justify-between cursor-pointer hover:shadow-md transition w-80",onClick:()=>P(!0),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-50",children:e.jsx(Rt,{className:"text-blue-600",size:24})}),e.jsx("div",{className:"font-semibold",children:"Add New Other Cost"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Add a new cost entry for this vehicle."})]})}),e.jsx(ka,{vehicleId:r.vehicle_id,isOpen:y,onClose:()=>P(!1),onSuccess:$}),e.jsx(Ca,{costs:C,costDateFilterType:E,setCostDateFilterType:N,costSelectedMonth:f,setCostSelectedMonth:T,costSelectedYear:d,setCostSelectedYear:_})]})]})]}):e.jsx("p",{className:"p-6",children:"No vehicle found."})},Ta=({customer:t,openImage:r,refreshCustomer:s})=>{var p,u;const l=q(),[n,i]=a.useState(!1);return e.jsxs("div",{className:`relative w-72 bg-gradient-to-r from-indigo-600 to-violet-700 \r
        shadow-lg rounded-xl p-4 flex flex-col items-center gap-4 overflow-y-auto \r
        sticky top-0 h-screen`,children:[n&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center",children:e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-2xl w-[50%] max-w-lg relative max-h-[100vh] ",children:e.jsx(Te,{customer:t,onCancel:()=>i(!1),onSuccess:()=>{i(!1),s()},refresh:s})})}),e.jsx("button",{onClick:()=>l(-1),className:`absolute top-4 left-4 p-3 bg-gradient-to-r from-indigo-600 to-violet-700 \r
          text-white rounded-full shadow hover:bg-gray-600`,children:e.jsx(Ae,{size:20})}),e.jsx("div",{className:`mt-8 w-28 h-28 rounded-full border-2 border-white bg-gray-300 \r
        flex items-center justify-center text-gray-500 text-4xl font-bold shadow`,children:((u=(p=t.name)==null?void 0:p.charAt(0))==null?void 0:u.toUpperCase())||"?"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-xl font-bold text-white text-center",children:t.name}),e.jsx("button",{onClick:()=>i(!0),className:"text-white hover:text-yellow-300 transition",children:e.jsx(xe,{size:18})})]}),e.jsx("div",{className:"text-sm text-white space-y-1 w-full mt-2",children:[["Phone",t.phone_number],["NIC",t.nic],["Email",t.email]].map(([m,c])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-semibold w-28",children:[m,":"]}),e.jsx("span",{children:c||"-"})]},m))}),e.jsxs("div",{className:"flex gap-4 mt-6 justify-center w-full",children:[e.jsx("img",{src:t.nic_photo_front||"/nic-front-placeholder.png",alt:"NIC Front",onClick:()=>r(t.nic_photo_front),className:"w-32 h-20 rounded-lg object-cover border-2 border-white p-1 shadow cursor-pointer hover:scale-105 transition"}),e.jsx("img",{src:t.nic_photo_back||"/nic-back-placeholder.png",alt:"NIC Back",onClick:()=>r(t.nic_photo_back),className:"w-32 h-20 rounded-lg object-cover border-2 border-white p-1 shadow cursor-pointer hover:scale-105 transition"})]})]})},Da=({trips:t})=>{const[r,s]=a.useState([]),[l,n]=a.useState("all"),[i,p]=a.useState("all"),[u,m]=a.useState("all"),[c,g]=a.useState(0),x=q(),k=["all",...Array.from(new Set(t.map(o=>o.trip_status)))],h=["all",...Array.from(new Set(t.map(o=>te(o.created_at).format("YYYY")))).sort((o,b)=>b-o)],A=["all",...Array.from({length:12},(o,b)=>String(b+1).padStart(2,"0"))];return a.useEffect(()=>{let o=[...t];l!=="all"&&(o=o.filter(b=>te(b.created_at).format("YYYY")===l)),i!=="all"&&(o=o.filter(b=>te(b.created_at).format("MM")===i)),u!=="all"&&(o=o.filter(b=>b.trip_status===u)),s(o),g(o.reduce((b,j)=>b+Number(j.payment_amount||0),0))},[t,l,i,u]),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-500 to-violet-600",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Total Trips"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:r.length})]}),e.jsxs("div",{className:"p-4 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-500 to-violet-600",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Total Payment"}),e.jsxs("div",{className:"text-xl font-bold mt-1",children:["Rs. ",c.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 font-semibold",children:"Year:"}),e.jsx("select",{className:"border px-2 py-1 rounded",value:l,onChange:o=>n(o.target.value),children:h.map(o=>e.jsx("option",{value:o,children:o==="all"?"All Years":o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 font-semibold",children:"Month:"}),e.jsx("select",{className:"border px-2 py-1 rounded",value:i,onChange:o=>p(o.target.value),children:A.map(o=>e.jsx("option",{value:o,children:o==="all"?"All Months":te(`2025-${o}-01`).format("MMMM")},o))})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"mr-2 font-semibold",children:"Status:"}),e.jsx("div",{className:"flex gap-2",children:k.map(o=>e.jsx("button",{className:`px-3 py-1 rounded-full text-sm font-semibold transition ${u===o?"bg-gradient-to-r from-indigo-500 to-violet-600   text-white shadow-md":"bg-gray-200 text-gray-800 hover:bg-indigo-400 hover:text-white"}`,onClick:()=>m(o),children:o},o))})]}),e.jsx("div",{className:"overflow-x-auto bg-white shadow-md rounded-xl p-4",children:r.length===0?e.jsx("p",{className:"p-4 text-center text-gray-500",children:"No trips found."}):e.jsxs("table",{className:"w-full table-auto border-collapse text-sm",children:[e.jsx("thead",{className:"bg-white border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2",children:"Trip ID"}),e.jsx("th",{className:"p-2",children:"From"}),e.jsx("th",{className:"p-2",children:"To"}),e.jsx("th",{className:"p-2",children:"Passengers"}),e.jsx("th",{className:"p-2",children:"Payment"}),e.jsx("th",{className:"p-2",children:"Status"}),e.jsx("th",{className:"p-2",children:"Distance"}),e.jsx("th",{className:"p-2",children:"Days"}),e.jsx("th",{className:"p-2",children:"Driver"}),e.jsx("th",{className:"p-2",children:"Fuel"}),e.jsx("th",{className:"p-2",children:"Costs"}),e.jsx("th",{className:"p-2",children:"Created"}),e.jsx("th",{className:"p-2",children:"Route"})]})}),e.jsx("tbody",{children:r.map(o=>{var b,j,S;return e.jsxs("tr",{className:" text-left hover:bg-gray-50 transition text-center",children:[e.jsx("td",{className:"p-1 cursor-pointer",onClick:()=>x(`/trip/${o.trip_id}`),children:o.trip_id}),e.jsx("td",{className:"p-1",children:o.from_location}),e.jsx("td",{className:"p-1",children:o.to_location}),e.jsx("td",{className:"p-1",children:o.num_passengers}),e.jsxs("td",{className:"p-1",children:["Rs. ",o.payment_amount||"-"]}),e.jsx("td",{className:"p-1",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${o.trip_status==="Completed"?"bg-green-200 text-green-800":o.trip_status==="Pending"?"bg-yellow-200 text-yellow-800":o.trip_status==="Cancelled"?"bg-red-200 text-red-800":"bg-blue-200 text-blue-800"}`,children:o.trip_status})}),e.jsxs("td",{className:"p-1",children:["Est: ",o.estimated_distance||"-"," km ",e.jsx("br",{}),"Actual: ",o.actual_distance||"-"," km"]}),e.jsxs("td",{className:"p-1",children:["Est: ",o.estimated_days||"-"," ",e.jsx("br",{}),"Actual: ",o.actual_days||"-"]}),e.jsxs("td",{className:"p-1",children:[o.driver_required," (ID ",o.driver_id||"-",")"]}),e.jsx("td",{className:"p-1",children:o.fuel_required}),e.jsxs("td",{className:"p-1",children:["Est: Rs. ",((b=o.total_estimated_cost)==null?void 0:b.toLocaleString())||"-"," ",e.jsx("br",{}),"Actual: Rs. ",((j=o.total_actual_cost)==null?void 0:j.toLocaleString())||"-"]}),e.jsx("td",{className:"p-1",children:te(o.created_at).format("YYYY-MM-DD")}),e.jsx("td",{className:"p-1",children:((S=o.map)==null?void 0:S.length)>0?e.jsx("ol",{className:"list-decimal list-inside",children:o.map.map(D=>e.jsxs("li",{children:[D.location_name," (",D.latitude,", ",D.longitude,")"]},D.map_id))}):"-"})]},o.trip_id)})})]})})]})},Ea=()=>{const{customerId:t}=fe(),[r,s]=a.useState(null),[l,n]=a.useState(!0),[i,p]=a.useState(null),[u,m]=a.useState(null),c=async()=>{n(!0),p(null);try{const g=await z.get(`/api/customers/${t}`);s(g.data.data)}catch(g){console.error(g),p("Failed to fetch customer.")}finally{n(!1)}};return a.useEffect(()=>{c()},[t]),l?e.jsx("p",{className:"p-6 text-center",children:"Loading..."}):i?e.jsx("p",{className:"p-6 text-center text-red-500",children:i}):r?e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 p-4 sm:p-6",children:[e.jsx(Ta,{customer:r,openImage:m,refreshCustomer:c}),e.jsxs("div",{className:"flex-1",children:[u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",onClick:()=>m(null),children:e.jsx("img",{src:u,alt:"Zoomed",className:"max-w-[90%] max-h-[90%] rounded-lg shadow-xl"})}),e.jsx(Da,{trips:r.trips||[]})]})]}):e.jsx("p",{className:"p-6 text-center",children:"Customer not found."})};function Pa({stats:t,onClick:r}){const s=[{label:"Total Bills",value:t.total||0,filter:""},{label:"Pending Bills",value:t.pending||0,filter:"pending"},{label:"Completed Bills",value:t.completed||0,filter:"completed"},{label:"New This Month",value:t.newThisMonth||0,filter:"newThisMonth"}];return e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:s.map((l,n)=>e.jsxs("div",{onClick:()=>r(l.filter),className:"p-5 rounded-xl shadow-md text-white bg-gradient-to-r from-indigo-600 to-violet-600 cursor-pointer hover:scale-105 transform transition",children:[e.jsx("p",{className:"text-md font-semibold ",children:l.label}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:l.value})]},n))})}function $a({onAddBillClick:t}){return e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsxs("div",{className:"bg-white p-5 rounded-xl shadow flex flex-col justify-between h-full ml-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-50",children:e.jsx(oe,{onClick:t,className:"text-blue-600 cursor-pointer"})}),e.jsx("div",{className:"font-semibold",children:"Add New Bill"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Upload a new bill to the system."})]})})}function Ma({bills:t,onSelect:r,onUpdateCost:s,searchQuery:l="",statusFilter:n="",onSelectDriver:i,onSelectVehicle:p}){const u=t.filter(m=>{var k,h;const c=l.toLowerCase(),g=(m.bill_type||"").toLowerCase().includes(c)||(((k=m.vehicle_id)==null?void 0:k.toString())||"").includes(c)||(((h=m.driver_id)==null?void 0:h.toString())||"").includes(c);let x=!0;if(n==="pending")x=m.bill_status==="pending";else if(n==="completed")x=m.bill_status==="completed";else if(n==="newThisMonth"){const A=new Date(m.bill_date),o=new Date;x=A.getMonth()===o.getMonth()&&A.getFullYear()===o.getFullYear()}return g&&x});return e.jsx("div",{className:"bg-white rounded-xl shadow-md p-4 overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b text-gray-600",children:[e.jsx("th",{className:"p-2 text-left",children:"Bill ID"}),e.jsx("th",{className:"p-2 text-left",children:"Vehicle ID"}),e.jsx("th",{className:"p-2 text-left",children:"Driver ID"}),e.jsx("th",{className:"p-2 text-left",children:"Type"}),e.jsx("th",{className:"p-2 text-left",children:"Date"}),e.jsx("th",{className:"p-2 text-left",children:"Status"}),e.jsx("th",{className:"p-2 text-left",children:"Actions"})]})}),e.jsx("tbody",{children:u.map(m=>e.jsxs("tr",{className:"hover:bg-gray-100 cursor-pointer",onClick:()=>r&&r(m),children:[e.jsx("td",{className:"p-2",children:m.bill_id}),e.jsx("td",{className:"px-4 py-4 text-blue-600 hover:underline cursor-pointer",onClick:()=>p(m),children:m.vehicle_id}),e.jsx("td",{className:"px-4 py-4 text-blue-600 hover:underline cursor-pointer",onClick:()=>i(m),children:m.driver_id}),e.jsx("td",{className:"p-2 capitalize",children:m.bill_type}),e.jsx("td",{className:"p-2",children:new Date(m.bill_date).toLocaleDateString()}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${m.bill_status==="pending"?"bg-yellow-200 text-yellow-700":"bg-green-200 text-green-700"}`,children:m.bill_status})}),e.jsx("td",{className:"p-2",children:m.bill_status==="pending"&&e.jsx("button",{onClick:c=>{c.stopPropagation(),s(m)},className:"bg-gradient-to-r from-indigo-600 to-violet-600 text-white px-2 py-1 rounded cursor-pointer hover:bg-indigo-900 text-xs font-semibold",children:"Update Other Cost"})})]},m.bill_id))})]})})}const We=({onClose:t,onSuccess:r})=>{const s=q(),[l,n]=a.useState({vehicle_id:"",driver_id:"",bill_type:"",bill_date:"",bill_status:"pending",bill_image_base64:"",vehicle_other_cost_id:null}),[i,p]=a.useState([]),[u,m]=a.useState([]),[c,g]=a.useState(!1),[x,k]=a.useState(!0),[h,A]=a.useState(null),[o,b]=a.useState(!1),[j,S]=a.useState(!1),[D,w]=a.useState(""),C={Service_Cost:"Service_Cost",Repairs_Cost:"Repairs_Cost",Lease_Cost:"Lease_Cost",Insurance_Amount:"Insurance_Amount",Revenue_License:"Revenue_License",Eco_Test_Cost:"Eco_Test_Cost",Fuel_Cost:"Fuel_Cost"},v=Object.keys(C),E=["pending","completed"];a.useEffect(()=>{const d=localStorage.getItem("token");if(!d){A("Unauthorized! Please log in."),s("/login");return}(async()=>{var y,P;k(!0);try{const[$,U]=await Promise.all([Z.get("https://rashen.sceniccottage.com/api/vehicles",{headers:{Authorization:`Bearer ${d}`}}),Z.get("https://rashen.sceniccottage.com/api/drivers",{headers:{Authorization:`Bearer ${d}`}})]),F=Array.isArray((y=$.data)==null?void 0:y.data)?$.data.data:Array.isArray($.data)?$.data:[],M=Array.isArray((P=U.data)==null?void 0:P.data)?U.data.data:Array.isArray(U.data)?U.data:[];p(F),m(M)}catch($){console.error("Dropdown fetch error:",$.response||$),A("Failed to load vehicles or drivers.")}finally{k(!1)}})()},[s]);const N=d=>{const{name:_,value:y}=d.target;n(P=>({...P,[_]:y}))},f=d=>{const _=d.target.files[0];if(!_)return;const y=new FileReader;y.onloadend=()=>{w(y.result),n(P=>({...P,bill_image_base64:y.result.split(",")[1]}))},y.readAsDataURL(_)},T=async d=>{var _,y,P;if(d.preventDefault(),!!j){g(!0),A(null);try{const $=localStorage.getItem("token"),U=C[l.bill_type];if(!U)throw new Error("Invalid bill type selected.");const F={...l,vehicle_id:l.vehicle_id||null,driver_id:l.driver_id||null,bill_type:U,vehicle_other_cost_id:l.vehicle_other_cost_id||null},M=await Z.post("https://rashen.sceniccottage.com/api/bill-uploads",F,{headers:{Authorization:`Bearer ${$}`,"Content-Type":"application/json"}}),R=((_=M.data)==null?void 0:_.data)||M.data;b(!0),r(R),setTimeout(()=>t(),1500)}catch($){console.error($),A(((P=(y=$.response)==null?void 0:y.data)==null?void 0:P.message)||$.message||"Failed to upload bill.")}finally{g(!1),S(!1)}}};return e.jsx("div",{className:"flex justify-center items-center w-100 min-h-screen bg-grey-100",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full h-full max-w-4xl mt-12 relative",children:[e.jsx("button",{onClick:t,className:"absolute top-4 left-4 p-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-full shadow",children:e.jsx(le,{size:18})}),e.jsxs("h2",{className:"text-xl font-semibold mb-6 text-center flex items-center justify-center gap-2",children:[e.jsx(Xe,{})," Add New Bill"]}),h&&e.jsxs("div",{className:"bg-red-100 text-red-700 border border-red-400 px-4 py-3 rounded mb-4 text-center",children:["❌ ",h]}),o&&e.jsx("div",{className:"bg-green-100 text-green-700 border border-green-400 px-4 py-3 rounded mb-4 text-center",children:"✅ Bill uploaded successfully!"}),x?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading vehicles and drivers..."}):e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle"}),e.jsxs("select",{name:"vehicle_id",value:l.vehicle_id,onChange:N,className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select Vehicle"}),i.map(d=>e.jsxs("option",{value:d.vehicle_id,children:[d.vehicle_number," - ",d.name]},d.vehicle_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Driver"}),e.jsxs("select",{name:"driver_id",value:l.driver_id,onChange:N,className:"input",children:[e.jsx("option",{value:"",children:"Select Driver"}),u.map(d=>e.jsxs("option",{value:d.driver_id,children:[d.name," (",d.nic,")"]},d.driver_id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bill Type"}),e.jsxs("select",{name:"bill_type",value:l.bill_type,onChange:N,className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select Bill Type"}),v.map(d=>e.jsx("option",{value:d,children:d.replace("_"," ")},d))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bill Date"}),e.jsx("input",{type:"date",name:"bill_date",value:l.bill_date,onChange:N,className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("select",{name:"bill_status",value:l.bill_status,onChange:N,className:"input",children:E.map(d=>e.jsx("option",{value:d,children:d.toUpperCase()},d))})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("label",{className:"label mb-2",children:"Bill Image"}),e.jsxs("div",{className:"relative w-48 h-48 border-2 border-dashed rounded-xl bg-gray-50 hover:bg-green-50 transition flex items-center justify-center overflow-hidden",children:[D?e.jsx("img",{src:D,className:"w-full h-full object-cover rounded-xl"}):e.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[e.jsx(ke,{className:"text-3xl mb-2"}),e.jsx("p",{children:"Upload Bill"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"absolute inset-0 opacity-0 cursor-pointer"})]})]}),e.jsx(G,{onConfirm:()=>S(!0),onCancel:()=>S(!1),message:"Confirm Bill Upload",additionalInfo:"Please check the bill details before submitting.",confirmText:"Yes, Upload Bill",cancelText:"No, Go Back",icon:e.jsx(Xe,{}),buttonBackgroundColor:"bg-green-600",buttonTextColor:"text-white",children:e.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-indigo-600 to-violet-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition",disabled:c,children:c?"Uploading...":"Upload Bill"})})]})]})})};function Ia({onSearch:t}){const[r,s]=a.useState(""),l=n=>{const i=n.target.value;s(i),t(i)};return e.jsx("div",{className:"w-full mb-4",children:e.jsxs("div",{className:"flex items-center bg-white p-3 rounded-lg shadow",children:[e.jsx(ue,{className:"text-gray-400 mr-3",size:18}),e.jsx("input",{type:"text",placeholder:"Search by vehicle ID, driver ID, or bill type...",value:r,onChange:l,className:"w-full outline-none text-sm"})]})})}const La=({bill:t,onClose:r,onSuccess:s})=>{const l=["Lease_Cost","Service_Cost","Repairs_Cost","Insurance_Amount","Revenue_License","Eco_Test_Cost","Fuel_Cost"],[n,i]=a.useState(""),[p,u]=a.useState(t.bill_type||"Lease_Cost"),[m,c]=a.useState(!1),[g,x]=a.useState(null),[k,h]=a.useState(!1);a.useEffect(()=>{u(t.bill_type||"Lease_Cost")},[t]);const A=async o=>{var b,j;o.preventDefault(),c(!0),x(null);try{const S=localStorage.getItem("token");await Z.post("https://rashen.sceniccottage.com/api/vehicle-other-costs",{vehicle_id:t.vehicle_id,date:t.bill_date,cost:Number(n),cost_type:p,bill_id:t.bill_id},{headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json"}}),s(),r()}catch(S){x(((j=(b=S.response)==null?void 0:b.data)==null?void 0:j.message)||"Failed to update cost.")}finally{c(!1)}};return e.jsxs("div",{className:"flex justify-center items-center w-100 min-h-screen bg-grey-100",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full h-full max-w-md mt-12 relative",children:[e.jsx("button",{onClick:r,className:"absolute top-4 left-4 p-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-full shadow",children:e.jsx(le,{size:18})}),e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2 justify-center",children:[e.jsx(Qe,{})," Update Other Cost"]}),e.jsxs("div",{className:"mb-4 flex flex-col items-center",children:[t.bill_image&&e.jsx("img",{src:t.bill_image,alt:"Bill",className:"w-45 h-55 object-cover rounded-lg mb-5 border border-gray-300",onClick:()=>h(!0),onError:o=>{o.target.src="/placeholder.png"}}),e.jsx("div",{className:" space-y-2 items-center",children:[["Bill Type",t.bill_type.replace("_"," ")],["Bill Date",new Date(t.bill_date).toLocaleDateString()],["Status",t.bill_status],["Vehicle",`${t.vehicle_name} (ID: ${t.vehicle_id})`],["Driver",`${t.driver_name} (ID: ${t.driver_id})`]].map(([o,b])=>e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("span",{className:"font-semibold",children:[o,":"]}),e.jsx("span",{className:"col-span-2 text-right",children:b})]},o))})]}),g&&e.jsx("div",{className:"bg-red-100 text-red-700 px-3 py-2 rounded mb-2",children:g}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cost"}),e.jsx("input",{type:"number",value:n,onChange:o=>i(o.target.value),className:"input w-full border border-gray-300 rounded px-2 py-1",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cost Type"}),e.jsx("select",{value:p,onChange:o=>u(o.target.value),className:"input w-full border border-gray-300 rounded px-2 py-1",children:l.map(o=>e.jsx("option",{value:o,children:o.replace("_"," ")},o))})]}),e.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-indigo-600 to-violet-600 text-white py-2 rounded hover:bg-indigo-700",disabled:m,children:m?"Updating...":"Update Cost"})]})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-white/40 backdrop-blur-sm flex justify-center items-center z-50",onClick:()=>h(!1),children:e.jsx("img",{src:t.bill_image,className:"max-w-4xl max-h-[90vh] rounded-xl shadow-2xl",onClick:o=>o.stopPropagation()})})]})};function Fa(){const{name:t,role:r}=V(),[s,l]=a.useState([]),[n,i]=a.useState(!0),[p,u]=a.useState(null),[m,c]=a.useState(!1),[g,x]=a.useState(!1),[k,h]=a.useState(!1),[A,o]=a.useState(!1),[b,j]=a.useState(null),[S,D]=a.useState(""),[w,C]=a.useState(""),[v,E]=a.useState(null),[N,f]=a.useState(""),T=q(),d=M=>{f(M)};a.useEffect(()=>{(async()=>{var R,I;try{i(!0);const B=await z.get("/api/bill-uploads",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});l(B.data.data||[])}catch(B){console.error(B),E(((I=(R=B.response)==null?void 0:R.data)==null?void 0:I.message)||"Failed to fetch bills")}finally{i(!1)}})()},[]);const _={total:s.length,pending:s.filter(M=>M.bill_status==="pending").length,completed:s.filter(M=>M.bill_status==="completed").length,newThisMonth:s.filter(M=>{const R=new Date(M.bill_date),I=new Date;return R.getMonth()===I.getMonth()&&R.getFullYear()===I.getFullYear()}).length},y=s.filter(M=>{var I,B;const R=S.toLowerCase();return(M.bill_type||"").toLowerCase().includes(R)||(((I=M.vehicle_id)==null?void 0:I.toString())||"").includes(R)||(((B=M.driver_id)==null?void 0:B.toString())||"").includes(R)}),P=M=>{u(M),c(!1),x(!1),h(!0)},$=M=>{l(R=>R.map(I=>I.bill_id===M.bill_id?M:I)),u(M),x(!1),C("Bill updated successfully!"),setTimeout(()=>C(""),3e3)},U=M=>{j(M),o(!0),c(!1)},F=()=>{o(!1),C("Vehicle Other Cost updated successfully!"),setTimeout(()=>C(""),3e3),(async()=>{try{const R=await z.get("/api/bill-uploads",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});l(R.data.data||[])}catch(R){console.error(R)}})()};return e.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-gray-50",children:[e.jsx(re,{}),e.jsx("main",{className:"flex-1 overflow-auto p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Bill Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage all uploaded bills"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:t})," — ",r]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-1 mt-6 items-stretch",children:[e.jsx("div",{className:"lg:col-span-3 h-full",children:e.jsx(Pa,{stats:_,onClick:d})}),e.jsx("div",{className:"lg:col-span-1 h-full flex flex-col",children:e.jsx($a,{onAddBillClick:()=>{c(!0),h(!1),u(null),o(!1)}})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Ia,{onSearch:D})}),e.jsx("div",{className:"mt-8",children:e.jsx(Ma,{bills:y,loading:n,error:v,onSelect:P,onUpdateCost:U,onSelectDriver:M=>T(`/driver-profile/${M.driver_id}`),onSelectVehicle:M=>T(`/vehicles/${M.vehicle_id}`),statusFilter:N})})]})}),m&&e.jsx(We,{onClose:()=>c(!1),onSuccess:M=>{l([...s,M]),c(!1)}}),g&&p&&e.jsx(We,{bill:p,onClose:()=>x(!1),onSuccess:$}),A&&b&&e.jsx(La,{bill:b,onClose:()=>o(!1),onSuccess:F}),w&&e.jsx("div",{className:"fixed top-5 right-5 bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded shadow-lg z-50",children:w})]})}function za(){return e.jsx(it,{children:e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsxs(Bt,{children:[e.jsx(W,{path:"/",element:e.jsx(Kt,{})}),e.jsx(W,{path:"/login",element:e.jsx(Qt,{})}),e.jsx(W,{path:"/admin-dashboard",element:e.jsx(K,{children:e.jsx(Wt,{})})}),e.jsx(W,{path:"/owner-dashboard",element:e.jsx(K,{children:e.jsx(Is,{})})}),e.jsx(W,{path:"/customer-dashboard",element:e.jsx(K,{children:e.jsx(fs,{})})}),e.jsx(W,{path:"/customer-profile/:customerId",element:e.jsx(K,{children:e.jsx(Ea,{})})}),e.jsx(W,{path:"/driver-dashboard",element:e.jsx(K,{children:e.jsx(Ss,{})})}),e.jsx(W,{path:"/driver-profile/:driverId",element:e.jsx(K,{children:e.jsx(Na,{})})}),e.jsx(W,{path:"/admin-role-dashboard",element:e.jsx(K,{children:e.jsx(Zs,{})})}),e.jsx(W,{path:"/vehicle-dashboard",element:e.jsx(K,{children:e.jsx(qs,{})})}),e.jsx(W,{path:"/vehicles/:id",element:e.jsx(K,{children:e.jsx(Aa,{})})}),e.jsx(W,{path:"/create-trip",element:e.jsx(K,{children:e.jsx(os,{})})}),e.jsx(W,{path:"/trip/:id",element:e.jsx(K,{children:e.jsx(ha,{})})}),e.jsx(W,{path:"/trip-dashboard",element:e.jsx(K,{children:e.jsx(ja,{})})}),e.jsx(W,{path:"/bill-dashboard",element:e.jsx(K,{children:e.jsx(Fa,{})})}),e.jsx(W,{path:"/product-management",element:e.jsx(K,{children:e.jsx(es,{})})}),e.jsx(W,{path:"/add-product",element:e.jsx(K,{children:e.jsx(Zt,{})})}),e.jsx(W,{path:"/edit-product/:id",element:e.jsx(K,{children:e.jsx(Jt,{})})}),e.jsx(W,{path:"/view-products",element:e.jsx(K,{children:e.jsx(ts,{})})}),e.jsx(W,{path:"/publication",element:e.jsx(K,{children:e.jsx(as,{})})}),e.jsx(W,{path:"/add-publication",element:e.jsx(K,{children:e.jsx(ss,{})})}),e.jsx(W,{path:"/view-publications",element:e.jsx(K,{children:e.jsx(ls,{})})})]}),e.jsx(Ot,{})]})})}const Ra={welcomeMessage:"Welcome to Education Empower Sri Lanka",description:"Education Empower Sri Lanka is a national initiative established to enhance equal access to quality education and empower learners of all ages across the island. This platform aims to serve students, educators, and institutions through digital resources, modern learning tools, and centralized access to academic support."},Ba={title:"Contact Us",description:"Have questions or feedback? Reach out to us — we're here to support your learning journey.",breadcrumb:"Home > Contact Us",talkToUs:"Talk to Us",subText:"Your suggestions help us grow stronger",address:"Address",email:"Email",phone:"Phone",mapTitle:"Find Us"},Oa={title:"Sri Lanka Weather",loading:"Loading weather data...",error:"Could not load weather information. Please try again later."},Ua={sectionTitle:"🔹 Our Services",sectionDescription:"We provide a variety of services to support learners of all ages and backgrounds.",services:[{title:"Help finding classes",description:"Get matched with the right educational programs or classes tailored to your goals.",icon:"📚"},{title:"Job opportunities",description:"Discover employment and internship options related to your skills and interests.",icon:"💼"},{title:"Providing resources",description:"Access curated learning materials, tools, and platforms to support your education.",icon:"🛠️"},{title:"Counseling and guidance",description:"Receive academic and career counseling to plan your educational journey with confidence.",icon:"🧭"}],noServices:"No services available at the moment."},Ya={title:"Our Vision",text:"To be Sri Lanka’s leading education center, nurturing minds, fostering innovation, and empowering lifelong learning."},qa={title:"Our Mission",goalAccess:"Ensure quality education access for all",empowerTeachers:"Empower teachers with modern tools",holisticGrowth:"Support holistic student growth",scaleImpact:"Scale impact through technology",buildAwareness:"Build awareness in local communities",continuousLearning:"Foster a culture of continuous learning"},Va={studentsValue:"4.5M+",studentsLabel:"Targeted Students Nationwide",teachersValue:"230K+",teachersLabel:"Teachers We Aim to Support",parentsValue:"3M+",parentsLabel:"Engaged Parents in Our Vision",schoolsValue:"10,000+",schoolsLabel:"Schools Across Sri Lanka — Our Goal",educationHighlight:"On a Mission to Empower Sri Lankan Education"},Xa={title:"How the Platform Operates",para1:"The Education Empower Sri Lanka platform collaborates with government bodies, local schools, and NGOs to deliver trusted academic content and facilitate training for both teachers and students.",para2:"Our virtual classrooms, learning repositories, and exam preparation tools are made accessible through a centralized system with minimal cost to the end user.",para3:"This initiative minimizes resource gaps and provides an efficient, transparent model for nationwide educational service delivery.",para4:"We also support offline access in remote regions through partner learning hubs and community education points."},Ga={title:"Daily Educational Highlights",searchPlaceholder:"🔍︎ Search Topics",downloadPdf:"Download as PDF",noDatal1:"Daily highlights are being updated.",noDatal2:"Please check back shortly for the latest content."},Ha={title:"Today’s Learning Highlights",center:"Education Empower Sri Lanka - National Portal",tel:"Tel: 011-2345678",dateLabel:"Date",emailLabel:"Email",allTypes:"All Categories",inquiry:"For Inquiries:",manager:"Coordinator, National Education Support Center",contact:"Tel: 011-2345678 / 011-8765432 | Email: support@eduempower.lk",tableHeaders:{number:"#",item:"Topic",minPrice:"Min Duration",maxPrice:"Max Duration"},noPrices:"No highlights available for today.",popupBlocked:"Popup blocked! Please enable popups to print.",uncategorized:"Uncategorized"},Wa={home:Ra,contact:Ba,weather:Oa,ServiceSection:Ua,vision:Ya,mission:qa,featureCards:Va,marketOperations:Xa,dailyPrices:Ga,ui:Ha},Ka={welcomeMessage:"ආයුබෝවන් - ශ්‍රී ලංකාවේ අධ්‍යාපන බලවත්වීම වෙත සාදරයෙන් පිළිගනිමු",description:"අධ්‍යාපන බලවත්වීම ශ්‍රී ලංකාව ජාතික උත්සාහයකි. මෙය දිවයින පුරා සියලුම වයස් සමූහවල ඉගෙනුමට සමාන ප්‍රවේශයක් සැලසීම සහ ඉගෙනුම්කරුවන් බලවත්ව කිරීම සඳහා පිහිටුවා ඇත. සිසුන්, ගුරුභවතුන් සහ ආයතන සඳහා ඩිජිටල් සම්පත්, නවීන ඉගෙනුම් මෙවලම් සහ අධ්‍යාපනික සහය සඳහා මධ්‍යස්ථිත ප්‍රවේශයක් ලබාදීම මෙහි අරමුණයි."},Qa={title:"අප අමතන්න",description:"ගැටළු හෝ අදහස් තිබේද? අප හා සම්බන්ධ වන්න — ඔබේ ඉගෙනුම් ගමනට අපි සහාය වීමට මෙහි සිටින්නෙමු.",breadcrumb:"මුල් පිටුව > අප අමතන්න",talkToUs:"අප හා කතා කරන්න",subText:"ඔබගේ යෝජනා අප වඩාත් ශක්තිමත් කරයි",address:"ලිපිනය",email:"ඊමේල්",phone:"දුරකථනය",mapTitle:"අපි කොතැනදැයි සොයන්න"},Za={title:"ශ්‍රී ලංකාවේ කාලගුණය",loading:"කාලගුණ දත්ත පූරණය වෙමින් පවතී...",error:"කාලගුණ තොරතුරු පූරණය කළ නොහැක. කරුණාකර පසුව නැවත උත්සාහ කරන්න."},Ja={sectionTitle:"🔹 අපගේ සේවාවන්",sectionDescription:"සියලුම වයස් සහ පසුබැසීම්වල ඉගෙනුම්කරුවන් සඳහා සහාය වීමට විවිධ සේවාවන් අපි සපයයි.",services:[{title:"පන්ති සෙවීම සඳහා උපකාර",description:"ඔබගේ ඉගෙනුම් ඉලක්කයන්ට ගැළපෙන අධ්‍යාපන වැඩසටහන් හෝ පන්ති සොයා ගන්න.",icon:"📚"},{title:"රැකියා අවස්ථා",description:"ඔබගේ දක්ෂතා සහ ආකර්ෂණයන්ට අදාළ රැකියා සහ අන්තර්ජාතික අවස්ථා සෙවීම.",icon:"💼"},{title:"සම්පත් ලබාදීම",description:"ඉගෙනුම සඳහා අවශ්‍ය සම්පත්, මෙවලම් සහ වේදිකා ලබා ගන්න.",icon:"🛠️"},{title:"උපදේශනය සහ මඟ පෙන්වීම",description:"අධ්‍යාපන සහ වෘත්තීය මාර්ගය සැලසුම් කිරීමට විශ්වාසයෙන් උපදේශනය ලබා ගන්න.",icon:"🧭"}],noServices:"දැනට කිසිඳු සේවාවක් නොමැත."},el={title:"අපගේ දැක්ම",text:"ශ්‍රී ලංකාවේ ප්‍රමුඛතම අධ්‍යාපන මධ්‍යස්ථානය වීම, නව නිර්මාණශීලීත්වය ඇති කිරීම සහ ජීවිත පුරා ඉගෙනීම ශක්තිමත් කිරීම."},tl={title:"අපගේ මෙහෙවර",goalAccess:"සියල්ලන්ට තත්ත්වමය අධ්‍යාපන ප්‍රවේශය සහතික කිරීම",empowerTeachers:"ගුරුවරු නවීන මෙවලම්වලින් සවිබලගන්වීම",holisticGrowth:"සම්පූර්ණ සිසු වර්ධනයට සහය වීම",scaleImpact:"තාක්ෂණය ඔස්සේ බලපෑම විශාල කිරීම",buildAwareness:"ප්‍රාදේශීය සමාජවල දැනුවත්කම වර්ධනය කිරීම",continuousLearning:"නිරන්තර ඉගෙනුම් සංස්කෘතියක් ඇති කිරීම"},sl={studentsValue:"4.5M+",studentsLabel:"දිවයින පුරා ඉලක්ක කරගත් සිසුන්",teachersValue:"230K+",teachersLabel:"අප විසින් සහාය වීමට අරමුණු කළ ගුරුවරු",parentsValue:"3M+",parentsLabel:"අපගේ දැක්මට යෙදී සිටින දෙමව්පියන්",schoolsValue:"10,000+",schoolsLabel:"ශ්‍රී ලංකාවේ පාසල් — අපගේ ඉලක්කය",educationHighlight:"ශ්‍රී ලංකාවේ අධ්‍යාපනය ශක්තිමත් කිරීමේ මෙහෙවරක යෙදී සිටිමු"},al={title:"වේදිකාව ක්‍රියාත්මක වන ආකාරය",para1:"අධ්‍යාපන බලවත්වීම ශ්‍රී ලංකාව වේදිකාව රජයේ ආයතන, පාසල් සහ ග්‍රාමීය සංවිධාන සමඟ එකතුවී විශ්වාසනීය අධ්‍යාපනික අන්තර්ගතය ලබාදීම සහ ගුරුවරුන්ට සහ සිසුන්ට පුහුණුව ලබාදීම සඳහා ක්‍රියා කරයි.",para2:"අපගේ අතථ්‍ය පන්ති කාමර, ඉගෙනුම් ගබඩා සහ විභාග සූදානම් කිරීමේ මෙවලම් මධ්‍යස්ථිත පද්ධතියක් හරහා පහසු පිරිවැයකින් ලබා ගත හැක.",para3:"මෙම උත්සාහය සම්පත් හිඟය අවම කරමින් ජාතික මට්ටමේ අධ්‍යාපන සේවාවන් සම්පූර්ණ කළමනාකරණ ආකෘතියක් ලබාදෙයි.",para4:"අපි දුරස්ථ ප්‍රදේශවලදී පවා මිතුරු ඉගෙනුම් මධ්‍යස්ථාන හා ප්‍රජා අධ්‍යාපන ආකූඪයන් හරහා මාර්ගගත නොවන ප්‍රවේශය සහය දක්වමු."},ll={title:"දෛනික අධ්‍යාපන විශේෂාංග",searchPlaceholder:"🔍︎ මාතෘකා සොයන්න",downloadPdf:"PDF ලෙස බාගන්න",noDatal1:"දෛනික විශේෂාංග යාවත්කාලීන වෙමින් පවතී.",noDatal2:"කරුණාකර නවතම අන්තර්ගතය සඳහා ඉතා ඉක්මනින් නැවත පිරික්සන්න."},rl={title:"අදගේ ඉගෙනුම් විශේෂාංග",center:"අධ්‍යාපන බලවත්වීම ශ්‍රී ලංකාව - ජාතික වේදිකාව",tel:"දුරකථන: 011-2345678",dateLabel:"දිනය",emailLabel:"ඊමේල්",allTypes:"සියලු ප්‍රවර්ග",inquiry:"විමසීම් සඳහා:",manager:"සම්පාදක, ජාතික අධ්‍යාපන සහය මධ්‍යස්ථානය",contact:"දුරකථන: 011-2345678 / 011-8765432 | ඊමේල්: support@eduempower.lk",tableHeaders:{number:"#",item:"මාතෘකාව",minPrice:"අවම කාලසීමාව",maxPrice:"උපරිම කාලසීමාව"},noPrices:"අද සඳහා කිසිඳු විශේෂාංග නොමැත.",popupBlocked:"පොප්අප් අවහිර වී ඇත! මුද්‍රණය සඳහා පෝප්අප් සක්‍රිය කරන්න.",uncategorized:"වර්ගීකරණය නොකළ"},nl={home:Ka,contact:Qa,weather:Za,ServiceSection:Ja,vision:el,mission:tl,featureCards:sl,marketOperations:al,dailyPrices:ll,ui:rl},il={welcomeMessage:"கல்வியை வலுப்படுத்தும் இலங்கை வரவேற்கிறது",description:"கல்வி எம்ஃபவர் இலங்கை என்பது சம வாய்ப்புடன் தரமான கல்வியை வழங்கும் மற்றும் தீவின் முழுவதும் உள்ள கற்றலாளர்களை வலுப்படுத்தும் தேசிய முயற்சியாகும். இந்த தளத்தின் நோக்கம் மாணவர்கள், ஆசிரியர்கள் மற்றும் நிறுவனங்களுக்கு டிஜிட்டல் வளங்கள், நவீன கற்றல் கருவிகள் மற்றும் கல்வி ஆதரவை மையப்படுத்திய அணுகலை வழங்குவதாகும்."},ol={title:"எங்களை தொடர்புகொள்ளுங்கள்",description:"கேள்விகளா? கருத்துகளா? எங்களை தொடர்புகொள்ளுங்கள் — உங்கள் கற்றல் பயணத்திற்கு நாங்கள் ஆதரவாக இருக்கிறோம்.",breadcrumb:"முகப்பு > எங்களை தொடர்புகொள்ளுங்கள்",talkToUs:"எங்களுடன் பேசுங்கள்",subText:"உங்கள் யோசனைகள் நம்மை வலுப்படுத்துகின்றன",address:"முகவரி",email:"மின்னஞ்சல்",phone:"தொலைபேசி",mapTitle:"எங்களை காணுங்கள்"},cl={title:"இலங்கையின் வானிலை",loading:"வானிலை தரவுகள் ஏற்றப்படுகிறது...",error:"வானிலை தகவலை ஏற்ற முடியவில்லை. தயவுசெய்து பின்னர் மீண்டும் முயற்சிக்கவும்."},dl={sectionTitle:"🔹 எங்கள் சேவைகள்",sectionDescription:"எல்லா வயதுகளுக்கும், பின்னணியினருக்கும் கல்வியை ஆதரிக்க நாங்கள் பல்வேறு சேவைகளை வழங்குகிறோம்.",services:[{title:"வகுப்புகள் தேட உதவி",description:"உங்கள் குறிக்கோள்களுக்கு ஏற்ப கல்வி நிரல்கள் அல்லது வகுப்புகளை கண்டறியுங்கள்.",icon:"📚"},{title:"வேலை வாய்ப்புகள்",description:"உங்கள் திறமைகள் மற்றும் ஆர்வங்களுக்கு ஏற்ப வேலை மற்றும் பயிற்சி வாய்ப்புகளை கண்டறியுங்கள்.",icon:"💼"},{title:"வளங்களை வழங்குதல்",description:"உங்கள் கல்விக்கு ஆதரவாக தேர்ந்தெடுக்கப்பட்ட கற்றல் பொருட்கள் மற்றும் கருவிகளை அணுகுங்கள்.",icon:"🛠️"},{title:"ஆலோசனை மற்றும் வழிகாட்டல்",description:"உங்கள் கல்விப் பயணத்திற்கான திட்டமிடலில் கல்வி மற்றும் வேலை ஆலோசனையைப் பெறுங்கள்.",icon:"🧭"}],noServices:"தற்போது எந்த சேவைகளும் இல்லை."},ml={title:"எங்கள் பார்வை",text:"இலங்கையின் முன்னணி கல்வி மையமாக உருவாகி, புத்திசாலித்தனத்தை வளர்த்தும், புதுமையை ஊக்குவித்தும், வாழ்நாள் முழுவதும் கற்றலை வலுப்படுத்தும் நோக்கமுடன் செயல்படுகிறோம்."},ul={title:"எங்கள் பணி",goalAccess:"எல்லோருக்கும் தரமான கல்வியை உறுதி செய்ய",empowerTeachers:"ஆசிரியர்களை நவீன கருவிகளுடன் வலுப்படுத்த",holisticGrowth:"மாணவர்களின் முழுமையான வளர்ச்சிக்கு ஆதரவு அளிக்க",scaleImpact:"தொழில்நுட்பத்தின் மூலம் தாக்கத்தை பெருக்க",buildAwareness:"முன்னணி சமூகங்களில் விழிப்புணர்வை உருவாக்க",continuousLearning:"தொடர்ந்த கற்றல் கலாச்சாரத்தை ஊக்குவிக்க"},xl={studentsValue:"4.5M+",studentsLabel:"நாட்டுமுழுவதும் இலக்கு வைத்த மாணவர்கள்",teachersValue:"230K+",teachersLabel:"நாங்கள் ஆதரிக்க முயலும் ஆசிரியர்கள்",parentsValue:"3M+",parentsLabel:"எங்கள் பார்வையில் ஈடுபட்ட பெற்றோர்கள்",schoolsValue:"10,000+",schoolsLabel:"இலங்கையிலுள்ள பள்ளிகள் — எங்கள் இலக்கு",educationHighlight:"இலங்கையின் கல்வியை வலுப்படுத்தும் ஒரு பணி"},hl={title:"தளம் செயல்படும் விதம்",para1:"அரசு அமைப்புகள், உள்ளூர் பள்ளிகள் மற்றும் தொண்டு நிறுவனங்களுடன் இணைந்து, நம்பிக்கையுள்ள கல்வி உள்ளடக்கங்களை வழங்குவதற்கும், ஆசிரியர்கள் மற்றும் மாணவர்களுக்கு பயிற்சி வழங்குவதற்கும் தளம் செயற்படுகிறது.",para2:"எங்கள் மெய்நிகர் வகுப்பறைகள், கற்றல் சேமிப்புகள் மற்றும் தேர்வுத் தயாரிப்பு கருவிகள் குறைந்த செலவில் மையமாக்கப்பட்ட முறையில் வழங்கப்படுகின்றன.",para3:"இந்த முயற்சி வளக் குறைகளை குறைத்து, தேசிய அளவிலான கல்விச் சேவைகளை திறமையான மற்றும் வெளிப்படையான மாதிரியில் வழங்குகிறது.",para4:"தீவிரமாகச் சேர முடியாத பகுதிகளில் உள்ள ஆசிரியர் மையங்கள் மற்றும் சமூகக் கல்வி மையங்கள் வழியாக ஒஃப்லைன் அணுகலை வழங்குகிறோம்."},pl={title:"தினசரி கல்வி சிறப்பம்சங்கள்",searchPlaceholder:"🔍︎ தலைப்புகளைத் தேடுங்கள்",downloadPdf:"PDF ஆக பதிவிறக்க",noDatal1:"தினசரி சிறப்பம்சங்கள் புதுப்பிக்கப்படுகின்றன.",noDatal2:"தயவுசெய்து விரைவில் மீண்டும் சரிபார்க்கவும்."},gl={title:"இன்றைய கற்றல் சிறப்பம்சங்கள்",center:"கல்வியை வலுப்படுத்தும் இலங்கை - தேசிய தளம்",tel:"தொலைபேசி: 011-2345678",dateLabel:"தேதி",emailLabel:"மின்னஞ்சல்",allTypes:"அனைத்து வகைகளும்",inquiry:"கேள்விகள்:",manager:"ஒழுங்குபடுத்துபவர், தேசிய கல்வி ஆதரவு மையம்",contact:"தொலைபேசி: 011-2345678 / 011-8765432 | மின்னஞ்சல்: support@eduempower.lk",tableHeaders:{number:"#",item:"தலைப்பு",minPrice:"குறைந்தபட்ச காலம்",maxPrice:"அதிகபட்ச காலம்"},noPrices:"இன்றைய சிறப்பம்சங்கள் எதுவும் இல்லை.",popupBlocked:"பொப்ப்அப் தடுக்கப்பட்டுள்ளது! அச்சிட பொப்ப்அப்களை செயல்படுத்தவும்.",uncategorized:"வகைப்படுத்தப்படாதது"},fl={home:il,contact:ol,weather:cl,ServiceSection:dl,vision:ml,mission:ul,featureCards:xl,marketOperations:hl,dailyPrices:pl,ui:gl};Ut.use(Yt).init({resources:{en:{translation:Wa},si:{translation:nl},ta:{translation:fl}},lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1}});qt.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(it,{children:e.jsx(Vt,{basename:"/vsystemh",children:e.jsx(za,{})})})}));
